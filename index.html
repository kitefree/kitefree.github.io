<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kitefree.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="地球人的修練">
<meta property="og:url" content="https://kitefree.github.io/index.html">
<meta property="og:site_name" content="地球人的修練">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="kite">
<meta property="article:tag" content="c#,Asp.net,Asp.net MVC,Net Core,後端,WebApi,SQL,SQL Server">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kitefree.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>地球人的修練</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">地球人的修練</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分類</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>歸檔</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="sitemap fa-fw"></i>網站地圖</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2023/10/16/2023-12-16%20Redis%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/10/16/2023-12-16%20Redis%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" class="post-title-link" itemprop="url">Redis學習筆記</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2023-10-16 11:01:00" itemprop="dateCreated datePublished" datetime="2023-10-16T11:01:00+08:00">2023-10-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-16 23:01:12" itemprop="dateModified" datetime="2023-12-16T23:01:12+08:00">2023-12-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%8C%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">後端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>33 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-Redis簡介"><a href="#1-Redis簡介" class="headerlink" title="1. Redis簡介"></a>1. Redis簡介</h2><ul>
<li><p>Remote dictionary server</p>
</li>
<li><p>可以用於數據庫、緩存、消息隊列等各種場景</p>
</li>
<li><p>最熱門NoSQL數據庫之一</p>
</li>
<li><p>基於內存數據庫(記憶體效能&gt;IO效能，也就是Redis&gt;MySQL效能)</p>
</li>
<li><p>GitHub、Twitter、Stackoverflow、百度都在使用</p>
</li>
</ul>
<h2 id="2-Redis特點"><a href="#2-Redis特點" class="headerlink" title="2. Redis特點"></a>2. Redis特點</h2><ul>
<li><p>高性能Key-Value</p>
</li>
<li><p>多種數據結構，單鍵值對最大支持512M大小的數據</p>
</li>
<li><p>豐富的功能</p>
</li>
<li><p>支持數據持久化、主從複製、哨兵模式等高可用分佈特性</p>
</li>
</ul>
<h3 id="2-1-數據類型"><a href="#2-1-數據類型" class="headerlink" title="2.1. 數據類型"></a>2.1. 數據類型</h3><p>5種基本數據類型</p>
<ul>
<li>字串 String</li>
<li>列表 List</li>
<li>集合 Set</li>
<li>有序集合 SortedSet</li>
<li>哈希 Hash</li>
</ul>
<p><img src="https://i.imgur.com/lITTqKX.png" alt="image-20231214102318825"></p>
<p>高級數據類型</p>
<ul>
<li>消息隊列 Stream</li>
<li>地理空間 Geospatial</li>
<li>HyperLogLog</li>
<li>位圖 Bitmap</li>
<li>位域 Bitfield</li>
</ul>
<h3 id="2-2-使用方式"><a href="#2-2-使用方式" class="headerlink" title="2.2. 使用方式"></a>2.2. 使用方式</h3><p>主要三種類型</p>
<ul>
<li><p>CLI</p>
<ul>
<li>redis-cli</li>
</ul>
</li>
<li><p>API</p>
<ul>
<li>簡單來說就是用程式碼(python、java)的方式進行使用</li>
</ul>
</li>
<li><p>GUI</p>
<ul>
<li>another-redis-desktop-manager</li>
</ul>
</li>
</ul>
<h2 id="3-環境安裝"><a href="#3-環境安裝" class="headerlink" title="3. 環境安裝"></a>3. 環境安裝</h2><p>下載docker image</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis</span><br></pre></td></tr></table></figure>

<p>container build</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name redis-lab -p 6379:6379 -d redis</span><br></pre></td></tr></table></figure>

<h2 id="4-Redis-GUI-工具"><a href="#4-Redis-GUI-工具" class="headerlink" title="4. Redis GUI 工具"></a>4. Redis GUI 工具</h2><h3 id="4-1-這次透過指令方式安裝"><a href="#4-1-這次透過指令方式安裝" class="headerlink" title="4.1. 這次透過指令方式安裝"></a>4.1. 這次透過指令方式安裝</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install another-redis-desktop-manager</span><br></pre></td></tr></table></figure>

<h3 id="4-2-執行結果"><a href="#4-2-執行結果" class="headerlink" title="4.2. 執行結果"></a>4.2. 執行結果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32&gt;choco install another-redis-desktop-manager</span><br><span class="line">Chocolatey v0.11.1</span><br><span class="line">Installing the following packages:</span><br><span class="line">another-redis-desktop-manager</span><br><span class="line">By installing, you accept licenses <span class="keyword">for</span> the packages.</span><br><span class="line">Progress: Downloading another-redis-desktop-manager 1.6.1... 100%</span><br></pre></td></tr></table></figure>

<h3 id="4-3-確認docker-id"><a href="#4-3-確認docker-id" class="headerlink" title="4.3. 確認docker id"></a>4.3. 確認docker id</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32&gt;docker ps</span><br><span class="line">CONTAINER ID   IMAGE                      COMMAND                  CREATED          STATUS                 PORTS                            NAMES</span><br><span class="line">65b2b326dc9c   redis                      &quot;docker-entrypoint.s…&quot;   12 minutes ago   Up 12 minutes          0.0.0.0:6379-&gt;6379/tcp           redis-lab</span><br></pre></td></tr></table></figure>

<h3 id="4-4-進入docker操作redis"><a href="#4-4-進入docker操作redis" class="headerlink" title="4.4. 進入docker操作redis"></a>4.4. 進入docker操作redis</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32&gt;docker exec -it 65b2 bash</span><br><span class="line">root@65b2b326dc9c:/data# redis-cli</span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; set test &quot;hello world&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get test</span><br><span class="line">&quot;hello world&quot;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-透過GUI工具操作"><a href="#4-5-透過GUI工具操作" class="headerlink" title="4.5. 透過GUI工具操作"></a>4.5. 透過GUI工具操作</h3><p><img src="https://i.imgur.com/J0Uw01L.png" alt="image-20231211164508060"></p>
<h2 id="5-String-字串"><a href="#5-String-字串" class="headerlink" title="5. String 字串"></a>5. String 字串</h2><h3 id="5-1-簡介"><a href="#5-1-簡介" class="headerlink" title="5.1. 簡介"></a>5.1. 簡介</h3><ol>
<li><strong>Key-Value 存儲</strong>: Redis 的 STRING 是一個 key-value 存儲結構，每個 STRING 都有一個唯一的 key 用來標識。</li>
<li><strong>二進制安全</strong>: Redis 的 STRING 不僅可以存儲文本字符串，還可以存儲任何二進制數據，這使得它非常適合作為緩存系統。</li>
<li><strong>操作豐富</strong>: Redis 提供了豐富的 STRING 操作命令，包括設置、獲取、刪除、追加等，使得對字符串的操作非常靈活。</li>
</ol>
<h3 id="5-2-使用場景"><a href="#5-2-使用場景" class="headerlink" title="5.2. 使用場景"></a>5.2. 使用場景</h3><h4 id="5-2-1-快取-Caching"><a href="#5-2-1-快取-Caching" class="headerlink" title="5.2.1. 快取 (Caching)"></a>5.2.1. 快取 (Caching)</h4><p>作為一個支持高性能的快取系統，Redis 的 STRING 可以用來存儲經常被訪問的數據，例如網頁內容、查詢結果，以減輕後端數據庫的壓力。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：將結果存入 Redis 快取</span></span><br><span class="line">SET user:1234:profile <span class="string">&quot;&#123;&#x27;id&#x27;:1234, &#x27;name&#x27;:&#x27;John Doe&#x27;, &#x27;age&#x27;:30&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-2-2-計數器-Counters"><a href="#5-2-2-計數器-Counters" class="headerlink" title="5.2.2. 計數器 (Counters)"></a>5.2.2. 計數器 (Counters)</h4><p>可以使用 Redis 的自增（INCR）和自減（DECR）操作，實現計數器的功能，適用於需要跟蹤計數的場景，比如網站訪問次數、商品庫存等。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：增加訪問次數</span></span><br><span class="line">INCR website:visit:count</span><br></pre></td></tr></table></figure>

<h4 id="5-2-3-會話管理-Session-Management"><a href="#5-2-3-會話管理-Session-Management" class="headerlink" title="5.2.3. 會話管理 (Session Management)"></a>5.2.3. 會話管理 (Session Management)</h4><p>存儲和管理用戶的會話數據，比如登錄信息、訪問權限等。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：存儲用戶會話信息</span></span><br><span class="line">SET session:userid:1234 <span class="string">&quot;&#123;&#x27;token&#x27;:&#x27;abc123&#x27;, &#x27;expires&#x27;:&#x27;2023-12-31&#x27;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-常用指令"><a href="#5-3-常用指令" class="headerlink" title="5.3. 常用指令"></a>5.3. 常用指令</h3><h4 id="5-3-1-SET-設定key"><a href="#5-3-1-SET-設定key" class="headerlink" title="5.3.1. SET - 設定key"></a>5.3.1. SET - 設定key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> kite <span class="built_in">nice</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<h4 id="5-3-2-GET-讀取key"><a href="#5-3-2-GET-讀取key" class="headerlink" title="5.3.2. GET - 讀取key"></a>5.3.2. GET - 讀取key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get kite</span><br><span class="line"><span class="string">&quot;nice&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-3-3-key大小寫有分"><a href="#5-3-3-key大小寫有分" class="headerlink" title="5.3.3. key大小寫有分"></a>5.3.3. key大小寫有分</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> Kite Nice</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get Kite</span><br><span class="line"><span class="string">&quot;Nice&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-3-4-DEL-刪除key"><a href="#5-3-4-DEL-刪除key" class="headerlink" title="5.3.4. DEL - 刪除key"></a>5.3.4. DEL - 刪除key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; del name</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<h4 id="5-3-5-EXISTS-查詢key"><a href="#5-3-5-EXISTS-查詢key" class="headerlink" title="5.3.5. EXISTS - 查詢key"></a>5.3.5. EXISTS - 查詢key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; exists name</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; exists age</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure>

<h4 id="5-3-6-KEYS-萬用字查詢"><a href="#5-3-6-KEYS-萬用字查詢" class="headerlink" title="5.3.6. KEYS - 萬用字查詢"></a>5.3.6. KEYS - 萬用字查詢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;backup4&quot;</span></span><br><span class="line">2) <span class="string">&quot;backup3&quot;</span></span><br><span class="line">3) <span class="string">&quot;age&quot;</span></span><br><span class="line">4) <span class="string">&quot;backup1&quot;</span></span><br><span class="line">5) <span class="string">&quot;backup2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; keys ba*</span><br><span class="line">1) <span class="string">&quot;backup4&quot;</span></span><br><span class="line">2) <span class="string">&quot;backup3&quot;</span></span><br><span class="line">3) <span class="string">&quot;backup1&quot;</span></span><br><span class="line">4) <span class="string">&quot;backup2&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-3-7-FLUSHALL-刪除所有key"><a href="#5-3-7-FLUSHALL-刪除所有key" class="headerlink" title="5.3.7. FLUSHALL - 刪除所有key"></a>5.3.7. FLUSHALL - 刪除所有key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; flushall</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty array)</span><br></pre></td></tr></table></figure>

<h4 id="5-3-8-中文顯示說明"><a href="#5-3-8-中文顯示說明" class="headerlink" title="5.3.8. 中文顯示說明"></a>5.3.8. 中文顯示說明</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name <span class="string">&quot;悠風&quot;</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">&quot;\xe6\x82\xa0\xe9\xa2\xa8&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-3-9-redis-cli-–raw-正常顯示中文方法"><a href="#5-3-9-redis-cli-–raw-正常顯示中文方法" class="headerlink" title="5.3.9. redis-cli –raw  正常顯示中文方法"></a>5.3.9. redis-cli –raw  正常顯示中文方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; quit</span><br><span class="line"><span class="comment"># redis-cli --raw</span></span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">悠風</span><br></pre></td></tr></table></figure>

<h4 id="5-3-10-EXPIRE-設定過期"><a href="#5-3-10-EXPIRE-設定過期" class="headerlink" title="5.3.10. EXPIRE - 設定過期"></a>5.3.10. EXPIRE - 設定過期</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; expire name 10</span><br></pre></td></tr></table></figure>

<h4 id="5-3-11-TTL-查詢過期"><a href="#5-3-11-TTL-查詢過期" class="headerlink" title="5.3.11. TTL - 查詢過期"></a>5.3.11. TTL - 查詢過期</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">6</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">4</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">2</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">-2</span><br><span class="line"></span><br><span class="line"><span class="comment">#過期後查詢結果會是空白</span></span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"></span><br><span class="line"><span class="comment">#過期後查詢結果會是空白</span></span><br><span class="line">127.0.0.1:6379&gt; keys name</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-3-12-SETEX-設定key-過期"><a href="#5-3-12-SETEX-設定key-過期" class="headerlink" title="5.3.12. SETEX - 設定key + 過期"></a>5.3.12. SETEX - 設定key + 過期</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setex name 5 悠風</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">-2</span><br></pre></td></tr></table></figure>

<h4 id="5-3-13-SETNX-該值不存在則建立"><a href="#5-3-13-SETNX-該值不存在則建立" class="headerlink" title="5.3.13. SETNX - 該值不存在則建立"></a>5.3.13. SETNX - 該值不存在則建立</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setnx name kite</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="6-LIST-列表"><a href="#6-LIST-列表" class="headerlink" title="6. LIST 列表"></a>6. LIST 列表</h2><h3 id="6-1-簡介"><a href="#6-1-簡介" class="headerlink" title="6.1. 簡介"></a>6.1. 簡介</h3><p>在 Redis 中，LIST 是一種有序、可重複的資料結構，它允許存儲一個有序的元素列表。每個元素都有一個索引，從 0 開始。LIST 提供了豐富的操作命令，可以在列表的頭部或尾部執行插入、刪除等操作，同時支持範圍查詢和修剪。可實現最簡單的先進先出隊列也就是結合<code>LPUSH</code>(左進) + <code>RPOP</code>(右出)</p>
<p>LIST 資料結構的特點：</p>
<ol>
<li><strong>有序性</strong>: 元素在列表中的存儲順序是有序的，可以按照索引進行訪問。</li>
<li><strong>重複元素</strong>: 元素可以重複存在於列表中，這使得 LIST 可以用來表示多個相同類型的元素。</li>
<li><strong>支持隊列和堆疊操作</strong>: LIST 可以被當作隊列（先進先出，FIFO）或堆疊（後進先出，LIFO）來使用。</li>
</ol>
<h3 id="6-2-使用場景"><a href="#6-2-使用場景" class="headerlink" title="6.2. 使用場景"></a>6.2. 使用場景</h3><h4 id="6-2-1-日誌記錄"><a href="#6-2-1-日誌記錄" class="headerlink" title="6.2.1. 日誌記錄"></a>6.2.1. 日誌記錄</h4><p>隊列的特點是先進先出,後進後出.我們可以使用lpush 命令從隊列的左邊放入,然後利用rpop命令從右邊取出,這樣就模擬實現了隊列.可以用來記錄日誌等</p>
<h4 id="6-2-2-抽獎-搶票"><a href="#6-2-2-抽獎-搶票" class="headerlink" title="6.2.2. 抽獎,搶票"></a>6.2.2. 抽獎,搶票</h4><p>list 是線程安全的,所有的pop操作是原子性的,適用於抽獎,搶票等場景,用來防止超賣問題.這裡重點解釋一下抽獎:主要是分為三步</p>
<ol>
<li>全部獎品打散放入list中</li>
<li>呼叫pop指令從list中取出</li>
<li>將中獎記錄寫入資料庫</li>
</ol>
<h4 id="6-2-3-流量消峰"><a href="#6-2-3-流量消峰" class="headerlink" title="6.2.3. 流量消峰"></a>6.2.3. 流量消峰</h4><p>將所有的請求全部放到list中,然後開啟多個線程來處理後續請求,減輕伺服器壓力,用來處理一些高並發場景.</p>
<h3 id="6-3-常用指令"><a href="#6-3-常用指令" class="headerlink" title="6.3. 常用指令"></a>6.3. 常用指令</h3><h4 id="6-3-1-LPUSH"><a href="#6-3-1-LPUSH" class="headerlink" title="6.3.1. LPUSH"></a>6.3.1. LPUSH</h4><p>第一次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; LPUSH letter a</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/AJKwCUc.png" alt="image-20231213213532063"></p>
<p>第二次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; LPUSH letter b</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line"></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;b&quot;</span></span><br><span class="line">2) <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://i.imgur.com/SxJcfz8.png" alt="image-20231213213614346"></p>
<p>第三次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; LPUSH letter c d e</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br></pre></td></tr></table></figure>



<p><img src="https://i.imgur.com/JI8OdHv.png" alt="image-20231213213634536"></p>
<h4 id="6-3-2-LRANGE"><a href="#6-3-2-LRANGE" class="headerlink" title="6.3.2. LRANGE"></a>6.3.2. LRANGE</h4><p>-1 代表全部</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;d&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;b&quot;</span></span><br><span class="line">5) <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="6-3-3-RPUSH"><a href="#6-3-3-RPUSH" class="headerlink" title="6.3.3. RPUSH"></a>6.3.3. RPUSH</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; RPUSH letter f</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;d&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;b&quot;</span></span><br><span class="line">5) <span class="string">&quot;a&quot;</span></span><br><span class="line">6) <span class="string">&quot;f&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/ChvUKq0.png" alt="image-20231213213754020"></p>
<p>RPOP </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; RPOP letter</span><br><span class="line"><span class="string">&quot;f&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;d&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;b&quot;</span></span><br><span class="line">5) <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/GO4i0Gk.png" alt="image-20231213213849151"></p>
<p>LPOP</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; LPOP letter 2</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;d&quot;</span></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;c&quot;</span></span><br><span class="line">2) <span class="string">&quot;b&quot;</span></span><br><span class="line">3) <span class="string">&quot;a&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/zaNzqqY.png" alt="image-20231213214017278"></p>
<h4 id="6-3-4-LLEN"><a href="#6-3-4-LLEN" class="headerlink" title="6.3.4. LLEN"></a>6.3.4. LLEN</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; LLEN letter</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></table></figure>

<h4 id="6-3-5-LTRIM"><a href="#6-3-5-LTRIM" class="headerlink" title="6.3.5. LTRIM"></a>6.3.5. LTRIM</h4><p>索引從0開始算，所以 1 ~ 3 是 <code>d、c、b</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; LPUSH letter a b c d e</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line"></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;e&quot;</span></span><br><span class="line">2) <span class="string">&quot;d&quot;</span></span><br><span class="line">3) <span class="string">&quot;c&quot;</span></span><br><span class="line">4) <span class="string">&quot;b&quot;</span></span><br><span class="line">5) <span class="string">&quot;a&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; LTRIM letter 1 3</span><br><span class="line"><span class="string">&quot;OK&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; LRANGE letter 0 -1</span><br><span class="line">1) <span class="string">&quot;d&quot;</span></span><br><span class="line">2) <span class="string">&quot;c&quot;</span></span><br><span class="line">3) <span class="string">&quot;b&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="7-SET-集合"><a href="#7-SET-集合" class="headerlink" title="7. SET 集合"></a>7. SET 集合</h2><h3 id="7-1-簡介"><a href="#7-1-簡介" class="headerlink" title="7.1. 簡介"></a>7.1. 簡介</h3><p>SET 與 LIST 最大的差異是沒有順序，並且不能有重複值</p>
<h4 id="7-1-1-什麼是-Redis-SET-資料結構？"><a href="#7-1-1-什麼是-Redis-SET-資料結構？" class="headerlink" title="7.1.1. 什麼是 Redis SET 資料結構？"></a>7.1.1. 什麼是 Redis SET 資料結構？</h4><p>在 Redis 中，SET 是一種集合型資料結構，用來存儲多個唯一且無序的元素。SET 不允許相同的元素存在，這意味著每個元素在 SET 中都是唯一的。</p>
<h4 id="7-1-2-Redis-SET-的主要特性："><a href="#7-1-2-Redis-SET-的主要特性：" class="headerlink" title="7.1.2. Redis SET 的主要特性："></a>7.1.2. Redis SET 的主要特性：</h4><ul>
<li><strong>唯一性（Unique）</strong>：SET 中的每個元素都是唯一的，不允許重複的元素存在。</li>
<li><strong>無序性（Unordered）</strong>：SET 中的元素是無序的，不像 LIST 或 ZSET 有順序的概念。</li>
<li><strong>操作豐富</strong>：Redis 提供了豐富的 SET 操作命令，包括添加成員、刪除成員、檢查成員是否存在等。</li>
</ul>
<h3 id="7-2-使用場景"><a href="#7-2-使用場景" class="headerlink" title="7.2. 使用場景"></a>7.2. 使用場景</h3><p>redis set是集合類型的資料結構，那麼集合類型就比較適合用於聚合分類。</p>
<h4 id="7-2-1-標籤"><a href="#7-2-1-標籤" class="headerlink" title="7.2.1. 標籤"></a>7.2.1. 標籤</h4><p>例如我們部落格網站常常使用到的興趣標籤，把一個個有著相同嗜好，關注類似內容的用戶利用一個標籤把他們進行歸併。 </p>
<h4 id="7-2-2-共同"><a href="#7-2-2-共同" class="headerlink" title="7.2.2. 共同"></a>7.2.2. 共同</h4><p>共同好友功能，共同喜好，或是可以引申到二度好友之類的擴充應用。</p>
<h4 id="7-2-3-統計"><a href="#7-2-3-統計" class="headerlink" title="7.2.3. 統計"></a>7.2.3. 統計</h4><p>統計網站的獨立IP。利用set集合當中元素不唯一性，可以快速即時統計存取網站的獨立IP。</p>
<h3 id="7-3-常用指令"><a href="#7-3-常用指令" class="headerlink" title="7.3. 常用指令"></a>7.3. 常用指令</h3><h4 id="7-3-1-SADD"><a href="#7-3-1-SADD" class="headerlink" title="7.3.1. SADD"></a>7.3.1. SADD</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; SADD course Redis</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#故意再加一次，加不進去</span></span><br><span class="line">&gt; SADD course Redis</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">&gt; SMEMBERS course</span><br><span class="line">1) <span class="string">&quot;Redis&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="7-3-2-SMEMBERS"><a href="#7-3-2-SMEMBERS" class="headerlink" title="7.3.2. SMEMBERS"></a>7.3.2. SMEMBERS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; SMEMBERS course</span><br><span class="line">1) <span class="string">&quot;Redis&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="7-3-3-SISMEMBER"><a href="#7-3-3-SISMEMBER" class="headerlink" title="7.3.3. SISMEMBER"></a>7.3.3. SISMEMBER</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; SISMEMBER course Redis</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">&gt; SISMEMBER course Python</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure>

<h4 id="7-3-4-SREM"><a href="#7-3-4-SREM" class="headerlink" title="7.3.4. SREM"></a>7.3.4. SREM</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; SREM course Redis</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">&gt; SMEMBERS course</span><br><span class="line">(empty list or <span class="built_in">set</span>)</span><br></pre></td></tr></table></figure>

<h4 id="7-3-5-其它學習"><a href="#7-3-5-其它學習" class="headerlink" title="7.3.5. 其它學習"></a>7.3.5. 其它學習</h4><p>SINTER、SUNION、SDIFF</p>
<h2 id="8-SortedSet-有序集合"><a href="#8-SortedSet-有序集合" class="headerlink" title="8. SortedSet 有序集合"></a>8. SortedSet 有序集合</h2><h3 id="8-1-簡介"><a href="#8-1-簡介" class="headerlink" title="8.1. 簡介"></a>8.1. 簡介</h3><h4 id="8-1-1-什麼是-Redis-Sorted-Set-資料結構？"><a href="#8-1-1-什麼是-Redis-Sorted-Set-資料結構？" class="headerlink" title="8.1.1. 什麼是 Redis Sorted Set 資料結構？"></a>8.1.1. 什麼是 Redis Sorted Set 資料結構？</h4><p>在 Redis 中，Sorted Set（有序集合）是一種集合型資料結構，它與 SET 類似，但每個成員都關聯著一個分數（score）。這個分數用來排序集合中的元素，因此 Sorted Set 是根據分數有序排列的。</p>
<h4 id="8-1-2-Redis-Sorted-Set-的主要特性："><a href="#8-1-2-Redis-Sorted-Set-的主要特性：" class="headerlink" title="8.1.2. Redis Sorted Set 的主要特性："></a>8.1.2. Redis Sorted Set 的主要特性：</h4><ul>
<li><strong>有序性（Ordered）</strong>：元素根據其分數的大小進行排序，可以按照分數區間或排名獲取元素。</li>
<li><strong>唯一性（Unique）</strong>：每個元素在集合中是唯一的，不允許重複的成員存在。</li>
<li><strong>操作豐富</strong>：Redis 提供了豐富的 Sorted Set 操作命令，包括添加成員、刪除成員、獲取排名、按照分數區間獲取成員等。</li>
</ul>
<h3 id="8-2-使用場景"><a href="#8-2-使用場景" class="headerlink" title="8.2. 使用場景"></a>8.2. 使用場景</h3><h4 id="8-2-1-排行榜（Leaderboard）"><a href="#8-2-1-排行榜（Leaderboard）" class="headerlink" title="8.2.1. 排行榜（Leaderboard）"></a>8.2.1. 排行榜（Leaderboard）</h4><p>Sorted Set 非常適用於實現排行榜，其中成員的分數表示其在排行中的位置，可以根據分數的高低快速獲取排名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：將玩家分數存入排行榜</span></span><br><span class="line">ZADD leaderboard 1000 <span class="string">&quot;Player1&quot;</span></span><br><span class="line">ZADD leaderboard 950 <span class="string">&quot;Player2&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="8-2-2-過期時間管理"><a href="#8-2-2-過期時間管理" class="headerlink" title="8.2.2. 過期時間管理"></a>8.2.2. 過期時間管理</h4><p>可以使用 Sorted Set 來管理帶有過期時間的數據，分數表示過期時間的時間戳，並使用定期的清理操作來刪除過期的數據。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：將帶有過期時間的數據存入有序集合</span></span><br><span class="line">ZADD expiration:tasks &lt;timestamp&gt; <span class="string">&quot;Task1&quot;</span></span><br><span class="line">ZADD expiration:tasks &lt;timestamp&gt; <span class="string">&quot;Task2&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="8-2-3-區間查詢"><a href="#8-2-3-區間查詢" class="headerlink" title="8.2.3. 區間查詢"></a>8.2.3. 區間查詢</h4><p>Sorted Set 支持根據分數區間進行查詢，這使得它適用於需要根據數值範圍檢索數據的場景。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：獲取分數在指定區間的成員</span></span><br><span class="line">ZRANGEBYSCORE temperature 0 25</span><br></pre></td></tr></table></figure>

<h4 id="8-2-4-數據匹配和搜索"><a href="#8-2-4-數據匹配和搜索" class="headerlink" title="8.2.4. 數據匹配和搜索"></a>8.2.4. 數據匹配和搜索</h4><p>Sorted Set 可以用於實現模糊搜索，分數可以表示相似度或匹配程度，使得可以按照相似度檢索數據。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：根據匹配程度獲取成員</span></span><br><span class="line">ZRANGEBYSCORE similarity 0.8 1.0</span><br></pre></td></tr></table></figure>

<h4 id="8-2-5-即時排名"><a href="#8-2-5-即時排名" class="headerlink" title="8.2.5. 即時排名"></a>8.2.5. 即時排名</h4><p>Sorted Set 可以用於即時排名的場景，例如遊戲中的實時得分排名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：遊戲中即時更新玩家分數</span></span><br><span class="line">ZADD realtime:scoreboard 1200 <span class="string">&quot;Player1&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3-常用指令"><a href="#8-3-常用指令" class="headerlink" title="8.3. 常用指令"></a>8.3. 常用指令</h3><h4 id="8-3-1-ZADD"><a href="#8-3-1-ZADD" class="headerlink" title="8.3.1. ZADD"></a>8.3.1. ZADD</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZADD result 100 小民 90 小華 80 小新</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h4 id="8-3-2-ZRANGE"><a href="#8-3-2-ZRANGE" class="headerlink" title="8.3.2. ZRANGE"></a>8.3.2. ZRANGE</h4><p>只呈現人名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZRANGE result 0 -1</span><br><span class="line">小新</span><br><span class="line">小華</span><br><span class="line">小民</span><br></pre></td></tr></table></figure>

<h4 id="8-3-3-ZRANGE-WITHSCORES"><a href="#8-3-3-ZRANGE-WITHSCORES" class="headerlink" title="8.3.3. ZRANGE WITHSCORES"></a>8.3.3. ZRANGE WITHSCORES</h4><p>分數跟人一起呈現</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZRANGE result 0 -1 WITHSCORES</span><br><span class="line">小新</span><br><span class="line">80</span><br><span class="line">小華</span><br><span class="line">90</span><br><span class="line">小民</span><br><span class="line">100</span><br></pre></td></tr></table></figure>

<h4 id="8-3-4-ZSCORE"><a href="#8-3-4-ZSCORE" class="headerlink" title="8.3.4. ZSCORE"></a>8.3.4. ZSCORE</h4><p>呈現分數</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZSCORE result 小民</span><br><span class="line">100</span><br></pre></td></tr></table></figure>

<h4 id="8-3-5-ZRANK"><a href="#8-3-5-ZRANK" class="headerlink" title="8.3.5. ZRANK"></a>8.3.5. ZRANK</h4><p>有序集合預設是由小到大排序，索引從0開始，小民分數最多，所以索引是2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZRANK result 小民</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<h4 id="8-3-6-ZREVRANK"><a href="#8-3-6-ZREVRANK" class="headerlink" title="8.3.6. ZREVRANK"></a>8.3.6. ZREVRANK</h4><p>rev是指reverse 反轉，也就是由大到小</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZREVRANK result 小民</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="8-3-7-其它學習"><a href="#8-3-7-其它學習" class="headerlink" title="8.3.7. 其它學習"></a>8.3.7. 其它學習</h4><p>比如刪除某個成員，對某個成員分數進行增加，刪除某個排名範圍的成員</p>
<h2 id="9-Hash-哈希"><a href="#9-Hash-哈希" class="headerlink" title="9. Hash 哈希"></a>9. Hash 哈希</h2><h3 id="9-1-簡介"><a href="#9-1-簡介" class="headerlink" title="9.1. 簡介"></a>9.1. 簡介</h3><p>key-value資料結構，特別適合來儲存物件。</p>
<h3 id="9-2-使用場景"><a href="#9-2-使用場景" class="headerlink" title="9.2. 使用場景"></a>9.2. 使用場景</h3><h4 id="9-2-1-對象存儲"><a href="#9-2-1-對象存儲" class="headerlink" title="9.2.1. 對象存儲"></a>9.2.1. 對象存儲</h4><p>Hash 非常適用於存儲對象的屬性，例如用戶對象、產品對象等，其中每個字段表示對象的一個屬性，對應的值是這個屬性的值。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：存儲用戶對象</span></span><br><span class="line">HSET user:1234 name <span class="string">&quot;John Doe&quot;</span></span><br><span class="line">HSET user:1234 age 30</span><br><span class="line">HSET user:1234 email <span class="string">&quot;john@example.com&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="9-2-2-網站會話管理"><a href="#9-2-2-網站會話管理" class="headerlink" title="9.2.2. 網站會話管理"></a>9.2.2. 網站會話管理</h4><p>Hash 可以用於存儲網站中的會話信息，其中每個字段表示一個會話屬性，對應的值是這個會話屬性的值。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：存儲會話信息</span></span><br><span class="line">HSET session:abc123 userid 1234</span><br><span class="line">HSET session:abc123 last_access <span class="string">&quot;2023-12-31 23:59:59&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="9-2-3-配置存儲"><a href="#9-2-3-配置存儲" class="headerlink" title="9.2.3. 配置存儲"></a>9.2.3. 配置存儲</h4><p>Hash 可以用於存儲應用程序的配置信息，其中每個字段表示一個配置項，對應的值是這個配置項的值。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 範例：存儲應用程序配置</span></span><br><span class="line">HSET app:config max_connections 100</span><br><span class="line">HSET app:config log_level <span class="string">&quot;info&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-3-常用指令"><a href="#9-3-常用指令" class="headerlink" title="9.3. 常用指令"></a>9.3. 常用指令</h3><h4 id="9-3-1-HSET"><a href="#9-3-1-HSET" class="headerlink" title="9.3.1. HSET"></a>9.3.1. HSET</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HSET person name kite</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; HSET person age 100</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h4 id="9-3-2-HGET"><a href="#9-3-2-HGET" class="headerlink" title="9.3.2. HGET"></a>9.3.2. HGET</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HGET person name</span><br><span class="line">kite</span><br></pre></td></tr></table></figure>

<h4 id="9-3-3-HGETALL"><a href="#9-3-3-HGETALL" class="headerlink" title="9.3.3. HGETALL"></a>9.3.3. HGETALL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HGETALL person</span><br><span class="line">name</span><br><span class="line">kite</span><br><span class="line">age</span><br><span class="line">100</span><br></pre></td></tr></table></figure>

<h4 id="9-3-4-HDEL"><a href="#9-3-4-HDEL" class="headerlink" title="9.3.4. HDEL"></a>9.3.4. HDEL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HDEL person age</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h4 id="9-3-5-HGETALL"><a href="#9-3-5-HGETALL" class="headerlink" title="9.3.5. HGETALL"></a>9.3.5. HGETALL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HGETALL person</span><br><span class="line">name</span><br><span class="line">kite</span><br></pre></td></tr></table></figure>

<h4 id="9-3-6-HEXISTS"><a href="#9-3-6-HEXISTS" class="headerlink" title="9.3.6. HEXISTS"></a>9.3.6. HEXISTS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HEXISTS person name</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; HEXISTS person age</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="9-3-7-HKEYS"><a href="#9-3-7-HKEYS" class="headerlink" title="9.3.7. HKEYS"></a>9.3.7. HKEYS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HKEYS person</span><br><span class="line">name</span><br></pre></td></tr></table></figure>

<h4 id="9-3-8-HLEN"><a href="#9-3-8-HLEN" class="headerlink" title="9.3.8. HLEN"></a>9.3.8. HLEN</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; HLEN person</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="10-發佈訂閱模式"><a href="#10-發佈訂閱模式" class="headerlink" title="10. 發佈訂閱模式"></a>10. 發佈訂閱模式</h2><h3 id="10-1-常用指令"><a href="#10-1-常用指令" class="headerlink" title="10.1. 常用指令"></a>10.1. 常用指令</h3><h4 id="10-1-1-subscribe"><a href="#10-1-1-subscribe" class="headerlink" title="10.1.1. subscribe"></a>10.1.1. subscribe</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subscribe ubereats</span><br></pre></td></tr></table></figure>

<h4 id="10-1-2-publish"><a href="#10-1-2-publish" class="headerlink" title="10.1.2. publish"></a>10.1.2. publish</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">publish ubereats order001</span><br></pre></td></tr></table></figure>

<p>下圖左邊是publish發佈消息，右邊是兩個訂閱者，當publish時，訂閱者們會同步收到消息。</p>
<p><img src="https://i.imgur.com/vCBtT5O.png" alt="image-20231214115332780"></p>
<h2 id="11-GEO"><a href="#11-GEO" class="headerlink" title="11. GEO"></a>11. GEO</h2><h3 id="11-1-常用指令"><a href="#11-1-常用指令" class="headerlink" title="11.1. 常用指令"></a>11.1. 常用指令</h3><h4 id="11-1-1-GEOADD"><a href="#11-1-1-GEOADD" class="headerlink" title="11.1.1. GEOADD"></a>11.1.1. GEOADD</h4><p>經度(116.405285)、緯度(39.904989)、名稱(beijing)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新增一個</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD city 116.405285 39.904989 beijing</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"><span class="comment">#新增多個</span></span><br><span class="line">127.0.0.1:6379&gt; GEOADD city 121.472644 31.231706 shanghai 114.085947 22.547 shenzhen 37 23.125178 guangzhou 120.153576 30.287459 hangzhou</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h4 id="11-1-2-GEOPOS"><a href="#11-1-2-GEOPOS" class="headerlink" title="11.1.2. GEOPOS"></a>11.1.2. GEOPOS</h4><p>取得地理位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEOPOS city beijing</span><br><span class="line">116.40528291463851929</span><br><span class="line">39.9049884229125027</span><br></pre></td></tr></table></figure>

<h4 id="11-1-3-GEODIST"><a href="#11-1-3-GEODIST" class="headerlink" title="11.1.3. GEODIST"></a>11.1.3. GEODIST</h4><p>取得北京到上海的距離，預設單位為公尺(M)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEODIST city beijing shanghai</span><br><span class="line">1067597.9668</span><br><span class="line"></span><br><span class="line"><span class="comment">#以KM單位顯示</span></span><br><span class="line">127.0.0.1:6379&gt; GEODIST city beijing shanghai KM</span><br><span class="line">1067.5980</span><br></pre></td></tr></table></figure>

<h4 id="11-1-4-GEOSEARCH…FROMMEMBER…BYRADIUS…"><a href="#11-1-4-GEOSEARCH…FROMMEMBER…BYRADIUS…" class="headerlink" title="11.1.4. GEOSEARCH…FROMMEMBER…BYRADIUS…"></a>11.1.4. GEOSEARCH…FROMMEMBER…BYRADIUS…</h4><p>以某某地點為中心，採用半徑方式計算鄰近的城市</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEOSEARCH city FROMMEMBER shanghai BYRADIUS 300 KM</span><br><span class="line">hangzhou</span><br><span class="line">shanghai</span><br><span class="line">127.0.0.1:6379&gt; GEOSEARCH city FROMMEMBER shanghai BYRADIUS 2000 KM</span><br><span class="line">shenzhen</span><br><span class="line">hangzhou</span><br><span class="line">shanghai</span><br><span class="line">beijing</span><br></pre></td></tr></table></figure>

<h2 id="12-HyperLogLog"><a href="#12-HyperLogLog" class="headerlink" title="12. HyperLogLog"></a>12. HyperLogLog</h2><h3 id="12-1-常用指令"><a href="#12-1-常用指令" class="headerlink" title="12.1. 常用指令"></a>12.1. 常用指令</h3><h4 id="12-1-1-PFADD"><a href="#12-1-1-PFADD" class="headerlink" title="12.1.1. PFADD"></a>12.1.1. PFADD</h4><p>建立course課程變數，放三個課程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFADD course git docker redis</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="12-1-2-PFCOUNT"><a href="#12-1-2-PFCOUNT" class="headerlink" title="12.1.2. PFCOUNT"></a>12.1.2. PFCOUNT</h4><p>計算課程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFCOUNT course</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFADD course nginx</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT course</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h4 id="12-1-3-PFMEGER"><a href="#12-1-3-PFMEGER" class="headerlink" title="12.1.3. PFMEGER"></a>12.1.3. PFMEGER</h4><p>建立course2課程變數，放三個課程，通過<code>PMERGE</code>合併課程，再進行計算。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; PFADD course2 python git go</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; PFMERGE result course course2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; PFCOUNT result</span><br><span class="line">6</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="13-Bitmap-位圖"><a href="#13-Bitmap-位圖" class="headerlink" title="13. Bitmap 位圖"></a>13. Bitmap 位圖</h2><p><img src="https://i.imgur.com/kzsdXDW.png" alt="image-20231214142550274"></p>
<h3 id="13-1-常用指令"><a href="#13-1-常用指令" class="headerlink" title="13.1. 常用指令"></a>13.1. 常用指令</h3><h4 id="13-1-1-SETBIT"><a href="#13-1-1-SETBIT" class="headerlink" title="13.1.1. SETBIT"></a>13.1.1. SETBIT</h4><p><img src="https://i.imgur.com/dp0k5Nw.png" alt="image-20231214142638511"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SETBIT dianzan 0 1</span><br><span class="line">0</span><br><span class="line">127.0.0.1:6379&gt; SETBIT dianzan 1 0</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="13-1-2-GETBIT"><a href="#13-1-2-GETBIT" class="headerlink" title="13.1.2. GETBIT"></a>13.1.2. GETBIT</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 0</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 1</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="13-1-3-SET"><a href="#13-1-3-SET" class="headerlink" title="13.1.3. SET"></a>13.1.3. SET</h4><p><img src="https://i.imgur.com/5azKUk5.png" alt="image-20231214142747447"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET dianzan <span class="string">&quot;\xF0&quot;</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 0</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 1</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 2</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 3</span><br><span class="line">1</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 4</span><br><span class="line">0</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 5</span><br><span class="line">0</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 6</span><br><span class="line">0</span><br><span class="line">127.0.0.1:6379&gt; GETBIT dianzan 7</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="13-1-4-BITCOUNT"><a href="#13-1-4-BITCOUNT" class="headerlink" title="13.1.4. BITCOUNT"></a>13.1.4. BITCOUNT</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; BITCOUNT dianzan</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h4 id="13-1-5-BITPOS"><a href="#13-1-5-BITPOS" class="headerlink" title="13.1.5. BITPOS"></a>13.1.5. BITPOS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; BITPOS dianzan 0</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h2 id="14-BitField"><a href="#14-BitField" class="headerlink" title="14. BitField"></a>14. BitField</h2><p><img src="https://i.imgur.com/A2UKBL3.png" alt="image-20231214144020140"></p>
<h3 id="14-1-常用指令"><a href="#14-1-常用指令" class="headerlink" title="14.1. 常用指令"></a>14.1. 常用指令</h3><h4 id="14-1-1-BITFIELD…SET…"><a href="#14-1-1-BITFIELD…SET…" class="headerlink" title="14.1.1. BITFIELD…SET…"></a>14.1.1. BITFIELD…SET…</h4><p><code>player:1</code> ： 變數</p>
<p><code>u8</code> ： 正整數長度8</p>
<p><code>#0</code> ：第一個位置</p>
<p><code>1</code>：值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#等級1</span></span><br><span class="line">127.0.0.1:6379&gt; BITFIELD player:1 <span class="built_in">set</span> u8 <span class="comment">#0 1</span></span><br><span class="line">0</span><br><span class="line"><span class="comment">#金錢100</span></span><br><span class="line">127.0.0.1:6379&gt; BITFIELD player:1 <span class="built_in">set</span> u32 <span class="comment">#1 100</span></span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h4 id="14-1-2-BITFIELD…GET…"><a href="#14-1-2-BITFIELD…GET…" class="headerlink" title="14.1.2. BITFIELD…GET…"></a>14.1.2. BITFIELD…GET…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; BITFIELD player:1 get u8 <span class="comment">#0</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; BITFIELD player:1 get u32 <span class="comment">#1</span></span><br><span class="line">100</span><br></pre></td></tr></table></figure>

<h4 id="14-1-3-BITFIELD…incrby…"><a href="#14-1-3-BITFIELD…incrby…" class="headerlink" title="14.1.3. BITFIELD…incrby…"></a>14.1.3. BITFIELD…incrby…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#增加100金幣</span></span><br><span class="line">127.0.0.1:6379&gt; BITFIELD player:1 incrby u32 <span class="comment">#1 100</span></span><br><span class="line">200</span><br></pre></td></tr></table></figure>



<h2 id="15-Multi"><a href="#15-Multi" class="headerlink" title="15. Multi"></a>15. Multi</h2><p>在執行exec之前，所有命令都會放到佇列中，不會立即執行。</p>
<p>收到exec命令後，有任何一命令失敗，並不影響其它命令。</p>
<p>在執行exec之前，其它客戶提出的請求，並不會被插入到multi裡面。</p>
<p><img src="https://i.imgur.com/koP5xYq.png" alt="image-20231214153249916"></p>
<h3 id="15-1-常用指令"><a href="#15-1-常用指令" class="headerlink" title="15.1. 常用指令"></a>15.1. 常用指令</h3><h4 id="15-1-1-MULTI"><a href="#15-1-1-MULTI" class="headerlink" title="15.1.1. MULTI"></a>15.1.1. MULTI</h4><p>啟動</p>
<h4 id="15-1-2-EXEC"><a href="#15-1-2-EXEC" class="headerlink" title="15.1.2. EXEC"></a>15.1.2. EXEC</h4><p>結束</p>
<p>以下圖為例，當執行了<code>MULTI</code>之後，接著執行指令<code>SET k1 v1</code>、<code>SET k2 v2</code>之後，系統顯示在queued中。</p>
<p>接著，開啟另一個終端機，試著讀取<code>k1</code>，是沒有資料的，當執行了<code>EXEC</code>之後，另一個終端機就讀取得到資料。</p>
<p><img src="https://i.imgur.com/RxLsRi6.png" alt="image-20231214153837912"></p>
<p>以下實驗，證明其中一個指令失敗，並不影響其它執令的執行結果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SET k3 3</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET k4 v4</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; SET k5 5</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; INCR k3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; INCR k4</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; INCR k5</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; EXEC</span><br><span class="line">1) (<span class="built_in">integer</span>) 4</span><br><span class="line">2) (error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">3) (<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; GET k3</span><br><span class="line"><span class="string">&quot;4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; GET k4</span><br><span class="line"><span class="string">&quot;v4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; GET k5</span><br><span class="line"><span class="string">&quot;6&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="16-持久化"><a href="#16-持久化" class="headerlink" title="16. 持久化"></a>16. 持久化</h2><h3 id="16-1-常用指令"><a href="#16-1-常用指令" class="headerlink" title="16.1. 常用指令"></a>16.1. 常用指令</h3><h3 id="16-2-RDB-Redis-Database"><a href="#16-2-RDB-Redis-Database" class="headerlink" title="16.2. RDB(Redis Database)"></a>16.2. RDB(Redis Database)</h3><p>分為自動與手動，自動部分需要去<code>redis.config</code>檔進行修正，以下是截取部分：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Unless specified otherwise, by default Redis will save the DB:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  定時1小時檢查，是否有有1次以上異動，才符合自動儲存條件</span></span><br><span class="line"><span class="comment">#   * After 3600 seconds (an hour) if at least 1 change was performed</span></span><br><span class="line"><span class="comment">#  定時5分鐘檢查，是否有100次以上異動，才符合自動儲存條件</span></span><br><span class="line"><span class="comment">#   * After 300 seconds (5 minutes) if at least 100 changes were performed</span></span><br><span class="line"><span class="comment">#  定時60秒檢查，是否有10000次以上異動，才符合自動儲存條件</span></span><br><span class="line"><span class="comment">#   * After 60 seconds if at least 10000 changes were performed</span></span><br></pre></td></tr></table></figure>

<p>我們可以觀查到，第一個參數表示秒數，第二參數表示執行次數。而docker redis 預設是沒有包<code>redis.config</code>檔，所以如果要的話請去官網下載，可到下方參考連結去使用，下載檔案之後，在啟動docker時記得mount此份文件，修改其內容。</p>
<p>手動部分實驗如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty array)</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 k1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 k2</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment">#手動儲存</span></span><br><span class="line">127.0.0.1:6379&gt; save</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment">#跳出redis</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看文件</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用xxd指令查看檔案</span></span><br><span class="line"><span class="comment"># xxd dump.rdb</span></span><br><span class="line">00000000: 5245 4449 5330 3031 31fa 0972 6564 6973  REDIS0011..redis</span><br><span class="line">00000010: 2d76 6572 0537 2e32 2e33 fa0a 7265 6469  -ver.7.2.3..redi</span><br><span class="line">00000020: 732d 6269 7473 c040 fa05 6374 696d 65c2  s-bits.@..ctime.</span><br><span class="line">00000030: b358 7c65 fa08 7573 6564 2d6d 656d c2c8  .X|e..used-mem..</span><br><span class="line">00000040: 3420 00fa 0861 6f66 2d62 6173 65c0 00fe  4 ...aof-base...</span><br><span class="line">00000050: 00fb 0200 0002 6b32 026b 3200 026b 3102  ......k2.k2..k1.   </span><br><span class="line">00000060: 6b31 ff7c 8471 bff0 fe75 7c              k1.|.q...u|    </span><br></pre></td></tr></table></figure>

<p>可以看到最後兩行有剛剛k1與k2的資料，代表已經實質的從記憶體儲放一份到硬碟上，至於多久要寫入一次的要根據伺服器可用的效能去評估與設定。</p>
<blockquote>
<p>補充說明：xxd是一個可以查看2進制或16進制文件內容的linux命令</p>
</blockquote>
<p>另外，通常在使用redis時配給的資源通常會給比較多，而在使用<code>save</code>指令時，redis是無法接受任何請求的，所以有可能會發生阻塞。於是redis又提供了另一個指令<code>bgsave</code>，這個指令可以直接多開一個執行緒，讓它獨立做記憶體搬到IO的工作。這樣的作法可以讓阻塞問題得到緩解。但是在fork出一個新的執行緒的過程中還是會佔用效能，而且在fork過程式，還是沒有辦法處理任何請求，沒有辦法做到秒級的快照。</p>
<p>為了解決這個問題，又提供了AOF的持久化方式。</p>
<h3 id="16-3-AOF-Append-Only-File"><a href="#16-3-AOF-Append-Only-File" class="headerlink" title="16.3. AOF(Append Only File)"></a>16.3. AOF(Append Only File)</h3><p><code>AOF</code>意思是指追加文件，當使用指令時，同時寫入<code>記憶體</code>與<code>追加文件</code>，文件以日誌的方式記錄每一個寫入操作，當REDIS重啟動時，就會通過重新執行<code>AOF</code>文件中的命令來在記憶體中重建整個資料庫的內容。開啟AOF的方式也很簡單，只要在<code>redis.config</code>將<code>appendonly</code> 後方的<code>no</code> 改為<code>yes</code>即可。</p>
<h2 id="17-Replication-主從複製"><a href="#17-Replication-主從複製" class="headerlink" title="17. Replication 主從複製"></a>17. Replication 主從複製</h2><p>Master(主)節點主要負責<code>寫</code>的處理，Slave(從)節點負責<code>讀</code>的處理，主節點的數據變化會通過非同步方式發送給從節點，從節點收到資料後，會更新自己的數據</p>
<p><img src="https://i.imgur.com/tMREXiC.png" alt="Redis: Master-Slave Architecture. Redis is based on Master-Slave… | by  Sunny Garg | Medium"></p>
<h3 id="17-1-Master-建置"><a href="#17-1-Master-建置" class="headerlink" title="17.1. Master 建置"></a>17.1. Master 建置</h3><p>這次實驗透過docker進行，準備1個master，2個slave。</p>
<p>docker預設都是吃同一個switch設定，所以自然可以透過區網方式互相訪問。</p>
<p>開始建置master容器，容器取名為<code>redis-master</code>，指令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name redis-master -d -p 6379:6379 redis</span><br></pre></td></tr></table></figure>

<p>我們為了要取得master區網IP，因此需進入容器中，安裝<code>net-tools</code>工具：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install net-tools</span><br></pre></td></tr></table></figure>

<p>使用<code>ifconfig</code>指令，從訊息中得知ip為<code>172.17.0.2</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ifconfig</span></span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 7614  bytes 9949276 (9.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2430  bytes 162974 (159.1 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 61  bytes 208513 (203.6 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 61  bytes 208513 (203.6 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<h3 id="17-2-Slave-建置"><a href="#17-2-Slave-建置" class="headerlink" title="17.2. Slave 建置"></a>17.2. Slave 建置</h3><p>方法1</p>
<p>使用此方法，不需要準備<code>redis.conf</code>檔</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name redis-slave01 -p 6380:6379 redis redis-server --slaveof 172.17.0.2 6379</span><br></pre></td></tr></table></figure>

<p>方法2</p>
<p>建置slave容器之前，我們準備一個<code>redis.conf</code>檔，僅說明需要修改部分(完整檔案放在參考連結那)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replicaof 172.17.0.2 6379</span><br></pre></td></tr></table></figure>

<p>使用方法2，開始建置slave容器，容器取名為<code>redis-slave01</code>，指令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name redis-slave01 -d -p 6380:6379 -v C:/docker_data/redis-6380.conf:/usr/local/etc/redis/redis-6380.conf redis redis-server /usr/local/etc/redis/redis-6380.conf</span><br></pre></td></tr></table></figure>

<p>說明相關指令</p>
<p><code>v C:/docker_data/redis-6380.conf:/usr/local/etc/redis/redis-6380.conf redis</code>：將準備好的檔案放在c槽，並以volumn 方式放到docker指定位置。</p>
<p><code> redis-server /usr/local/etc/redis/redis-6380.conf</code>：redis啟動後參考此config設定</p>
<h3 id="17-3-實驗階段"><a href="#17-3-實驗階段" class="headerlink" title="17.3. 實驗階段"></a>17.3. 實驗階段</h3><h4 id="17-3-1-進入Master容器中，簡單設定幾個變數"><a href="#17-3-1-進入Master容器中，簡單設定幾個變數" class="headerlink" title="17.3.1. 進入Master容器中，簡單設定幾個變數"></a>17.3.1. 進入<code>Master</code>容器中，簡單設定幾個變數</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty array)</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 k1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 k2</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<h4 id="17-3-2-進入Slave容器中，確認同步狀況"><a href="#17-3-2-進入Slave容器中，確認同步狀況" class="headerlink" title="17.3.2. 進入Slave容器中，確認同步狀況"></a>17.3.2. 進入<code>Slave</code>容器中，確認同步狀況</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it 274f /bin/bash</span><br><span class="line">root@274f984345a9:/data<span class="comment"># redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">&quot;k2&quot;</span></span><br><span class="line">2) <span class="string">&quot;k1&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="17-3-3-再增加一個Slave，這次特別使用方法1："><a href="#17-3-3-再增加一個Slave，這次特別使用方法1：" class="headerlink" title="17.3.3. 再增加一個Slave，這次特別使用方法1："></a>17.3.3. 再增加一個<code>Slave</code>，這次特別使用方法1：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name redis-slave02 -p 6381:6379 redis redis-server --slaveof 172.17.0.2 6379</span><br></pre></td></tr></table></figure>

<p>節點資源最後如下</p>
<p><img src="https://i.imgur.com/XBw6qQy.png" alt="image-20231216103946054"></p>
<h4 id="17-3-4-Master開始寫入資料，觀查Slave是否同步，如下："><a href="#17-3-4-Master開始寫入資料，觀查Slave是否同步，如下：" class="headerlink" title="17.3.4. Master開始寫入資料，觀查Slave是否同步，如下："></a>17.3.4. Master開始寫入資料，觀查Slave是否同步，如下：</h4><p><img src="https://i.imgur.com/zXP20s8.png" alt="image-20231216103824221"></p>
<h2 id="18-模擬排隊程式"><a href="#18-模擬排隊程式" class="headerlink" title="18. 模擬排隊程式"></a>18. 模擬排隊程式</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// See https://aka.ms/new-console-template for more information</span></span><br><span class="line"><span class="keyword">using</span> StackExchange.Redis;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立 ConnectionMultiplexer</span></span><br><span class="line"><span class="keyword">var</span> redis = ConnectionMultiplexer.Connect(<span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">IDatabase db = redis.GetDatabase();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空可能存在的相關鍵</span></span><br><span class="line">db.KeyDelete(<span class="string">&quot;queue&quot;</span>);</span><br><span class="line">db.KeyDelete(<span class="string">&quot;processed&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 啟動兩個模擬客戶端</span></span><br><span class="line">Task.Run(() =&gt; EnqueueCustomers(redis));</span><br><span class="line">Task.Run(() =&gt; ProcessQueue(redis));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 防止主執行緒退出</span></span><br><span class="line">Console.ReadLine();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">EnqueueCustomers</span>(<span class="params">ConnectionMultiplexer redis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    IDatabase db = redis.GetDatabase();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> customerNumber = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> customer = <span class="string">$&quot;Customer-<span class="subst">&#123;customerNumber&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 將客戶加入排隊</span></span><br><span class="line">        db.ListRightPush(<span class="string">&quot;queue&quot;</span>, customer);</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Enqueued <span class="subst">&#123;customer&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 模擬客戶隨機到達的時間</span></span><br><span class="line">        <span class="keyword">await</span> Task.Delay(TimeSpan.FromSeconds(<span class="keyword">new</span> Random().Next(<span class="number">1</span>, <span class="number">5</span>)));</span><br><span class="line"></span><br><span class="line">        customerNumber++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">ProcessQueue</span>(<span class="params">ConnectionMultiplexer redis</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    IDatabase db = redis.GetDatabase();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 從排隊中取得下一位客戶</span></span><br><span class="line">        <span class="built_in">string</span> customer = db.ListLeftPop(<span class="string">&quot;queue&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (customer != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 處理客戶</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Processing <span class="subst">&#123;customer&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 將已處理的客戶加入已處理清單</span></span><br><span class="line">            db.ListRightPush(<span class="string">&quot;processed&quot;</span>, customer);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 若排隊為空，等待一段時間再檢查</span></span><br><span class="line">            <span class="keyword">await</span> Task.Delay(TimeSpan.FromSeconds(<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="18-1-執行過程"><a href="#18-1-執行過程" class="headerlink" title="18.1. 執行過程"></a>18.1. 執行過程</h3><p><img src="https://i.imgur.com/Qzk5Pxh.png" alt="image-20231211164712006"></p>
<h3 id="18-2-觀查redis狀況"><a href="#18-2-觀查redis狀況" class="headerlink" title="18.2. 觀查redis狀況"></a>18.2. 觀查redis狀況</h3><p><img src="https://i.imgur.com/7ra7MSN.png" alt="image-20231211164740246"></p>
<h2 id="19-參考連結"><a href="#19-參考連結" class="headerlink" title="19. 參考連結"></a>19. 參考連結</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/qishibo/AnotherRedisDesktopManager/">GUI工具：GitHub:Another Redis Desktop Manager</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Jj411D7oG/">【GeekHour】一小时Redis教程</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/443370796">谈谈Redis五种数据结构及真实应用场景</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/42056183">分布式锁看这篇就够了</a><ul>
<li>有空記得看</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/redis/redis/7.2/redis.conf">官網Redis 7.2 config 參考</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kitefree/RedisNote">個人筆記-RedisNote</a><ul>
<li>包含程式碼範例、redis config檔</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2023/10/11/2023-12-12%20EFCore%E8%AE%80%E5%AF%AB%E5%88%86%E9%9B%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/10/11/2023-12-12%20EFCore%E8%AE%80%E5%AF%AB%E5%88%86%E9%9B%A2/" class="post-title-link" itemprop="url">EFCore讀寫分離</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2023-10-11 22:33:00" itemprop="dateCreated datePublished" datetime="2023-10-11T22:33:00+08:00">2023-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-14 23:25:08" itemprop="dateModified" datetime="2023-12-14T23:25:08+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%8C%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">後端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>5.5k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>10 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="讀寫分離示意圖"><a href="#讀寫分離示意圖" class="headerlink" title="讀寫分離示意圖"></a>讀寫分離示意圖</h2><p><img src="https://i.imgur.com/AswBDyN.png" alt="image-20231213101632763"></p>
<p><code>發佈伺服器</code>的實作可以透過<code>SQLSERVER</code>的<code>複寫</code>功能，分別設定<code>發佈</code>與<code>訂閱</code>，資料庫複寫設定有興趣可以參考相關連結。以下針對程式碼如何實踐讀寫分離，做個紀錄筆記。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/10/11/2023-12-12%20EFCore%E8%AE%80%E5%AF%AB%E5%88%86%E9%9B%A2/#more" rel="contents">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/06/2022-08-06%20Vue3TypeScript(5)%20-%20%E6%B8%B2%E6%9F%93404%E5%92%8C%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/06/2022-08-06%20Vue3TypeScript(5)%20-%20%E6%B8%B2%E6%9F%93404%E5%92%8C%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2/" class="post-title-link" itemprop="url">Vue3TypeScript(5) - 渲染404和登入頁面</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-06 23:01:00" itemprop="dateCreated datePublished" datetime="2022-08-06T23:01:00+08:00">2022-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-14 23:02:56" itemprop="dateModified" datetime="2023-12-14T23:02:56+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>6.8k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>12 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-404-頁面實作"><a href="#1-404-頁面實作" class="headerlink" title="1. 404 頁面實作"></a>1. 404 頁面實作</h2><h3 id="1-1-新增views-404-vue"><a href="#1-1-新增views-404-vue" class="headerlink" title="1.1. 新增views\404.vue"></a>1.1. 新增<code>views\404.vue</code></h3><p><code>404.vue</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;not-found&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../assets/404-error.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;error&quot;</span>&gt;</span>        </span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;goback&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;$router.push(&#x27;/&#x27;)&quot;</span>&gt;</span>The page you are looking for can’t be found. Go home by clicking here!<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.not-found</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">overflow</span>: hidden;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.not-found</span> <span class="selector-tag">img</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.goback</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">top</span>: <span class="number">80%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">left</span>: <span class="number">31%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">48</span>, <span class="number">173</span>, <span class="number">211</span>);</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">outline</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">border</span>: none;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="1-2-修改router-index-ts"><a href="#1-2-修改router-index-ts" class="headerlink" title="1.2. 修改router\index.ts"></a>1.2. 修改<code>router\index.ts</code></h3><p>使用<code>path/:catchAll(.*)</code>，只要是找不到的都會指向到這</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; =[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;Login&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Login.vue&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/:catchAll(.*)&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;404&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/404.vue&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="1-3-最後結果"><a href="#1-3-最後結果" class="headerlink" title="1.3. 最後結果"></a>1.3. 最後結果</h3><p><img src="https://i.imgur.com/DXFIhlk.png" alt="image-20220807005958868"></p>
<h2 id="2-登入頁實作"><a href="#2-登入頁實作" class="headerlink" title="2. 登入頁實作"></a>2. 登入頁實作</h2><p>在登入頁實作跳轉到後台介面過程，就必須與後端進行串接工作，而在現行主流前後端分離架構下，Mock Server 的準備是前端工程師開發流程非常重要的技能之一。之前就知道的Mock Server 工具是<code>JSON-Server</code>，這是一套運行在<code>node js</code>環境底下的工具。</p>
<p>今天想嘗試另一套「<code>POSTMAN</code> 」軟體，其中也支援這樣的功能，有機會再寫一篇介紹，使用方式與介紹先跳過…總之最後可以取得一個對外的URL提供使用。</p>
<h3 id="2-1-使用vite-config-ts進行代理"><a href="#2-1-使用vite-config-ts進行代理" class="headerlink" title="2.1. 使用vite.config.ts進行代理"></a>2.1. 使用<code>vite.config.ts</code>進行代理</h3><h4 id="2-1-1-修改-vite-config-ts"><a href="#2-1-1-修改-vite-config-ts" class="headerlink" title="2.1.1. 修改\vite.config.ts"></a>2.1.1. 修改<code>\vite.config.ts</code></h4><p>這邊增加了 <code>server proxy</code>，其中<code>target</code> 填上了<code>POSTMAN</code>產生的URL，<code>rewrite</code>部分也請記得改寫</p>
<p><code>vite.config.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()</span><br><span class="line">    ,</span><br><span class="line">  <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">    <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="title class_">Components</span>(&#123;</span><br><span class="line">    <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">  &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">server</span>:&#123;</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;https://c37e652f-46f8-4272-a694-85e33c3766b1.mock.pstmn.io&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">rewrite</span>: <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> path.<span class="title function_">replace</span>(<span class="string">&#x27;/api&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-修改src-views-Login-vue"><a href="#2-1-2-修改src-views-Login-vue" class="headerlink" title="2.1.2. 修改src\views\Login.vue"></a>2.1.2. 修改<code>src\views\Login.vue</code></h4><p>實際上登入驗證的URL路徑為<code>https://c37e652f-46f8-4272-a694-85e33c3766b1.mock.pstmn.io/login</code>，因為我們使用了代理的關係，這邊填的URL就會以<code>api</code>為開頭：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/api/login&quot;</span>,formData);</span><br></pre></td></tr></table></figure>

<p><code>Login.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;h1&gt;英語字典管理系統&lt;/h1&gt;</span><br><span class="line">        &lt;el-divider style=&quot;border-color:black&quot; /&gt;</span><br><span class="line">        &lt;el-row class=&quot;row&quot; justify=&quot;center&quot; style=&quot;margin-bottom:1.2rem;&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;flex items-center&quot;&gt;</span><br><span class="line">                &lt;el-radio-group v-model=&quot;rdoRole&quot;&gt;</span><br><span class="line">                    &lt;el-radio label=&quot;admin&quot; size=&quot;large&quot;&gt;管理員&lt;/el-radio&gt;</span><br><span class="line">                    &lt;el-radio label=&quot;student&quot; size=&quot;large&quot;&gt;考生&lt;/el-radio&gt;</span><br><span class="line">                &lt;/el-radio-group&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">        &lt;el-row class=&quot;row&quot; justify=&quot;center&quot;&gt;</span><br><span class="line">            &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">                &lt;el-form :label-position=&quot;labelPosition&quot; label-width=&quot;100px&quot; :model=&quot;formData&quot; style=&quot;max-width: 560px&quot;&gt;</span><br><span class="line">                    &lt;el-form-item label=&quot;帳號&quot;&gt;</span><br><span class="line">                        &lt;el-input v-model=&quot;formData.account&quot; placeholder=&quot;請輸入帳號&quot; /&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                    &lt;el-form-item label=&quot;密碼&quot;&gt;</span><br><span class="line">                        &lt;el-input v-model=&quot;formData.password&quot; type=&quot;password&quot; placeholder=&quot;請輸入密碼&quot; show-password /&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                    &lt;div style=&quot;text-align:center&quot;&gt;</span><br><span class="line">                        &lt;el-button @click=&quot;btnLogin&quot; type=&quot;info&quot; round</span><br><span class="line">                            style=&quot;text-align:center;width:150px;font-size:1.5rem;background: #4A4A4A;padding:1.5rem&quot;&gt;登入</span><br><span class="line">                        &lt;/el-button&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;/el-form&gt;</span><br><span class="line">            &lt;/el-col&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; reactive, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">const rdoRole = ref(&#x27;admin&#x27;)</span><br><span class="line">const labelPosition = ref(&#x27;top&#x27;)</span><br><span class="line"></span><br><span class="line">const formData = reactive(&#123;</span><br><span class="line">    account: &#x27;&#x27;,</span><br><span class="line">    password: &#x27;&#x27;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const btnLogin = async () =&gt; &#123;</span><br><span class="line">    console.log(rdoRole.value);</span><br><span class="line">    console.log(formData);</span><br><span class="line">    </span><br><span class="line">    if (formData.account != &#x27;&#x27; &amp;&amp; formData.password != &#x27;&#x27;) &#123;</span><br><span class="line">        console.log(&#x27;ajax&#x27;);  </span><br><span class="line">        const &#123; data &#125; = await axios.post(&quot;/api/login&quot;,formData);</span><br><span class="line">        console.log(data);</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        console.log(&#x27;data 不完整&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.container &#123;</span><br><span class="line">    width: 800px;</span><br><span class="line">    margin: 10% auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h1 &#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 2rem;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-最後結果"><a href="#2-1-3-最後結果" class="headerlink" title="2.1.3. 最後結果"></a>2.1.3. 最後結果</h4><p>觀查request console log ，的確有收到server 的response data</p>
<p><img src="https://i.imgur.com/qfEsPeJ.png" alt="image-20220807114039287"></p>
<p>觀查request URL值為<code>http:127.0.0.1:5173/api/login</code>，顯然代理成功，但還是對我感到好奇…實際上是怎麼做到的？有機會回來再了解一下</p>
<p><img src="https://i.imgur.com/KJSbvUT.png" alt="image-20220807114127268"></p>
<h3 id="2-2-設定axios-defaults-baseURL"><a href="#2-2-設定axios-defaults-baseURL" class="headerlink" title="2.2. 設定axios.defaults.baseURL"></a>2.2. 設定<code>axios.defaults.baseURL</code></h3><p>這個部分其實還有很多issue，就是如何做到<code>產品階段設定</code>、<code>開發階段設定</code>吃不一樣的設定檔，這個部分後續花時間回來補一下。</p>
<p>先記錄一下簡單的版本，在有使用axios的地方，起頭就先宣告<code>baseURL</code>：</p>
<p><code>src\view\Login.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; reactive, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">axios.defaults.baseURL=&quot;https://c37e652f-46f8-4272-a694-85e33c3766b1.mock.pstmn.io&quot;;</span><br><span class="line">const rdoRole = ref(&#x27;admin&#x27;)</span><br><span class="line">const labelPosition = ref(&#x27;top&#x27;)</span><br><span class="line"></span><br><span class="line">const formData = reactive(&#123;</span><br><span class="line">    account: &#x27;&#x27;,</span><br><span class="line">    password: &#x27;&#x27;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const btnLogin = async () =&gt; &#123;</span><br><span class="line">    console.log(rdoRole.value);</span><br><span class="line">    console.log(formData);</span><br><span class="line">    </span><br><span class="line">    if (formData.account != &#x27;&#x27; &amp;&amp; formData.password != &#x27;&#x27;) &#123;</span><br><span class="line">        console.log(&#x27;ajax&#x27;);  </span><br><span class="line">        const &#123; data &#125; = await axios.post(&quot;/login&quot;,formData);</span><br><span class="line">        console.log(data);   </span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        console.log(&#x27;data 不完整&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="3-伺服器回傳後，前端繼續驗證與處理"><a href="#3-伺服器回傳後，前端繼續驗證與處理" class="headerlink" title="3. 伺服器回傳後，前端繼續驗證與處理"></a>3. 伺服器回傳後，前端繼續驗證與處理</h2><p>接續使用代理方式進行開發，下段程式碼透過<code>localStorage</code>先儲存回傳的<code>token</code>值，<code>element plus</code> 套件的<code>ElMessage</code>元件呈現登入成功的效果(toast notification)</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">btnLogin</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rdoRole.<span class="property">value</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(formData);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (formData.<span class="property">account</span> != <span class="string">&#x27;&#x27;</span> &amp;&amp; formData.<span class="property">password</span> != <span class="string">&#x27;&#x27;</span>) &#123;        </span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/api/login&quot;</span>,formData);</span><br><span class="line">        <span class="keyword">const</span> &#123; token &#125; = data.<span class="property">data</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);        </span><br><span class="line">        <span class="keyword">if</span>(data.<span class="property">status</span> == <span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        &#123;            </span><br><span class="line">            <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>,token);</span><br><span class="line">            <span class="comment">// @ts-ignore</span></span><br><span class="line">            <span class="title class_">ElMessage</span>(&#123;</span><br><span class="line">                <span class="attr">showClose</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;登入成功.&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            router.<span class="title function_">push</span>(<span class="string">&#x27;/Main&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;帳密錯誤&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data 不完整&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<p><img src="https://i.imgur.com/MSZ8oDv.png" alt="image-20220807201545862"></p>
<p>其中有一個<code>ts-ignore</code>要特別說明，因為稍早我們使用的是<code>自動載入</code>的方式，所以在開發階段的智能提示，會誤以為沒有進行import動作。要消除這個錯誤提示，我們可以在<code>ElMessage</code>上方加上<code>ts-ignore</code>寫法，錯誤就消失囉！</p>
<h2 id="4-參考資料"><a href="#4-參考資料" class="headerlink" title="4. 參考資料"></a>4. 參考資料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/AIfurture/article/details/108616830?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-108616830-blog-89886735.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-108616830-blog-89886735.pc_relevant_default&utm_relevant_index=2">vue中使用axios给生产环境和开发环境配置不同的baseUrl</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41023528/article/details/89886735">axios.defaults.baseURL的三种配置方法</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/06/2022-08-06%20Vue3TypeScript(6)%20-%20%E5%AF%A6%E7%8F%BE%E8%B7%AF%E7%94%B1%E5%AE%88%E8%A1%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/06/2022-08-06%20Vue3TypeScript(6)%20-%20%E5%AF%A6%E7%8F%BE%E8%B7%AF%E7%94%B1%E5%AE%88%E8%A1%9B/" class="post-title-link" itemprop="url">Vue3TypeScript(6) - 實現路由守衛</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-06 23:01:00" itemprop="dateCreated datePublished" datetime="2022-08-06T23:01:00+08:00">2022-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-14 23:03:01" itemprop="dateModified" datetime="2023-12-14T23:03:01+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>1.6k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>3 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="實現路由守衛"><a href="#實現路由守衛" class="headerlink" title="實現路由守衛"></a>實現路由守衛</h2><p>主要的設計思維是在router的流程中進行驗證，我們來看如何修正<code>src\router\index.ts</code>檔案：</p>
<p><code>index.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">isLogin</span>:<span class="built_in">boolean</span> = <span class="variable language_">localStorage</span>.<span class="property">token</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// console.log(`isLogin:$&#123;isLogin&#125;`);    </span></span><br><span class="line">    <span class="comment">// console.log(to.path);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(to.<span class="property">path</span> ===<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#123;        </span><br><span class="line">        <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>);        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(to.<span class="property">path</span> === <span class="string">&#x27;/login&#x27;</span> )&#123;                </span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">        isLogin ? <span class="title function_">next</span>() : <span class="title function_">next</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="完整程式碼"><a href="#完整程式碼" class="headerlink" title="完整程式碼"></a>完整程式碼</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHistory,<span class="title class_">RouteRecordRaw</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; =[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;Login&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Login.vue&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/login&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;Login&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Login.vue&quot;</span>)</span><br><span class="line">    &#125;,    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/main&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;Main&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Main.vue&quot;</span>)</span><br><span class="line">    &#125;,    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/:catchAll(.*)&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;404&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/404.vue&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">        routes</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">isLogin</span>:<span class="built_in">boolean</span> = <span class="variable language_">localStorage</span>.<span class="property">token</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// console.log(`isLogin:$&#123;isLogin&#125;`);    </span></span><br><span class="line">    <span class="comment">// console.log(to.path);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(to.<span class="property">path</span> ===<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#123;        </span><br><span class="line">        <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>);        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(to.<span class="property">path</span> === <span class="string">&#x27;/login&#x27;</span> )&#123;                </span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">        isLogin ? <span class="title function_">next</span>() : <span class="title function_">next</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/06/2022-08-06%20Vue3TypeScript(4)%20-%20%E5%AE%89%E8%A3%9DElement-Plus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/06/2022-08-06%20Vue3TypeScript(4)%20-%20%E5%AE%89%E8%A3%9DElement-Plus/" class="post-title-link" itemprop="url">Vue3TypeScript(4) - 安裝Element-Plus</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-06 22:01:00" itemprop="dateCreated datePublished" datetime="2022-08-06T22:01:00+08:00">2022-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-14 23:02:49" itemprop="dateModified" datetime="2023-12-14T23:02:49+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>2.2k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>4 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-Element-Plus"><a href="#1-Element-Plus" class="headerlink" title="1. Element-Plus"></a>1. Element-Plus</h2><p>可參考官網的<a target="_blank" rel="noopener" href="https://element-plus.gitee.io/zh-CN/guide/installation.html">安裝手冊</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">NPM</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install element-plus --save</span></span><br></pre></td></tr></table></figure>



<h2 id="2-快速開始-完整導入"><a href="#2-快速開始-完整導入" class="headerlink" title="2. 快速開始 - 完整導入"></a>2. 快速開始 - 完整導入</h2><p>對於網站打包大小不在乎，可以使用這個。</p>
<h3 id="2-1-main-ts修改"><a href="#2-1-main-ts修改" class="headerlink" title="2.1. main.ts修改"></a>2.1. <code>main.ts</code>修改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import ElementPlus from &#x27;element-plus&#x27;</span><br><span class="line">import &#x27;element-plus/dist/index.css&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(ElementPlus)</span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="2-2-App-vue修改"><a href="#2-2-App-vue修改" class="headerlink" title="2.2. App.vue修改"></a>2.2. <code>App.vue</code>修改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-row class=&quot;mb-4&quot;&gt;</span><br><span class="line">    &lt;el-button&gt;Default&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot;&gt;Primary&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;success&quot;&gt;Success&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;info&quot;&gt;Info&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;warning&quot;&gt;Warning&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;danger&quot;&gt;Danger&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button&gt;中文&lt;/el-button&gt;</span><br><span class="line">  &lt;/el-row&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">html,</span><br><span class="line">body&#123;</span><br><span class="line">    width:100%;</span><br><span class="line">    height:100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-3-最後結果"><a href="#2-3-最後結果" class="headerlink" title="2.3. 最後結果"></a>2.3. 最後結果</h3><p><img src="https://i.imgur.com/y1HcRO6.png" alt="image-20220806223348857"></p>
<h2 id="3-快速開始-自動導入"><a href="#3-快速開始-自動導入" class="headerlink" title="3. 快速開始 - 自動導入"></a>3. 快速開始 - 自動導入</h2><p>首先你需要安裝<code>unplugin-vue-components</code> 和 <code>unplugin-auto-import</code> 兩款套件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D unplugin-vue-components unplugin-auto-import</span><br></pre></td></tr></table></figure>

<h3 id="3-1-修改vite-config-ts-或-webpack"><a href="#3-1-修改vite-config-ts-或-webpack" class="headerlink" title="3.1. 修改vite.config.ts 或 webpack"></a>3.1. 修改<code>vite.config.ts</code> 或 <code>webpack</code></h3><p>這次練習改<code>vite.config.ts</code>：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AutoImport</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElementPlusResolver</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()</span><br><span class="line">    ,</span><br><span class="line">  <span class="title class_">AutoImport</span>(&#123;</span><br><span class="line">    <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="title class_">Components</span>(&#123;</span><br><span class="line">    <span class="attr">resolvers</span>: [<span class="title class_">ElementPlusResolver</span>()],</span><br><span class="line">  &#125;),</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-2-修改main-ts"><a href="#3-2-修改main-ts" class="headerlink" title="3.2. 修改main.ts"></a>3.2. 修改<code>main.ts</code></h3><p>確實將import elementplus 的程式註解：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/reset.css&#x27;</span></span><br><span class="line"><span class="comment">//import ElementPlus from &#x27;element-plus&#x27;</span></span><br><span class="line"><span class="comment">//import &#x27;element-plus/dist/index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line"><span class="comment">//app.use(ElementPlus)</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-3-最後結果"><a href="#3-3-最後結果" class="headerlink" title="3.3. 最後結果"></a>3.3. 最後結果</h3><p>再跑一次 <code>npm run dev</code>驗證結果，確實有自動導入功能：</p>
<p><img src="https://i.imgur.com/RSWHGxQ.png" alt="image-20220806224608276"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/06/2022-08-06%20Vue3TypeScript(3)%20-%20%E5%89%B5%E5%BB%BA%E8%B7%AF%E7%94%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/06/2022-08-06%20Vue3TypeScript(3)%20-%20%E5%89%B5%E5%BB%BA%E8%B7%AF%E7%94%B1/" class="post-title-link" itemprop="url">Vue3TypeScript(3) - 創建新由</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-06 19:01:00" itemprop="dateCreated datePublished" datetime="2022-08-06T19:01:00+08:00">2022-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-12-14 23:02:48" itemprop="dateModified" datetime="2023-12-14T23:02:48+08:00">2023-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>1.4k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>3 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-安裝路由"><a href="#1-安裝路由" class="headerlink" title="1. 安裝路由"></a>1. 安裝路由</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router</span><br></pre></td></tr></table></figure>
<h2 id="2-系統架構配置"><a href="#2-系統架構配置" class="headerlink" title="2. 系統架構配置"></a>2. 系統架構配置</h2><h3 id="2-1-新增資料夾-src-router"><a href="#2-1-新增資料夾-src-router" class="headerlink" title="2.1. 新增資料夾 src\router"></a>2.1. 新增資料夾 <code>src\router</code></h3><p>請在<code>src\</code>資料夾底下建立<code>router</code>資料夾，預期結果<code>src\router</code></p>
<h3 id="2-2-新增資料夾-src-views"><a href="#2-2-新增資料夾-src-views" class="headerlink" title="2.2. 新增資料夾 src\views"></a>2.2. 新增資料夾 <code>src\views</code></h3><p>請在<code>src\</code>資料夾底下建立<code>view</code>資料夾，預期結果<code>src\view</code></p>
<h3 id="2-3-新增src-view-Home-vue"><a href="#2-3-新增src-view-Home-vue" class="headerlink" title="2.3. 新增src\view\Home.vue"></a>2.3. 新增<code>src\view\Home.vue</code></h3><p>請在<code>src\views\</code>資料夾底下建立<code>Home.vue</code>，預期結果<code>src\view\Home.vue</code>，並填寫以下內容：</p>
<p><code>Home.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;初始化頁面&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">export default&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-新增src-router-index-ts"><a href="#2-4-新增src-router-index-ts" class="headerlink" title="2.4. 新增src\router\index.ts"></a>2.4. 新增<code>src\router\index.ts</code></h3><p>請在<code>src\router\</code>底下建立<code>index.ts</code>檔案，稍候再來填寫，預期結果<code>src\router\index.ts</code>，並填寫以下內容：</p>
<p><code>index.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHistory,<span class="title class_">RouteRecordRaw</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Array</span>&lt;<span class="title class_">RouteRecordRaw</span>&gt; =[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>:<span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&quot;Home&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>:<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../views/Home.vue&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">        routes</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<h3 id="2-5-修改src-main-ts"><a href="#2-5-修改src-main-ts" class="headerlink" title="2.5. 修改src\main.ts"></a>2.5. 修改<code>src\main.ts</code></h3><p><code>main.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/reset.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-6-修改src-App-vue"><a href="#2-6-修改src-App-vue" class="headerlink" title="2.6. 修改src\App.vue"></a>2.6. 修改<code>src\App.vue</code></h3><p><code>App.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">html,</span><br><span class="line">body&#123;</span><br><span class="line">    width:100%;</span><br><span class="line">    height:100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-最後結果"><a href="#3-最後結果" class="headerlink" title="3. 最後結果"></a>3. 最後結果</h2><p>執行<code>npm run dev</code>，預期結果如下：</p>
<p><img src="https://i.imgur.com/e9tkhVr.png" alt="image-20220806221642538"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/06/2022-08-06%20Vue3TypeScript(2)%20-%20%E5%89%B5%E5%BB%BA%E9%A0%85%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/06/2022-08-06%20Vue3TypeScript(2)%20-%20%E5%89%B5%E5%BB%BA%E9%A0%85%E7%9B%AE/" class="post-title-link" itemprop="url">Vue3TypeScript(2) - 創建項目</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-06 17:01:00" itemprop="dateCreated datePublished" datetime="2022-08-06T17:01:00+08:00">2022-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-07 00:41:18" itemprop="dateModified" datetime="2022-08-07T00:41:18+08:00">2022-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>531</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-安裝"><a href="#1-安裝" class="headerlink" title="1. 安裝"></a>1. 安裝</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vite@latest vue3-vite-ts-vuex-element-plus</span><br></pre></td></tr></table></figure>
<h3 id="1-1-select-a-framework"><a href="#1-1-select-a-framework" class="headerlink" title="1.1. select a framework"></a>1.1. select a framework</h3><p>會提示選擇，選<code>vue</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue</span><br></pre></td></tr></table></figure>

<h3 id="1-2-select-a-variant"><a href="#1-2-select-a-variant" class="headerlink" title="1.2. select a variant"></a>1.2. select a variant</h3><p>第二次提示，選<code>vue-ts</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue-ts</span><br></pre></td></tr></table></figure>

<h3 id="1-3-npm-install"><a href="#1-3-npm-install" class="headerlink" title="1.3. npm install"></a>1.3. npm install</h3><p>經由上述初始設定後，輸入指令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>



<h2 id="2-進行簡單整理"><a href="#2-進行簡單整理" class="headerlink" title="2. 進行簡單整理"></a>2. 進行簡單整理</h2><p><code>App.vue</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看一下package.json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;dev&quot;: &quot;vite&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;vue-tsc --noEmit &amp;&amp; vite build&quot;,</span><br><span class="line">  &quot;preview&quot;: &quot;vite preview&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>因此我們可以 使用 <code>npm run dev</code>，啟動了網頁伺服器</p>
<p><img src="https://i.imgur.com/5UHbkP3.png" alt="image-20220806170832284"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/08/02/2022-08-02%20%E7%B6%B2%E7%AB%99%E5%BC%B1%E9%BB%9E%E6%8E%83%E6%8F%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/02/2022-08-02%20%E7%B6%B2%E7%AB%99%E5%BC%B1%E9%BB%9E%E6%8E%83%E6%8F%8F/" class="post-title-link" itemprop="url">網站弱點掃描</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-08-02 21:58:00" itemprop="dateCreated datePublished" datetime="2022-08-02T21:58:00+08:00">2022-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-03 19:36:24" itemprop="dateModified" datetime="2022-08-03T19:36:24+08:00">2022-08-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%B3%87%E5%AE%89/" itemprop="url" rel="index"><span itemprop="name">資安</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>4.8k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>9 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>寫這篇的原因是因為筆者經過OWASP ZAP修正弱點努力後，客戶後續實際請資安廠商進行掃描。客戶聯絡我需要進行弱點修正，以下記錄一些學習資訊。</p>
<h2 id="環境說明"><a href="#環境說明" class="headerlink" title="環境說明"></a>環境說明</h2><ol>
<li>Windows Server 2016</li>
<li>IIS10</li>
<li>網站架構(無後端程式碼)<ol>
<li>HTML</li>
<li>JS</li>
<li>SCSS</li>
<li>CSS</li>
</ol>
</li>
</ol>
<h2 id="科普名詞"><a href="#科普名詞" class="headerlink" title="科普名詞"></a>科普名詞</h2><h3 id="TLS-Transport-Layer-Security，傳輸層安全性"><a href="#TLS-Transport-Layer-Security，傳輸層安全性" class="headerlink" title="TLS -  (Transport Layer Security，傳輸層安全性)"></a>TLS -  (Transport Layer Security，傳輸層安全性)</h3><blockquote>
<p>TSL (Transport Layer Security，傳輸層安全性) 是更新、更安全的 SSL 版本。我們仍將安全性憑證稱為 SSL，因為這是較常用的詞彙，不過當您透過DigiCert<a target="_blank" rel="noopener" href="https://www.websecurity.digicert.com/zh/tw/ssl-certificate?inid=infoctr_buylink_sslhome">購買 SSL </a>時，您所購買的其實是最新的 TLS 憑證及 <a target="_blank" rel="noopener" href="https://www.websecurity.digicert.com/zh/tw/security-topics/how-ssl-works">ECC、RSA 或 DSA 的加密選項</a>。</p>
</blockquote>
<p>簡單來說，<code>TLS</code>是更安全的版本，從<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-tw/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A">WIKI資料</a>，也可以看到棄用的狀況：</p>
<p><img src="https://i.imgur.com/0heFAtT.png" alt="image-20220802205731442"></p>
<h3 id="Cipher-密碼"><a href="#Cipher-密碼" class="headerlink" title="Cipher - 密碼"></a>Cipher - 密碼</h3><blockquote>
<p>在密碼學中，<strong>密碼</strong>（英語：cipher，或cypher），是一種用於執行<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8A%A0%E5%AF%86">加密</a>或<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%A7%A3%E5%AF%86">解密</a>的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%AE%97%E6%B3%95">演算法</a>——一系列可以作為一個過程來遵循的定義明確的步驟</p>
</blockquote>
<p>比較好聯想的就是我們常說的對稱加密<code>AES</code>、<code>DES</code>，非對稱加密<code>RSA</code>。</p>
<h3 id="Hash-雜湊"><a href="#Hash-雜湊" class="headerlink" title="Hash - 雜湊"></a>Hash - 雜湊</h3><blockquote>
<p>雜湊演算法也被用來加密存在資料庫中的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC">密碼</a>（password）字串，由於雜湊演算法所計算出來的<strong>雜湊值（Hash Value）</strong>具有<strong>不可逆</strong>（無法逆向演算回原本的數值）的性質，因此可有效的保護密碼。</p>
</blockquote>
<p>用在於檔案校驗碼（Checksum），比如：</p>
<ul>
<li>用來快速判斷檔案是否和原本相同。</li>
<li>有在論壇下載過檔案的人應該都很常見到一長串 MD5 或 SHA-1 驗證碼，就是用來讓你快速檢查你下載的檔案裡頭的內容，是不是跟上傳者上傳的檔案一樣。</li>
</ul>
<h4 id="為什麼雜湊不是加密？"><a href="#為什麼雜湊不是加密？" class="headerlink" title="為什麼雜湊不是加密？"></a>為什麼雜湊不是加密？</h4><ul>
<li>今天如果我拿到一串密文，我是有辦法透過解密，得到原始的明文的，而且如果使用非對稱式加密的話，我甚至還可以驗證傳送方是不是本人（是否有被進行中間人攻擊）。<ul>
<li>雜湊演算法在這裡也會被使用，通常會被拿來檢驗傳送的訊息是否有被更改過。</li>
<li>傳送方附上原始訊息經過某個雜湊演算法得出的雜湊值，接收方在解開這個訊息之後，會透過相同的雜湊演算法來驗證。</li>
</ul>
</li>
<li>但如果是拿到一串雜湊值的話，理論上是無法逆向得到原始的明文的，根本無法拿來做資料的傳遞。</li>
</ul>
<p>對於雜湊在網路傳輸上的應用有了更進一步的了解，<code>確認傳送的訊息是否有被更改過</code>！</p>
<p>引用：<a target="_blank" rel="noopener" href="https://blog.m157q.tw/posts/2017/12/25/differences-between-encryption-and-hashing/">加密和雜湊有什麼不一樣？</a></p>
<h2 id="廠商檢測使用之軟體"><a href="#廠商檢測使用之軟體" class="headerlink" title="廠商檢測使用之軟體"></a>廠商檢測使用之軟體</h2><p>引用報告書內容：</p>
<blockquote>
<p>本服務所使用之弱點掃描檢測工具的廠牌為 <code>HCL AppScan</code>，作為網頁弱點掃描檢測工具，可全面搜尋受測單位的漏洞。</p>
</blockquote>
<p>經查詢這套軟體看起來是付費軟體哦。</p>
<h2 id="檢測結果"><a href="#檢測結果" class="headerlink" title="檢測結果"></a>檢測結果</h2><p><img src="https://i.imgur.com/PNFRTIE.png" alt="image-20220802195617329"></p>
<h3 id="低強度密碼組合-ROBOT-攻擊：伺服器支援有漏洞的密碼組合"><a href="#低強度密碼組合-ROBOT-攻擊：伺服器支援有漏洞的密碼組合" class="headerlink" title="低強度密碼組合 - ROBOT 攻擊：伺服器支援有漏洞的密碼組合"></a>低強度密碼組合 - ROBOT 攻擊：伺服器支援有漏洞的密碼組合</h3><p>網路搜尋找到來自HCL AppScan<a target="_blank" rel="noopener" href="https://help.hcltechsw.com/appscan/Enterprise/zh_TW/10.0.1/topics/t_disable_weak_cipher_suites_iis.html">文件說明</a>：</p>
<blockquote>
<p>依預設，IIS 安裝時會啟用 2 個低強度 SSL 2.0 密碼組合：<em>SSL2_RC4_128_WITH_MD5</em> 和 <em>SSL2_DES_192_EDE3_CBC_WITH_MD5</em>。這會影響 AppScan Enterprise 的安全，應該停用這些密碼組合。</p>
</blockquote>
<p>從文件內容中，了解到原來設定都藏在登錄檔之中，試圖理解<code>SSL2_RC4_128_WITH_MD5</code>這個是代表什麼意思，意外發現可以用這張圖片來解釋：</p>
<p><code>Server Protocols</code> + <code>_</code> + <code>Ciphers</code> + <code>_</code> + <code>WITH</code> + <code>Hashes</code></p>
<p><img src="https://i.imgur.com/lctcB5i.png" alt="img"></p>
<p>實際去探訪<code>登錄檔</code>，截圖增加印象：</p>
<p><img src="https://i.imgur.com/zlTfWhL.png" alt="image-20220802203224225"></p>
<h3 id="偵測到-RC4-密碼組合"><a href="#偵測到-RC4-密碼組合" class="headerlink" title="偵測到 RC4 密碼組合"></a>偵測到 RC4 密碼組合</h3><p>經過第一項弱點的認識後，這一項的說明其實就變得更好理解了。也就是不要包含<code>RC4</code>就對了！</p>
<h3 id="偵測到低強度密碼：並非所有密碼組合都支援完全秘密轉遞"><a href="#偵測到低強度密碼：並非所有密碼組合都支援完全秘密轉遞" class="headerlink" title="偵測到低強度密碼：並非所有密碼組合都支援完全秘密轉遞"></a>偵測到低強度密碼：並非所有密碼組合都支援完全秘密轉遞</h3><p>經過第一項弱點的認識後，這一項的說明其實就變得更好理解了。比如不能有<code>SSL</code>、<code>RC4</code>、<code>MD5</code>，並且在組合上避免低安全的組合！</p>
<h2 id="工具推薦"><a href="#工具推薦" class="headerlink" title="工具推薦"></a>工具推薦</h2><h3 id="SSLScan"><a href="#SSLScan" class="headerlink" title="SSLScan"></a>SSLScan</h3><p>是一套open source，在github公開，可以自行下載。</p>
<ul>
<li>可以看到<code>SSL/TLS Protocols</code>的enable狀況</li>
<li>可以看到<code>Supported Server Cipher</code> 的支援狀況</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\kite\Downloads\sslscan-2.0.15&gt; .\sslscan.exe tw.yahoo.com</span><br><span class="line">Version: 2.0.15 Windows 64-bit (Mingw)</span><br><span class="line">OpenSSL 1.1.1e-dev  xx XXX xxxx</span><br><span class="line"></span><br><span class="line">Connected to 119.161.15.251</span><br><span class="line"></span><br><span class="line">Testing SSL server tw.yahoo.com on port 443 using SNI name tw.yahoo.com</span><br><span class="line"></span><br><span class="line">  SSL/TLS Protocols:</span><br><span class="line">SSLv2     disabled</span><br><span class="line">SSLv3     disabled</span><br><span class="line">TLSv1.0   enabled</span><br><span class="line">TLSv1.1   enabled</span><br><span class="line">TLSv1.2   enabled</span><br><span class="line">TLSv1.3   enabled</span><br><span class="line"></span><br><span class="line">  TLS Fallback SCSV:</span><br><span class="line">Server supports TLS Fallback SCSV</span><br><span class="line"></span><br><span class="line">  TLS renegotiation:</span><br><span class="line">Secure session renegotiation supported</span><br><span class="line"></span><br><span class="line">  TLS Compression:</span><br><span class="line">Compression disabled</span><br><span class="line"></span><br><span class="line">  Heartbleed:</span><br><span class="line">TLSv1.3 not vulnerable to heartbleed</span><br><span class="line">TLSv1.2 not vulnerable to heartbleed</span><br><span class="line">TLSv1.1 not vulnerable to heartbleed</span><br><span class="line">TLSv1.0 not vulnerable to heartbleed</span><br><span class="line"></span><br><span class="line">  Supported Server Cipher(s):</span><br><span class="line">Preferred TLSv1.3  128 bits  TLS_AES_128_GCM_SHA256        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.3  256 bits  TLS_AES_256_GCM_SHA384        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.3  256 bits  TLS_CHACHA20_POLY1305_SHA256  Curve 25519 DHE 253</span><br><span class="line">Preferred TLSv1.2  128 bits  ECDHE-ECDSA-AES128-GCM-SHA256 Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-AES256-GCM-SHA384 Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-CHACHA20-POLY1305 Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-RSA-CHACHA20-POLY1305   Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-GCM-SHA256   Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-GCM-SHA384   Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  ECDHE-ECDSA-AES128-SHA256     Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-AES256-SHA384     Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  ECDHE-ECDSA-AES128-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-AES256-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA256       Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA384       Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.2  128 bits  AES128-GCM-SHA256</span><br><span class="line">Accepted  TLSv1.2  256 bits  AES256-GCM-SHA384</span><br><span class="line">Accepted  TLSv1.2  128 bits  AES128-SHA256</span><br><span class="line">Accepted  TLSv1.2  256 bits  AES256-SHA256</span><br><span class="line">Accepted  TLSv1.2  256 bits  AES256-SHA</span><br><span class="line">Preferred TLSv1.1  128 bits  ECDHE-ECDSA-AES128-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.1  256 bits  ECDHE-ECDSA-AES256-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.1  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.1  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.1  256 bits  AES256-SHA</span><br><span class="line">Preferred TLSv1.0  128 bits  ECDHE-ECDSA-AES128-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.0  256 bits  ECDHE-ECDSA-AES256-SHA        Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.0  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.0  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253</span><br><span class="line">Accepted  TLSv1.0  256 bits  AES256-SHA</span><br><span class="line"></span><br><span class="line">  Server Key Exchange Group(s):</span><br><span class="line">TLSv1.3  128 bits  secp256r1 (NIST P-256)</span><br><span class="line">TLSv1.3  192 bits  secp384r1 (NIST P-384)</span><br><span class="line">TLSv1.3  260 bits  secp521r1 (NIST P-521)</span><br><span class="line">TLSv1.3  128 bits  x25519</span><br><span class="line">TLSv1.3  224 bits  x448</span><br><span class="line">TLSv1.2  128 bits  secp256r1 (NIST P-256)</span><br><span class="line">TLSv1.2  192 bits  secp384r1 (NIST P-384)</span><br><span class="line">TLSv1.2  260 bits  secp521r1 (NIST P-521)</span><br><span class="line">TLSv1.2  128 bits  x25519</span><br><span class="line">TLSv1.2  224 bits  x448</span><br><span class="line"></span><br><span class="line">  SSL Certificate:</span><br><span class="line">Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">ECC Curve Name:      prime256v1</span><br><span class="line">ECC Key Strength:    128</span><br></pre></td></tr></table></figure>

<h3 id="IIS-Crypto"><a href="#IIS-Crypto" class="headerlink" title="IIS Crypto"></a>IIS Crypto</h3><h2 id="參考網站"><a href="#參考網站" class="headerlink" title="參考網站"></a>參考網站</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.darkthread.net/blog/rdp-ssl-cipher-vulnerability/">非網站 Windows 之 SSL 加密弱點檢測及修補</a><ul>
<li>這篇是黑暗大大寫的心得筆記，過程寫的很詳細。其中，也有推薦使用<code>nmap</code>來進行檢測。</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://www.waynezim.com/2011/03/how-to-disable-weak-ssl-protocols-and-ciphers-in-iis/">How to Disable Weak SSL Protocols and Ciphers in IIS</a></li>
<li><a target="_blank" rel="noopener" href="https://www.websecurity.digicert.com/zh/tw/security-topics/what-is-ssl-tls-https">什麼是 SSL、TLS 以及 HTTPS？</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.m157q.tw/posts/2017/12/25/differences-between-encryption-and-hashing/">加密和雜湊有什麼不一樣？</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/%E7%A8%8B%E5%BC%8F%E8%A3%A1%E6%9C%89%E8%9F%B2/windows-%E4%B8%BB%E6%A9%9F%E5%A6%82%E4%BD%95%E5%95%9F%E7%94%A8-tls-1-2-d72825f791b9">Windows 主機如何啟用 TLS 1.2</a><ul>
<li>如果要用登錄檔的方式進行修改，這篇圖文並茂，而且還將貼上了reg的文字設定檔</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://hackmd.io/@Not/rJ52Vrp_v#%E4%B8%AD-%E4%BD%BF%E7%94%A8TLS-1011-%E5%81%9C%E7%94%A8TLS%E8%88%8A%E7%89%88%E5%8D%94%E5%AE%9A%EF%BC%8C%E5%8F%AA%E5%95%9F%E7%94%A8TLS-12%E5%90%AB">網站檢測的資安風險修正筆記</a><ul>
<li>IIS Crypto軟體使用方式可以參考這篇，做得還滿不錯的</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/07/28/2022-07-28%20typescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/28/2022-07-28%20typescript/" class="post-title-link" itemprop="url">typescript</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2022-07-28 21:41:00" itemprop="dateCreated datePublished" datetime="2022-07-28T21:41:00+08:00">2022-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-02 02:23:24" itemprop="dateModified" datetime="2022-08-02T02:23:24+08:00">2022-08-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>7.6k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>14 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-TypeScript-TS-快速入門"><a href="#1-TypeScript-TS-快速入門" class="headerlink" title="1. TypeScript TS 快速入門"></a>1. TypeScript TS 快速入門</h2><h3 id="1-1-什麼是TypeScript？"><a href="#1-1-什麼是TypeScript？" class="headerlink" title="1.1. 什麼是TypeScript？"></a>1.1. 什麼是TypeScript？</h3><ol>
<li>加強版的javascript(Superset)</li>
<li>加強了「Type」的部分</li>
<li>開發完成後，最後還是需要編譯成javascript</li>
<li>適用於開發前端跟後端，例如：搭配React、Express等框架</li>
</ol>
<h3 id="1-2-為什麼需要TyperScript"><a href="#1-2-為什麼需要TyperScript" class="headerlink" title="1.2. 為什麼需要TyperScript"></a>1.2. 為什麼需要TyperScript</h3><ol>
<li>開發時的(Type)類型檢查</li>
<li>補強動態語言JS，Run起來才會出錯的缺點(不小心用字串做加減乘除)</li>
<li>提高專案程式碼的維護性</li>
</ol>
<h2 id="2-環境安裝"><a href="#2-環境安裝" class="headerlink" title="2. 環境安裝"></a>2. 環境安裝</h2><h3 id="2-1-全局安裝"><a href="#2-1-全局安裝" class="headerlink" title="2.1. 全局安裝"></a>2.1. 全局安裝</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install typescript -g</span><br></pre></td></tr></table></figure>

<h3 id="2-2-專案安裝"><a href="#2-2-專案安裝" class="headerlink" title="2.2. 專案安裝"></a>2.2. 專案安裝</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install typescript --save-dev</span><br></pre></td></tr></table></figure>

<h3 id="2-3-版本檢查"><a href="#2-3-版本檢查" class="headerlink" title="2.3. 版本檢查"></a>2.3. 版本檢查</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc -v</span><br></pre></td></tr></table></figure>

<h3 id="2-4-初始化專案"><a href="#2-4-初始化專案" class="headerlink" title="2.4. 初始化專案"></a>2.4. 初始化專案</h3><p>經過以下指令產生<code>tsconfig.json</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc --init</span><br></pre></td></tr></table></figure>

<h2 id="3-config設定項目"><a href="#3-config設定項目" class="headerlink" title="3. config設定項目"></a>3. config設定項目</h2><p>這邊簡單記錄幾個config設定</p>
<h3 id="3-1-編譯目標版本"><a href="#3-1-編譯目標版本" class="headerlink" title="3.1. 編譯目標版本"></a>3.1. 編譯目標版本</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es2016&quot;</span><span class="punctuation">,</span>                                  <span class="comment">/* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-Source-path"><a href="#3-2-Source-path" class="headerlink" title="3.2. Source path"></a>3.2. Source path</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;rootDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./src&quot;</span><span class="punctuation">,</span>                                  <span class="comment">/* Specify the root folder within your source files. */</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-Output-path"><a href="#3-3-Output-path" class="headerlink" title="3.3. Output path"></a>3.3. Output path</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/&quot;</span><span class="punctuation">,</span>                                <span class="comment">/* Specify an output folder for all emitted files. */</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/BMzSwEZ.png" alt="image-20220730193055247"></p>
<h3 id="3-4-允許撰寫js"><a href="#3-4-允許撰寫js" class="headerlink" title="3.4. 允許撰寫js"></a>3.4. 允許撰寫js</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;allowJs&quot;: true,                                  /* Allow JavaScript files to be a part of your program. Use the &#x27;checkJS&#x27; option to get errors from these files. */</span></span><br></pre></td></tr></table></figure>



<h3 id="3-5-debug模式指向ts檔案"><a href="#3-5-debug模式指向ts檔案" class="headerlink" title="3.5. debug模式指向ts檔案"></a>3.5. debug模式指向ts檔案</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;inlineSourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span>                          <span class="comment">/* Include sourcemap files inside the emitted JavaScript. */</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/ghxCEfp.png" alt="image-20220730192733527"></p>
<p><img src="https://i.imgur.com/urwlDRE.png" alt="image-20220730192703431"></p>
<h2 id="4-如何complier"><a href="#4-如何complier" class="headerlink" title="4. 如何complier"></a>4. 如何complier</h2><h3 id="4-1-新增index-ts"><a href="#4-1-新增index-ts" class="headerlink" title="4.1. 新增index.ts"></a>4.1. 新增<code>index.ts</code></h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="built_in">string</span> =<span class="string">&quot;kite&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-手動編譯檔案"><a href="#4-2-手動編譯檔案" class="headerlink" title="4.2. 手動編譯檔案"></a>4.2. 手動編譯檔案</h3><p>經過以下指令會編譯出<code>index.js</code>檔</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc index.ts</span><br></pre></td></tr></table></figure>

<h3 id="4-3-持續監控"><a href="#4-3-持續監控" class="headerlink" title="4.3. 持續監控"></a>4.3. 持續監控</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc --watch</span><br></pre></td></tr></table></figure>

<h2 id="5-動手寫程式"><a href="#5-動手寫程式" class="headerlink" title="5. 動手寫程式"></a>5. 動手寫程式</h2><p><img src="https://i.imgur.com/OedIFzb.png" alt="image-20220802022320270"></p>
<h3 id="5-1-basic"><a href="#5-1-basic" class="headerlink" title="5.1. basic"></a>5.1. basic</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ 基本類型 ------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">str</span>: <span class="built_in">string</span> =<span class="string">&#x27;kite&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">str1</span>: <span class="built_in">string</span>;</span><br><span class="line">str1 =<span class="string">&quot;kite&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">num</span>: <span class="built_in">number</span> = <span class="number">1000</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">boo</span>: <span class="built_in">boolean</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">n</span>: <span class="literal">null</span> = <span class="literal">null</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">un</span>: <span class="literal">undefined</span> = <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">test</span>: <span class="built_in">any</span> = <span class="literal">true</span>;<span class="comment">//任何型別都可以</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//陣列</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">arr1d</span>: <span class="built_in">string</span>[] = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="attr">arr2d</span>: <span class="built_in">string</span>[][] = [[<span class="string">&#x27;a1&#x27;</span>,<span class="string">&#x27;b1&#x27;</span>,<span class="string">&#x27;c1&#x27;</span>],[<span class="string">&#x27;a2&#x27;</span>,<span class="string">&#x27;b2&#x27;</span>,<span class="string">&#x27;c2&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//元組</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">tuple1d</span>: [<span class="built_in">number</span>, <span class="built_in">string</span>, <span class="built_in">boolean</span>] = [<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>,<span class="literal">true</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="attr">tuple2d</span>: [<span class="built_in">string</span>,<span class="built_in">string</span>][] = [[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]]</span><br></pre></td></tr></table></figure>



<h3 id="5-2-Enum-枚舉"><a href="#5-2-Enum-枚舉" class="headerlink" title="5.2. Enum 枚舉"></a>5.2. Enum 枚舉</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ Enum 枚舉 ------------</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">LiveStatus</span> &#123;</span><br><span class="line">    <span class="variable constant_">SUCCESS</span> = <span class="number">0</span>,</span><br><span class="line">    <span class="variable constant_">FAIL</span> = -<span class="number">1</span>,</span><br><span class="line">    <span class="variable constant_">STREAMING</span> = <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> liveStatus = <span class="title class_">LiveStatus</span>.<span class="property">FAIL</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(liveStatus);</span><br></pre></td></tr></table></figure>

<h3 id="5-3-Union"><a href="#5-3-Union" class="headerlink" title="5.3. Union"></a>5.3. Union</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ Union ------------</span></span><br><span class="line"><span class="keyword">let</span> union : <span class="built_in">boolean</span> | <span class="built_in">string</span>;</span><br><span class="line">union = <span class="literal">true</span>;</span><br><span class="line">union = <span class="string">&quot;hi,I&#x27;m Support boolean、string type&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="5-4-Type"><a href="#5-4-Type" class="headerlink" title="5.4. Type"></a>5.4. Type</h3><h4 id="5-4-1-basic"><a href="#5-4-1-basic" class="headerlink" title="5.4.1. basic"></a>5.4.1. basic</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ Type ------------</span></span><br><span class="line"><span class="keyword">type</span> A = <span class="built_in">number</span> | <span class="built_in">string</span> </span><br><span class="line"><span class="keyword">let</span> <span class="attr">a1</span>: A</span><br><span class="line">a1 = <span class="number">1</span></span><br><span class="line">a1 = <span class="string">&quot;type A&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-4-2-Partial-Readonly"><a href="#5-4-2-Partial-Readonly" class="headerlink" title="5.4.2. Partial &amp; Readonly"></a>5.4.2. Partial &amp; Readonly</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保哥 union</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Level</span> = <span class="string">&quot;初階&quot;</span> | <span class="string">&quot;中階&quot;</span> | <span class="string">&quot;高階&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">yourLevel</span>: <span class="title class_">Level</span> = <span class="string">&quot;中階&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//保哥 Partial &amp; ReadOnly Types</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PersonPartial</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PersonReadonly</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="attr">personA</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;Will&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="attr">personB</span>:<span class="title class_">PersonPartial</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Will&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="attr">personC</span>:<span class="title class_">PersonReadonly</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Will&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//personC.name=&quot;kite&quot;;//error</span></span><br></pre></td></tr></table></figure>

<h3 id="5-5-Interface"><a href="#5-5-Interface" class="headerlink" title="5.5. Interface"></a>5.5. Interface</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ Interface ------------</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-6-Object"><a href="#5-6-Object" class="headerlink" title="5.6. Object"></a>5.6. Object</h3><p>思考一下type 與 interface的差異性</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ Object ------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Card</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">    desc?: <span class="built_in">string</span> <span class="comment">//可選</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">card01</span>: <span class="title class_">Card</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;kite&quot;</span>,</span><br><span class="line">    <span class="attr">desc</span>:<span class="string">&quot;....&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Card2</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Card2</span> &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">card02</span>: <span class="title class_">Card2</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;dog&quot;</span>,</span><br><span class="line">    <span class="attr">desc</span>:<span class="string">&quot;won!&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-7-Function"><a href="#5-7-Function" class="headerlink" title="5.7. Function"></a>5.7. Function</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ function ------------</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params">a: <span class="built_in">string</span>,b: <span class="built_in">string</span></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello2</span>(<span class="params">a: <span class="built_in">string</span>,b: <span class="built_in">string</span></span>): <span class="built_in">number</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">999</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello3</span>(<span class="params">a: <span class="built_in">number</span>,b: <span class="built_in">boolean</span>,c: <span class="built_in">string</span></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test2</span>(<span class="params">a: <span class="built_in">number</span></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//可選參數要放在最後面</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hello4</span>(<span class="params">name: <span class="built_in">string</span>, age?: <span class="built_in">number</span></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(age === <span class="literal">undefined</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="title function_">test2</span>(age)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//箭頭函式</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">func</span> = (<span class="params"></span>) =&gt; &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">func2</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-8-斷言"><a href="#5-8-斷言" class="headerlink" title="5.8. 斷言"></a>5.8. 斷言</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ 斷言 unknown ------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TodoModel</span> = &#123;</span><br><span class="line">    <span class="attr">userId</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">completed</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getData</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//https://jsonplaceholder.typicode.com/</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://jsonplaceholder.typicode.com/todos/1&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> todoModel = <span class="keyword">await</span> res.<span class="title function_">json</span>() <span class="keyword">as</span> <span class="title class_">TodoModel</span>;    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(todoModel);    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">data1</span>: <span class="title class_">TodoModel</span> = &#123;</span><br><span class="line">    <span class="string">&quot;userId&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;title&quot;</span>: <span class="string">&quot;delectus aut autem&quot;</span>,</span><br><span class="line">    <span class="string">&quot;completed&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Beta</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 假設data1是動態的，想像data1是response回來的json且動態內容，先unknow 再轉為預計的型別</span></span><br><span class="line"><span class="keyword">const</span> beta = data1 <span class="keyword">as</span> <span class="built_in">unknown</span> <span class="keyword">as</span> <span class="title class_">Beta</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">getData</span>()</span><br></pre></td></tr></table></figure>

<h3 id="5-9-Class"><a href="#5-9-Class" class="headerlink" title="5.9. Class"></a>5.9. Class</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ class ------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Live</span> &#123;</span><br><span class="line">    <span class="attr">roomName</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="keyword">private</span> <span class="attr">id</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="keyword">protected</span> <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="title function_">constructor</span> (<span class="attr">roomName1</span>: <span class="built_in">string</span>, <span class="attr">id1</span>: <span class="built_in">string</span>, <span class="attr">name1</span>: <span class="built_in">string</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;建立直播中...&#x27;</span>);        </span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">roomName</span> = roomName1;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">id</span> = id1;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;class Live start method&quot;</span>);        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`class Live this.id = <span class="subst">$&#123;<span class="variable language_">this</span>.id&#125;</span>`</span>);                </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`class Live this.name = <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//繼承 extends</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CarLive</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Live</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span> (<span class="attr">roomName1</span>: <span class="built_in">string</span>, <span class="attr">id1</span>: <span class="built_in">string</span>, <span class="attr">name1</span>: <span class="built_in">string</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">super</span>(roomName1,id1,name1)        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> live01 = <span class="keyword">new</span> <span class="title class_">Live</span>(<span class="string">&quot;1號&quot;</span>,<span class="string">&quot;00001&quot;</span>,<span class="string">&quot;kite&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(live01);</span><br><span class="line"><span class="comment">//console.log(live01.id);//在開發階段會有報錯提示</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> live02 = <span class="keyword">new</span> <span class="title class_">CarLive</span>(<span class="string">&quot;2號&quot;</span>,<span class="string">&quot;00002&quot;</span>,<span class="string">&quot;Richard&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(live02);</span><br><span class="line">live02.<span class="title function_">start</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//私有變數新寫法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Live2</span>&#123;</span><br><span class="line">    <span class="comment">//↓私有變數</span></span><br><span class="line">    #name</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.#name= name;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name);        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> live2 = <span class="keyword">new</span> <span class="title class_">Live2</span>(<span class="string">&quot;Mary&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(live2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//實作介面 implements</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CarProps</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">start</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">CarProps</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>,age: <span class="built_in">number</span></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-9-1-public"><a href="#5-9-1-public" class="headerlink" title="5.9.1. public"></a>5.9.1. public</h4><p>當一個變數或方法的可視性被宣告為<code>public</code>。這表示這些方法和屬性可以在<code>類別的裡面與外面被存取</code>。</p>
<h4 id="5-9-2-protected"><a href="#5-9-2-protected" class="headerlink" title="5.9.2. protected"></a>5.9.2. protected</h4><p>當一個變數或方法的可視性被宣告為<code>protected</code>，該變數或方法只能在<code>類別以及子類別的內部存取</code>。</p>
<h4 id="5-9-3-private"><a href="#5-9-3-private" class="headerlink" title="5.9.3. private"></a>5.9.3. private</h4><p>當一個變數或方法的可視性被宣告為<code>private</code>，該變數或方法只能在<code>定義它們的類別內</code>。</p>
<p>實質上，在browser上還是能進行存取，如下圖：</p>
<p><img src="https://i.imgur.com/x75cpRg.png" alt="image-20220730235820137"></p>
<p>新語法新特性，希望能達到private效果可以使用<code>#</code>符號進行變數宣告。再看一次browser，的確已經限制住存取了。</p>
<p><img src="https://i.imgur.com/J1vRZue.png" alt="image-20220731005658972"></p>
<h3 id="5-10-泛型"><a href="#5-10-泛型" class="headerlink" title="5.10. 泛型"></a>5.10. 泛型</h3><h4 id="5-10-1-function"><a href="#5-10-1-function" class="headerlink" title="5.10.1. function"></a>5.10.1. function</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------------ 泛型 ------------</span></span><br><span class="line"><span class="comment">//function</span></span><br><span class="line"><span class="keyword">function</span> print&lt;T&gt;(<span class="attr">data</span>:T)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data&#x27;</span>,data);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">print&lt;<span class="built_in">number</span>&gt;(<span class="number">999</span>)</span><br><span class="line">print&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;kite&quot;</span>)</span><br><span class="line">print&lt;<span class="built_in">string</span>[][]&gt;([[<span class="string">&#x27;kite&#x27;</span>,<span class="string">&#x27;Richard&#x27;</span>]])</span><br><span class="line">print&lt;<span class="title class_">CarProps</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;kite&quot;</span></span><br><span class="line">    ,<span class="attr">age</span>:<span class="number">123</span></span><br><span class="line">    ,<span class="title function_">start</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`I&#x27;m start method`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="5-10-2-class"><a href="#5-10-2-class" class="headerlink" title="5.10.2. class"></a>5.10.2. class</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Print</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="attr">data</span>: T</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">d: T</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">data</span> = d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Print</span>&lt;<span class="built_in">number</span>&gt;(<span class="number">999</span>);</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Print</span>&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;kite&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;p&#x27;</span>,p);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;p1&#x27;</span>,p1);</span><br></pre></td></tr></table></figure>



<h3 id="5-11-Utility-Types"><a href="#5-11-Utility-Types" class="headerlink" title="5.11. Utility Types"></a>5.11. Utility Types</h3><h4 id="5-11-1-Record"><a href="#5-11-1-Record" class="headerlink" title="5.11.1. Record&lt;Keys, Type&gt;"></a>5.11.1. Record&lt;Keys, Type&gt;</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">CatInfo</span> &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">breed</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">CatName</span> = <span class="string">&quot;miffy&quot;</span> | <span class="string">&quot;boris&quot;</span> | <span class="string">&quot;mordred&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">cats</span>: <span class="title class_">Record</span>&lt;<span class="title class_">CatName</span>, <span class="title class_">CatInfo</span>&gt; = &#123;</span><br><span class="line">    <span class="attr">miffy</span>: &#123; <span class="attr">age</span>: <span class="number">10</span>, <span class="attr">breed</span>: <span class="string">&quot;Persian&quot;</span> &#125;,</span><br><span class="line">    <span class="attr">boris</span>: &#123; <span class="attr">age</span>: <span class="number">5</span>, <span class="attr">breed</span>: <span class="string">&quot;Maine Coon&quot;</span> &#125;,</span><br><span class="line">    <span class="attr">mordred</span>: &#123; <span class="attr">age</span>: <span class="number">16</span>, <span class="attr">breed</span>: <span class="string">&quot;British Shorthair&quot;</span> &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h4 id="5-11-2-Pick"><a href="#5-11-2-Pick" class="headerlink" title="5.11.2. Pick&lt;Type, Keys&gt;"></a>5.11.2. Pick&lt;Type, Keys&gt;</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Todo1</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">description</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">completed</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TodoPreview1</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">Todo1</span>, <span class="string">&quot;title&quot;</span> | <span class="string">&quot;completed&quot;</span>&gt;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="attr">todo1</span>: <span class="title class_">TodoPreview1</span> = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;Clean room&quot;</span>,</span><br><span class="line">  <span class="attr">completed</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h4 id="5-11-3-Omit"><a href="#5-11-3-Omit" class="headerlink" title="5.11.3. Omit&lt;Type, Keys&gt;"></a>5.11.3. Omit&lt;Type, Keys&gt;</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Todo2</span> &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">description</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">completed</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="built_in">number</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TodoPreview2</span> = <span class="title class_">Omit</span>&lt;<span class="title class_">Todo2</span>, <span class="string">&quot;description&quot;</span>&gt;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="attr">todo2</span>: <span class="title class_">TodoPreview2</span> = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;Clean room&quot;</span>,</span><br><span class="line">  <span class="attr">completed</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">createdAt</span>: <span class="number">1615544252770</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h2 id="6-參考連結"><a href="#6-參考連結" class="headerlink" title="6. 參考連結"></a>6. 參考連結</h2><ul>
<li><a target="_blank" rel="noopener" href="https://youtu.be/GinkGJZBHIY">【前端速成】TypeScript TS 快速入門｜Tiktok工程師帶你入門前端｜布魯斯前端</a></li>
<li><a target="_blank" rel="noopener" href="http://json2ts.com/">json2ts</a></li>
<li><a target="_blank" rel="noopener" href="https://jsonplaceholder.typicode.com/">{JSON} Placeholder</a></li>
<li><a target="_blank" rel="noopener" href="https://youtu.be/SCLKlc6G0_k">用不用 TypeScript 隨便你，反正我是用了 | Will 保哥 (JSDC 2020)</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2022/07/26/2022-07-26%20%E6%B6%88%E6%81%AF%E9%9A%8A%E5%88%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/26/2022-07-26%20%E6%B6%88%E6%81%AF%E9%9A%8A%E5%88%97/" class="post-title-link" itemprop="url">消息隊列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>
              

              <time title="創建時間：2022-07-26 12:08:00 / 修改時間：23:06:26" itemprop="dateCreated datePublished" datetime="2022-07-26T12:08:00+08:00">2022-07-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%8C%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">後端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>4 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-消息隊列-Message-Queue"><a href="#1-消息隊列-Message-Queue" class="headerlink" title="1. 消息隊列 Message Queue"></a>1. 消息隊列 Message Queue</h2><p>內容包含記錄了對於主題與隊列、消息隊列的一致性、消息的丟失、重複、積壓問題</p>
<h2 id="2-為什麼需要消息隊列"><a href="#2-為什麼需要消息隊列" class="headerlink" title="2. 為什麼需要消息隊列"></a>2. 為什麼需要消息隊列</h2><h3 id="2-1-工廠流水線"><a href="#2-1-工廠流水線" class="headerlink" title="2.1. 工廠流水線"></a>2.1. 工廠流水線</h3><p>大家在廠線上，只需要觀注自己的工作內容，意味著解耦了彼此的關係。</p>
<p><img src="https://i.imgur.com/bfpPK5p.png" alt="image-20220726121505581"></p>
<h3 id="2-2-水庫"><a href="#2-2-水庫" class="headerlink" title="2.2. 水庫"></a>2.2. 水庫</h3><p>當發生大量的請求與流量時，可以保護我們的後端伺服器的穩定，扮演水庫角色，進行的控制與排放。</p>
<p><img src="https://i.imgur.com/19z3MSg.png" alt="image-20220726121556180"></p>
<h3 id="2-3-倉庫"><a href="#2-3-倉庫" class="headerlink" title="2.3. 倉庫"></a>2.3. 倉庫</h3><p>可用途儲存半成品的存放站，後續再由它人去拿取半成品商品進行處理。</p>
<p><img src="https://i.imgur.com/EN8QPDP.png" alt="image-20220726122222781"></p>
<h2 id="3-場景"><a href="#3-場景" class="headerlink" title="3. 場景"></a>3. 場景</h2><h3 id="3-1-非同步處理"><a href="#3-1-非同步處理" class="headerlink" title="3.1. 非同步處理"></a>3.1. 非同步處理</h3><p>同步處理</p>
<p>響應一個用戶的請求，需要完成4個步驟，每個模塊都有自己的運行時間，這樣的話運行時間就會相對較長。</p>
<p>並且，往往在過程當中，只有一步或二步是重要的關鍵步驟，其餘的步驟往往都沒有那麼重要…比如發郵件或簡訊通知訂單完成之類的訊息</p>
<p>亦或者是數據統計之類的工作。</p>
<p>異步處理</p>
<p>加入了隊列請求後，對於一個用戶的請求，我們只需要完成一個最核心的業務邏輯操作，完成後直接返回請求。</p>
<p>我們引入消息隊列，使這些模塊監聽消息隊列中的事件，這些模塊只要異步操作完即可。</p>
<p>異步處理，可以大大縮短響應用戶的請求</p>
<p><img src="https://i.imgur.com/Toubbsh.png" alt="MQ同步、異步"></p>
<h3 id="3-2-應付瞬間巨量"><a href="#3-2-應付瞬間巨量" class="headerlink" title="3.2. 應付瞬間巨量"></a>3.2. 應付瞬間巨量</h3><p>秒殺活動流量較大，透過網關導向到隊列中，隊列在這當中扮演了很大的保護作用，可避免後端服務器崩潰。![MQ_流量控制](E:\1. kite\GitWorkSpace\kite_hexo\source_posts\2022-07-26 消息隊列.assets\MQ_流量控制.png)</p>
<h3 id="3-3-系統間解耦-服務解耦"><a href="#3-3-系統間解耦-服務解耦" class="headerlink" title="3.3. 系統間解耦(服務解耦)"></a>3.3. 系統間解耦(服務解耦)</h3><p>如果沒有導入<code>MessageQueue</code>時，可以說每個模塊之間的接口耦合，又或者說每個微服務之間的RPC耦合。</p>
<p>如果某一個模塊出現了問題，又或者需要重新佈署，這些與它相依賴的模塊有可能會受到影響。</p>
<p>引入了MessageQueue之後，每個模塊就可以觀注在自己的事情上面，完全不用考慮體會上游或下游的情況。去掉耦合之後，我們的微服務佈署也好，項目維護也好，包括項目的高可用性，帶來不錯的效益。</p>
<p><img src="https://i.imgur.com/7dpxUxQ.png" alt="MQ_服務解耦"></p>
<h2 id="4-消息隊列類型"><a href="#4-消息隊列類型" class="headerlink" title="4. 消息隊列類型"></a>4. 消息隊列類型</h2><p>分為兩大類，分為單播、廣播。現在有很多消息隊列是能同時支援兩種類型的，比如<code>RabbitMQ</code>、<code>Kafka</code></p>
<h3 id="4-1-單播-1對1"><a href="#4-1-單播-1對1" class="headerlink" title="4.1. 單播 (1對1)"></a>4.1. 單播 (1對1)</h3><p>一個<code>消息發佈者</code>對應一個<code>消息消費者</code>，就算<code>MQ</code>中有多個消息，<strong>每一個消息</strong>都還是對應<strong>一個</strong><code>消息消費者</code>。很像我們平常在用的數據模式，先進先出。</p>
<p><img src="https://i.imgur.com/ugqxhQ4.png" alt="MQ_單播"></p>
<h3 id="4-2-廣播-1對多"><a href="#4-2-廣播-1對多" class="headerlink" title="4.2. 廣播 (1對多)"></a>4.2. 廣播 (1對多)</h3><p>多個<code>消息消費者</code>監聽一個<code>消息發佈者</code>。舉例來說，一個訂單成立之後，後續流程各自展開「開始通知整貨作業、簡訊通知訂單成立、郵件通知訂單成立、統計數據」，多個模塊都需要知道一個消息發佈者的完整訊息。</p>
<p><img src="https://i.imgur.com/2V6saL3.png" alt="MQ_多播"></p>
<h2 id="5-事務"><a href="#5-事務" class="headerlink" title="5. 事務"></a>5. 事務</h2><p>什麼是事務，簡單來說它是一組操作，需要滿足這些操作全部完成或者這些操作全部都沒有完成</p>
<h3 id="5-1-Half-Message-RocketMQ"><a href="#5-1-Half-Message-RocketMQ" class="headerlink" title="5.1. Half Message - RocketMQ"></a>5.1. Half Message - RocketMQ</h3><p>我們無法保證網路傳輸是穩定的，因此，如何提高事務的完整性(ACID，Atomicity 原子性 )，就需要透過一些設計方法與思維，其中，Half Message就是一個解決方法。它是一個有順序流程性的設計：</p>
<ol>
<li><p>在開始執行業務邏輯之前，會先發送一條半消息到<code>MQ</code>，提醒<code>MQ</code>說我們的業務邏輯即將開始了。</p>
</li>
<li><p><code>MQ</code>會回覆收到<code>半消息</code>的確認，如果這一步就錯誤了，我們就必須在業務邏輯上註記(返回)失敗。</p>
</li>
<li><p>真正開始業務邏輯(這段覺得很怪<code>業務模組</code>告訴<code>消息發佈者</code>)</p>
</li>
<li><p>由消息發佈者進行提交&#x2F;回滾消息給<code>MQ</code>，當<code>MQ</code>收到提交(業務邏輯執行成功)，則將<code>半消息</code>改狀態變為正常的消息(可見的)</p>
</li>
<li><p><code>消費消費者</code>自然可以去取得<code>MQ</code>的訊息</p>
<blockquote>
<p>確認如何畫圖</p>
</blockquote>
</li>
</ol>
<p>而<code>半消息</code>的定義是這條訊息在消費者那邊是不可見的。</p>
<h4 id="5-1-1-死信隊列"><a href="#5-1-1-死信隊列" class="headerlink" title="5.1.1. 死信隊列"></a>5.1.1. 死信隊列</h4><p>以上5個步驟只是確保<code>MQ</code>、<code>Publisher</code>、<code>業務</code>的<code>原子性</code>，無法確保<code>Consumer</code>的原子性。因此，在Consumer與MQ之間，會允許嘗試try catch 多次(maybe 3~5次的限制)，如果是失敗3次了，則進入到死信的隊列。其實死信隊列就是記錄了consumer操作失敗訊息，我們可以定期查詢死信隊列的記錄，進行手動修復，這樣就是最大成度的保證原子性。</p>
<h4 id="5-1-2-反查機制"><a href="#5-1-2-反查機制" class="headerlink" title="5.1.2. 反查機制"></a>5.1.2. 反查機制</h4><p>我們繼續考慮一個例外狀況，當第4步驟沒有執行的時候，那MQ就會無法得知實際狀況，變成死等。因此，我們可以利用一個回調函式提供MQ去反查確認消費發佈者的狀況，maybe是一個定期器，預計10秒內應該得到回應，如果沒有就去反查<code>消費發佈者</code></p>
<h2 id="6-消息隊列常見問題"><a href="#6-消息隊列常見問題" class="headerlink" title="6. 消息隊列常見問題"></a>6. 消息隊列常見問題</h2><h3 id="6-1-消息丟失"><a href="#6-1-消息丟失" class="headerlink" title="6.1. 消息丟失"></a>6.1. 消息丟失</h3><p>P 發送 MQ</p>
<p>MQ發送確認P</p>
<p>MQ發送C</p>
<p>C發送確認MQ</p>
<h3 id="6-2-重複消息"><a href="#6-2-重複消息" class="headerlink" title="6.2. 重複消息"></a>6.2. 重複消息</h3><p>幂等性:Idempotence</p>
<p>重傳保證結果不會影響最終結果</p>
<h3 id="6-3-消息積壓"><a href="#6-3-消息積壓" class="headerlink" title="6.3. 消息積壓"></a>6.3. 消息積壓</h3><ul>
<li>水平擴容queue&#x2F;partition的數量，以及consumer實例的數量<ul>
<li>兩邊要等量的增加，單獨增加一邊是沒有效益的</li>
</ul>
</li>
<li>排查日誌，確保隊列層正常送達消息</li>
<li>在producer段，服務降級<ul>
<li>提供重要邏輯的優先度</li>
</ul>
</li>
</ul>
<h2 id="7-參考資料"><a href="#7-參考資料" class="headerlink" title="7. 參考資料"></a>7. 參考資料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=M7v1rlgpgec&ab_channel=JimmyCoding">Message Queue 消息队列：最强大的web后端组件</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=E1pxP0wuGso">91APP 電商技術大解密 (2020 線上分享系列)：解密 91APP Queue System</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kite</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">131</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">118</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kite</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="總字數">354k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">10:44</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
