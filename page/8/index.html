<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kitefree.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="地球人的修練">
<meta property="og:url" content="https://kitefree.github.io/page/8/index.html">
<meta property="og:site_name" content="地球人的修練">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="kite">
<meta property="article:tag" content="c#,Asp.net,Asp.net MVC,Net Core,後端,WebApi,SQL,SQL Server">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kitefree.github.io/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>地球人的修練</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">地球人的修練</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分類</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>歸檔</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="sitemap fa-fw"></i>網站地圖</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/20/2021-08-20%20%E5%89%8D%E7%AB%AF%E6%B8%AC%E8%A9%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/20/2021-08-20%20%E5%89%8D%E7%AB%AF%E6%B8%AC%E8%A9%A6/" class="post-title-link" itemprop="url">前端測試</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-20 14:51:00" itemprop="dateCreated datePublished" datetime="2021-08-20T14:51:00+08:00">2021-08-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 10:33:50" itemprop="dateModified" datetime="2021-09-19T10:33:50+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>591</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="測試的差異"><a href="#測試的差異" class="headerlink" title="測試的差異"></a>測試的差異</h2><ul>
<li>Unit 測試成本最低、速度最快</li>
<li>UI測試成本最高、速度最慢</li>
<li>E2E test 看起來跟selumium 滿像的，它還有儲檔截圖的概念，屬於使用UI的方式進行測試</li>
</ul>
<p><img src="https://i.imgur.com/Twzvwe4.png" alt="image-20210715153138009"></p>
<p><code>puppeteer</code> 這個套件 是以UI的方式進行測試，要寫DOM元素來模擬填寫資料</p>
<p><img src="https://i.imgur.com/ND2kiHi.png" alt="image-20210715171502770"></p>
<h2 id="如何導入UNIT-TEST"><a href="#如何導入UNIT-TEST" class="headerlink" title="如何導入UNIT TEST"></a>如何導入UNIT TEST</h2><ul>
<li>情境描述</li>
<li><strong>測試的目標</strong>為何</li>
<li><strong>導入要測試的函式</strong></li>
<li><strong>測試的期望</strong>是什麼</li>
</ul>
<p><img src="https://i.imgur.com/1wl6idM.png" alt="image-20210715160413550"></p>
<h2 id="安裝JEST"><a href="#安裝JEST" class="headerlink" title="安裝JEST"></a>安裝JEST</h2><p>npm init ，建立一個空的package 管理</p>
<p><img src="https://i.imgur.com/rebkBba.png" alt="image-20210715164624123"></p>
<p>VSCode 套件，這個套件可以即時存檔的時候，在function 前面立即有綠勾或紅叉，告訴你這個測試結果是否通過。</p>
<p><img src="https://i.imgur.com/MvygGlJ.png" alt="image-20210715165151962"></p>
<h2 id="JEST-測試開發"><a href="#JEST-測試開發" class="headerlink" title="JEST 測試開發"></a>JEST 測試開發</h2><h3 id="測試流程"><a href="#測試流程" class="headerlink" title="測試流程"></a>測試流程</h3><ol>
<li>定義一段函式並匯出</li>
<li>定義.test測試檔案，並匯入上方函式</li>
<li>驗證結果</li>
</ol>
<p>筆記：使用node js 方式把 js export 出去</p>
<p><img src="https://i.imgur.com/ElQItBc.png" alt="image-20210715164712315"></p>
<p>筆記：再使用require 方式引入</p>
<p><img src="https://i.imgur.com/Tw37OVs.png" alt="image-20210715164747521"></p>
<p><img src="https://i.imgur.com/4LVAXFV.png" alt="image-20210715161350226"></p>
<h3 id="JEST-IO-Docs"><a href="#JEST-IO-Docs" class="headerlink" title="JEST IO Docs"></a>JEST IO Docs</h3><p><img src="https://i.imgur.com/b3tNzFI.png" alt="image-20210715161637847"></p>
<h3 id="相關測試函式"><a href="#相關測試函式" class="headerlink" title="相關測試函式"></a>相關測試函式</h3><p><img src="https://i.imgur.com/gH05LFE.png" alt="image-20210715165433056"></p>
<p><img src="https://i.imgur.com/QQRb6IA.png" alt="image-20210715165523555"></p>
<h4 id="驗證物件內容是否正確"><a href="#驗證物件內容是否正確" class="headerlink" title="驗證物件內容是否正確"></a>驗證物件內容是否正確</h4><p>物件本是是參考位置的概念，所以如果要驗證物件的內容是否相同可以使用<code>toEqual</code>方法，這個屬於深複製方式進行每一個key、value驗證</p>
<p><img src="https://i.imgur.com/1nRZOsJ.png" alt="image-20210715163557279"></p>
<h4 id="陣列是否包含特定值"><a href="#陣列是否包含特定值" class="headerlink" title="陣列是否包含特定值"></a>陣列是否包含特定值</h4><p><img src="https://i.imgur.com/VlThzeZ.png" alt="image-20210715163645518"></p>
<p><img src="https://i.imgur.com/YBzZAFR.png" alt="image-20210715163706990"></p>
<h4 id="數值必須大於300"><a href="#數值必須大於300" class="headerlink" title="數值必須大於300"></a>數值必須大於300</h4><p><img src="https://i.imgur.com/bpVPJ3w.png" alt="image-20210715163752310"></p>
<h4 id="正規表達式email-驗證"><a href="#正規表達式email-驗證" class="headerlink" title="正規表達式email 驗證"></a>正規表達式email 驗證</h4><p><img src="https://i.imgur.com/iaChTFI.png" alt="image-20210715163827033"></p>
<h3 id="describe-是一個群組的概念"><a href="#describe-是一個群組的概念" class="headerlink" title="describe 是一個群組的概念"></a>describe 是一個群組的概念</h3><p><img src="https://i.imgur.com/J2jbiHQ.png" alt="image-20210715163849282"></p>
<p>我們可以看到使用npm run test 有群組的訊息分類</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><img src="https://i.imgur.com/7W6Jc42.png" alt="image-20210715164302007"></p>
<h3 id="非同步測試"><a href="#非同步測試" class="headerlink" title="非同步測試"></a>非同步測試</h3><p><img src="https://i.imgur.com/xAzfBgj.png" alt="image-20210715170005601"></p>
<p><img src="https://i.imgur.com/8I1ZWRK.png" alt="image-20210715170654309"></p>
<p><img src="https://i.imgur.com/pXVZK7e.png" alt="image-20210715170552237"></p>
<p>以下兩個測試都是一樣的結果，使用<code>expct.assertions(1)</code> ，這個是一個斷言的東西，告訴程式非同步的等待會有幾個</p>
<p><img src="https://i.imgur.com/cOsufGR.png" alt="image-20210715171030792"></p>
<p>使用<code>await</code> 代表要等到拿到資料之後，才會往下執行<code>57</code>行程式</p>
<p><img src="https://i.imgur.com/GYnh3a8.png" alt="image-20210715171103015"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/17/2021-08-17%20Neor%20Profile%20Sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/17/2021-08-17%20Neor%20Profile%20Sql/" class="post-title-link" itemprop="url">Neor Profile Sql</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-17 14:37:00" itemprop="dateCreated datePublished" datetime="2021-08-17T14:37:00+08:00">2021-08-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-30 16:16:35" itemprop="dateModified" datetime="2021-09-30T16:16:35+08:00">2021-09-30</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>213</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://www.profilesql.com/">Neor Profile Sql download</a></p>
<p>啟動之後的畫面如下<br><img src="https://i.imgur.com/fNbMr4m.png"></p>
<p>關係圖如下</p>
<p><img src="https://i.imgur.com/r7w57C3.png"></p>
<h2 id="軟體設定"><a href="#軟體設定" class="headerlink" title="軟體設定"></a>軟體設定</h2><p>通常MYSQL的預設PORT是3306<br>因此在這個軟體設為3306</p>
<h2 id="PHP的程式資料庫設定"><a href="#PHP的程式資料庫設定" class="headerlink" title="PHP的程式資料庫設定"></a>PHP的程式資料庫設定</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$GLOBALS[&#x27;db&#x27;] = new db(&#x27;mysql:host=localhost;dbname=exam2018;port=4040&#x27;,&#x27;root&#x27;,&#x27;1234&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="參考畫面"><a href="#參考畫面" class="headerlink" title="參考畫面"></a>參考畫面</h2><p><img src="https://i.imgur.com/UeJ2Mgy.png"></p>
<p><img src="https://i.imgur.com/fLdU9Lz.png"></p>
<p><img src="https://i.imgur.com/ymVWE6r.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/17/2021-09-19%20PIXI%20JS%20%E8%B6%85%E4%BA%BA%E9%96%80%E5%AD%B8%E7%BF%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/17/2021-09-19%20PIXI%20JS%20%E8%B6%85%E4%BA%BA%E9%96%80%E5%AD%B8%E7%BF%92/" class="post-title-link" itemprop="url">PIXI JS 超人門學習</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-17 10:37:00" itemprop="dateCreated datePublished" datetime="2021-08-17T10:37:00+08:00">2021-08-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 11:25:08" itemprop="dateModified" datetime="2021-09-19T11:25:08+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>407</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基礎結構"><a href="#基礎結構" class="headerlink" title="基礎結構"></a>基礎結構</h2><h3 id="HTML、JS載入"><a href="#HTML、JS載入" class="headerlink" title="HTML、JS載入"></a>HTML、JS載入</h3><p><img src="https://i.imgur.com/qEkGAMk.png" alt="image-20210716151529109"></p>
<h3 id="JS-基礎說明"><a href="#JS-基礎說明" class="headerlink" title="JS 基礎說明"></a>JS 基礎說明</h3><p><img src="https://i.imgur.com/OjBdFdH.png" alt="image-20210716151203957"></p>
<h4 id="初始化設定"><a href="#初始化設定" class="headerlink" title="初始化設定"></a>初始化設定</h4><p><img src="https://i.imgur.com/RM2houw.png" alt="image-20210716151434641"></p>
<h2 id="pixijs-container-概念說明"><a href="#pixijs-container-概念說明" class="headerlink" title="pixijs container 概念說明"></a>pixijs container 概念說明</h2><p>stage 可以想像成是一個body 元素</p>
<p>建議在實作內容的時候都使用container 來包裏相關物件，在移動座標的時候，會比較好管理<img src="https://i.imgur.com/S9uMLhm.png" alt="image-20210716151831794"></p>
<h3 id="container-實作範例"><a href="#container-實作範例" class="headerlink" title="container 實作範例"></a>container 實作範例</h3><p><img src="https://i.imgur.com/REkfxI7.png" alt="image-20210716152334949"></p>
<h2 id="滑鼠監聽實作"><a href="#滑鼠監聽實作" class="headerlink" title="滑鼠監聽實作"></a>滑鼠監聽實作</h2><p><img src="https://i.imgur.com/5s3T7rC.png" alt="image-20210716154419564"></p>
<h2 id="container-add-event-實作"><a href="#container-add-event-實作" class="headerlink" title="container add event 實作"></a>container add event 實作</h2><p><img src="https://i.imgur.com/n05cWzE.png" alt="image-20210716154548989"></p>
<p>如果要有事件記得開啟<code>interactive=true</code> ,</p>
<p>而<code>buttonMode</code> 是cursor變為手指頭符號</p>
<h2 id="遊戲循環說明"><a href="#遊戲循環說明" class="headerlink" title="遊戲循環說明"></a>遊戲循環說明</h2><p><code>app.ticker</code></p>
<p>這邊可以理解成unity 的update 遊戲循環(個人的理解，還是需要爬文看一下這個套件對於ticker 的詳細說明)</p>
<p><img src="https://i.imgur.com/AcRic7s.png" alt="image-20210716154314683"></p>
<h2 id="GUI-工具"><a href="#GUI-工具" class="headerlink" title="GUI 工具"></a>GUI 工具</h2><h3 id="載入dat-gui-min-js-套件"><a href="#載入dat-gui-min-js-套件" class="headerlink" title="載入dat.gui.min.js 套件"></a>載入<code>dat.gui.min.js</code> 套件</h3><p><img src="https://i.imgur.com/bJW8oiR.png" alt="image-20210716155239657"></p>
<h3 id="new-datGuiData"><a href="#new-datGuiData" class="headerlink" title="new datGuiData()"></a><code>new datGuiData()</code></h3><p><img src="https://i.imgur.com/oYf83WR.png" alt="image-20210716155306960"></p>
<h3 id="set-app-ticker-add"><a href="#set-app-ticker-add" class="headerlink" title="set app.ticker.add()"></a><code>set app.ticker.add()</code></h3><p><img src="https://i.imgur.com/ml3ih6m.png" alt="image-20210716155335874"></p>
<h3 id="預覽結果畫面"><a href="#預覽結果畫面" class="headerlink" title="預覽結果畫面"></a>預覽結果畫面</h3><p>可以即時調整相關坐標，進行調整</p>
<p><img src="https://i.imgur.com/jhJjkSL.png" alt="image-20210716155358346"></p>
<h2 id="FPS-偵測外掛"><a href="#FPS-偵測外掛" class="headerlink" title="FPS 偵測外掛"></a>FPS 偵測外掛</h2><h3 id="載入Stats-min-js"><a href="#載入Stats-min-js" class="headerlink" title="載入Stats.min.js"></a>載入<code>Stats.min.js</code></h3><p><img src="https://i.imgur.com/AkArx13.png" alt="image-20210716160004003"></p>
<h3 id="JS-實作寫法"><a href="#JS-實作寫法" class="headerlink" title="JS 實作寫法"></a>JS 實作寫法</h3><p><img src="https://i.imgur.com/0200hXi.png" alt="image-20210716160052516"></p>
<h3 id="預覽結果"><a href="#預覽結果" class="headerlink" title="預覽結果"></a>預覽結果</h3><p><img src="https://i.imgur.com/msX0CLs.png" alt="image-20210716160602185"></p>
<h2 id="幾何圖形"><a href="#幾何圖形" class="headerlink" title="幾何圖形"></a>幾何圖形</h2><h3 id="畫圓、畫矩形"><a href="#畫圓、畫矩形" class="headerlink" title="畫圓、畫矩形"></a>畫圓、畫矩形</h3><p><img src="https://i.imgur.com/3cLLjkb.png" alt="image-20210716161720950"></p>
<h2 id="PIXI-chrome-plugin-外掛"><a href="#PIXI-chrome-plugin-外掛" class="headerlink" title="PIXI chrome plugin 外掛"></a>PIXI chrome plugin 外掛</h2><p><img src="https://i.imgur.com/vbPJCsc.png" alt="image-20210716161524141"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/13/2021-08-13%20SQL%20Server%20%E5%BF%83%E5%BE%97%E7%AD%86%E8%A8%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/13/2021-08-13%20SQL%20Server%20%E5%BF%83%E5%BE%97%E7%AD%86%E8%A8%98/" class="post-title-link" itemprop="url">SQL Server 心得筆記</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-13 21:14:00" itemprop="dateCreated datePublished" datetime="2021-08-13T21:14:00+08:00">2021-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>21 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h2><h3 id="字串相加方法1"><a href="#字串相加方法1" class="headerlink" title="字串相加方法1"></a>字串相加方法1</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> Concat_Name </span><br><span class="line">go</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> Concat_Name(<span class="variable">@cs</span> <span class="type">varchar</span>(<span class="number">1000</span>))</span><br><span class="line"><span class="keyword">returns</span> <span class="type">varchar</span>(<span class="number">3000</span>)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span>   <span class="variable">@String</span> <span class="type">varchar</span>(<span class="number">8000</span>)<span class="operator">=</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="variable">@String</span><span class="operator">=</span><span class="variable">@String</span> <span class="operator">+</span>name <span class="operator">+</span> <span class="string">&#x27;;&#x27;</span>  <span class="keyword">from</span> students <span class="keyword">where</span> class<span class="operator">=</span><span class="variable">@cs</span>	</span><br><span class="line"><span class="keyword">return</span> <span class="variable">@String</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> dbo.Concat_Name(<span class="string">&#x27;B&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/koXqtla.png" alt="image-20210809170549015"></p>
<p>![image-20210809170602581](E:\kite_project\SQLSERVER\SQL Server.assets\image-20210809170602581-16284999637694.png)</p>
<h3 id="字串相加方法2"><a href="#字串相加方法2" class="headerlink" title="字串相加方法2"></a>字串相加方法2</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">select</span> </span><br><span class="line">(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">cast</span>(name <span class="keyword">AS</span> NVARCHAR ) <span class="operator">+</span> <span class="string">&#x27;,&#x27;</span> </span><br><span class="line">    <span class="keyword">from</span> students  	</span><br><span class="line">	<span class="keyword">where</span> class<span class="operator">=</span><span class="string">&#x27;A&#x27;</span>	<span class="comment">--把name一樣的加起來</span></span><br><span class="line">	<span class="keyword">FOR</span> XML PATH(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">) <span class="keyword">as</span> Concat_Name</span><br></pre></td></tr></table></figure>





<h2 id="Trigger"><a href="#Trigger" class="headerlink" title="Trigger"></a>Trigger</h2><h3 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h3><p>先創建LOG表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">as</span> op,<span class="operator">*</span> <span class="keyword">INTO</span> students_log <span class="keyword">FROM</span> students <span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****** Object:  Trigger [dbo].[students_InsertTrigger]    Script Date: 2021/8/9 下午 05:36:40 ******/</span></span><br><span class="line"><span class="keyword">SET</span> ANSI_NULLS <span class="keyword">ON</span></span><br><span class="line">GO</span><br><span class="line"><span class="keyword">SET</span> QUOTED_IDENTIFIER <span class="keyword">ON</span></span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> [dbo].[students_InsertTrigger] <span class="keyword">ON</span> [dbo].[students]</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">INSERT</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@op</span> <span class="type">char</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@create_date</span> datetime;</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@id</span> <span class="type">int</span>;	</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@student_name</span> nvarchar(<span class="number">50</span>);</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@age</span> <span class="type">int</span>;</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@cs</span> nvarchar(<span class="number">50</span>);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">-- 取出新增紀錄</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">	<span class="variable">@create_date</span><span class="operator">=</span>[create_date],<span class="variable">@id</span><span class="operator">=</span>[id],<span class="variable">@student_name</span><span class="operator">=</span>[student_name],<span class="variable">@age</span><span class="operator">=</span>[age],<span class="variable">@cs</span><span class="operator">=</span>[class]</span><br><span class="line">    <span class="keyword">FROM</span> inserted;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 存到 LOG 檔案內</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> [students_log]([op],[create_date],[id],[student_name],[age],[class])</span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="string">&#x27;I&#x27;</span>,<span class="variable">@create_date</span>,<span class="variable">@id</span>,<span class="variable">@student_name</span>,<span class="variable">@age</span>,<span class="variable">@cs</span>);</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>



<p>test insert sql </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">INSERT</span> <span class="keyword">INTO</span> [students]([create_date],[id],[student_name],[age],[class])</span><br><span class="line"><span class="keyword">VALUES</span>(getdate(),<span class="number">15</span>,<span class="string">&#x27;aa&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;C&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> [dbo].[students_UpdateTrigger] <span class="keyword">ON</span> [dbo].[students]</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">UPDATE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@op</span> <span class="type">char</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@create_date</span> datetime;</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@id</span> <span class="type">int</span>;	</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@student_name</span> nvarchar(<span class="number">50</span>);</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@age</span> <span class="type">int</span>;</span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="variable">@cs</span> nvarchar(<span class="number">50</span>);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">-- 修改後</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">	<span class="variable">@create_date</span><span class="operator">=</span>[create_date],<span class="variable">@id</span><span class="operator">=</span>[id],<span class="variable">@student_name</span><span class="operator">=</span>[student_name],<span class="variable">@age</span><span class="operator">=</span>[age],<span class="variable">@cs</span><span class="operator">=</span>[class]</span><br><span class="line">    <span class="keyword">FROM</span> inserted;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 存到 LOG 檔案內</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> [students_log]([op],[create_date],[id],[student_name],[age],[class])</span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="string">&#x27;U&#x27;</span>,<span class="variable">@create_date</span>,<span class="variable">@id</span>,<span class="variable">@student_name</span>,<span class="variable">@age</span>,<span class="variable">@cs</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">--修改前</span></span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">	<span class="variable">@create_date</span><span class="operator">=</span>[create_date],<span class="variable">@id</span><span class="operator">=</span>[id],<span class="variable">@student_name</span><span class="operator">=</span>[student_name],<span class="variable">@age</span><span class="operator">=</span>[age],<span class="variable">@cs</span><span class="operator">=</span>[class]</span><br><span class="line">    <span class="keyword">FROM</span> deleted;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 存到 LOG 檔案內</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> [students_log]([op],[create_date],[id],[student_name],[age],[class])</span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="string">&#x27;D&#x27;</span>,<span class="variable">@create_date</span>,<span class="variable">@id</span>,<span class="variable">@student_name</span>,<span class="variable">@age</span>,<span class="variable">@cs</span>);</span><br><span class="line"></span><br><span class="line">GO</span><br></pre></td></tr></table></figure>



<p>test update sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> students <span class="keyword">set</span> student_name <span class="operator">=</span> <span class="string">&#x27;溜爺&#x27;</span> </span><br></pre></td></tr></table></figure>



<p><img src="https://i.imgur.com/ArX7CDh.png" alt="image-20210811105333032"></p>
<h2 id="Store-Procedure"><a href="#Store-Procedure" class="headerlink" title="Store Procedure"></a>Store Procedure</h2><p>優點</p>
<ol>
<li>預存程式可封裝，並隱藏複雜的商業邏輯。增加其隱蔽性, 安全性。</li>
</ol>
<p>可以將資料邏輯和商務規則 (Business Rule) 加以封裝，如此使用者就只能以開發人員和資料庫系統管理員預期的方式來存取資料及物件。</p>
<ol start="2">
<li><p>Stored Procedure 是已經編譯過的, 所以執行效率快</p>
</li>
<li><p>減少程式與資料庫的連結次數</p>
</li>
<li><p>預存程式可以回傳值，並可以接受參數。</p>
</li>
<li><p>預存程式無法使用 SELECT 指令來執行，因為它是子程式，與檢視表，資料表或使用者定義函式不同。</p>
</li>
<li><p>預存程式可以用在資料檢驗，強制實行商業邏輯等。</p>
</li>
<li><p>可以使用會驗證所有使用者輸入的參數化預存程序來防堵 SQL 插入式攻擊(SQL Injection)。 如果有使用動態 SQL，請務必將命令參數化，也絕對不要在查詢字串中直接包含參數值。</p>
</li>
<li><p>可以拒絕臨機操作 (Ad Hoc) 的查詢和資料修改作業。 如此可避免使用者因惡意或不慎而損毀資料，或執行會降低伺服器或網路效能的查詢。</p>
</li>
<li><p>可以處理程序程式碼中的錯誤，而不必將錯誤直接傳遞至用戶端應用程式。 如此可避免傳回可能助長探查攻擊的錯誤訊息。 請在伺服器上記錄及處理錯誤。</p>
</li>
<li><p>預存程序只需寫入一次，即可由許多應用程式存取。</p>
</li>
<li><p>用戶端應用程式不需要對基礎資料結構有任何了解。 您可以對預存程序程式碼進行變更，而不需變更用戶端應用程式，只要這些變更不會影響參數清單或傳回的資料型別即可。</p>
</li>
<li><p>預存程序可以將多項作業結合成單一的程序呼叫，藉此降低網路流量。</p>
</li>
</ol>
<p>缺點</p>
<ol>
<li><p>移植性差。預存程式，往往客製化於特定的資料庫上，因為支援的程式語言不同。當切換到其他廠商的資料庫系統時，需要重寫原有的預存程式。</p>
</li>
<li><p>對Server的負擔較大</p>
</li>
<li><p>預存程式的效能調校與撰寫，受限於各種資料庫系統。</p>
</li>
</ol>
<p><img src="https://i.imgur.com/Vav8q5R.png" alt="img"></p>
<p>假設四個不同應用系統都在Local端 所運行的這區塊程式功能都是做一樣的事情時<br>當一有功能調整<br>此時你會有需要對四個地方去做同樣調整<br>共需要做四次更改</p>
<p>這是違背開發上降低重複動作<br>設計觀念的</p>
<h2 id="常見用法"><a href="#常見用法" class="headerlink" title="常見用法"></a>常見用法</h2><h3 id="暫存表功能"><a href="#暫存表功能" class="headerlink" title="暫存表功能"></a>暫存表功能</h3><p>待寫</p>
<h3 id="查詢"><a href="#查詢" class="headerlink" title="查詢"></a>查詢</h3><h4 id="從子查詢結果寫入新表"><a href="#從子查詢結果寫入新表" class="headerlink" title="從子查詢結果寫入新表"></a>從子查詢結果寫入新表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">INTO</span> KITE </span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> ITEMS <span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">/* condition */</span></span><br><span class="line">) <span class="keyword">AS</span> A </span><br></pre></td></tr></table></figure>

<blockquote>
<p>資料表較大時，可以先取出某一部分進行查詢數據，效能比較快</p>
</blockquote>
<h4 id="以客戶資料為主table，查詢最後一筆交易產品線記錄"><a href="#以客戶資料為主table，查詢最後一筆交易產品線記錄" class="headerlink" title="以客戶資料為主table，查詢最後一筆交易產品線記錄"></a>以客戶資料為主table，查詢最後一筆交易產品線記錄</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> AA001 <span class="keyword">AS</span> 客戶代號</span><br><span class="line">,(<span class="keyword">SELECT</span> TOP <span class="number">1</span> PRODUCT_DATE <span class="keyword">FROM</span> ORDER_BOM <span class="keyword">WHERE</span> OD_AA001<span class="operator">=</span>AA001 <span class="keyword">ORDER</span> <span class="keyword">BY</span> PRODUCT_DATE <span class="keyword">DESC</span>) 最後一次交易日</span><br><span class="line"><span class="keyword">FROM</span> CRMAA</span><br><span class="line"><span class="keyword">WHERE</span> AA013 <span class="keyword">IN</span>(<span class="string">&#x27;台北&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>常見狀況以主表資料為主，再去撈取某一資訊，放在欄位上進行呈現</p>
<p>當然，如果有多個欄位，用一樣的語句結構，再多寫幾行子查詢</p>
</blockquote>
<h4 id="子表完成後，再進行第二次篩選"><a href="#子表完成後，再進行第二次篩選" class="headerlink" title="子表完成後，再進行第二次篩選"></a>子表完成後，再進行第二次篩選</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> A.<span class="operator">*</span></span><br><span class="line">,HC050 訂單合約起日,HC051  訂單合約迄日</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> AA001 <span class="keyword">AS</span> 客戶代號,AA002 <span class="keyword">AS</span> 客戶名稱,OD004 <span class="keyword">AS</span> 出貨日期,OD005 <span class="keyword">AS</span> 出貨單號</span><br><span class="line">    <span class="keyword">FROM</span> ORDER_BOM</span><br><span class="line">    <span class="keyword">JOIN</span> CRMAA <span class="keyword">ON</span> AA001<span class="operator">=</span>OD_AA001</span><br><span class="line">    <span class="keyword">WHERE</span> </span><br><span class="line">    <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> OD_AA001</span><br><span class="line">) <span class="keyword">AS</span> A </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> CRMHC <span class="keyword">ON</span> HC002 <span class="operator">=</span> REPLACE(出貨單號,<span class="string">&#x27;DS2-&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 出貨日期,客戶代號</span><br></pre></td></tr></table></figure>

<blockquote>
<p>縮限資料後，再進行第二次的篩選</p>
</blockquote>
<h4 id="子表完成後，進行第三次篩選"><a href="#子表完成後，進行第三次篩選" class="headerlink" title="子表完成後，進行第三次篩選"></a>子表完成後，進行第三次篩選</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> AR001,AR002,AR003,AR004,PE2.PE02,PE2.PE03,PE2.PE04 <span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SERAR_KITE2</span><br><span class="line">	<span class="keyword">WHERE</span> RTRIM(AR001)<span class="operator">+</span>RTRIM(AR002)<span class="operator">+</span>RTRIM(AR003)<span class="operator">+</span>RTRIM(AR004) </span><br><span class="line">	<span class="keyword">IN</span></span><br><span class="line">	(</span><br><span class="line">	<span class="keyword">SELECT</span> RTRIM(AR001)<span class="operator">+</span>RTRIM(AR002)<span class="operator">+</span>RTRIM(AR003)<span class="operator">+</span>RTRIM(AR004) </span><br><span class="line">	<span class="keyword">FROM</span> SERAR_KITE2</span><br><span class="line">	<span class="keyword">GROUP</span>  <span class="keyword">BY</span> AR001,AR002,AR003,AR004 <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(PE02) <span class="operator">&gt;</span><span class="number">1</span></span><br><span class="line">	) </span><br><span class="line">) <span class="keyword">AS</span> AR</span><br><span class="line"><span class="keyword">JOIN</span> DSCPE PE2 <span class="keyword">ON</span> AR.PE02<span class="operator">=</span>PE2.PE02 <span class="keyword">collate</span> database_default</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> AR001,AR002,AR003,AR004</span><br></pre></td></tr></table></figure>

<blockquote>
<p>同樣概念也可以包N層</p>
</blockquote>
<h4 id="縱向轉直向"><a href="#縱向轉直向" class="headerlink" title="縱向轉直向"></a>縱向轉直向</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="built_in">COUNT</span>(<span class="keyword">CASE</span> class <span class="keyword">WHEN</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">THEN</span> class <span class="keyword">END</span>) <span class="keyword">as</span> A_CLASS_CNT</span><br><span class="line">,<span class="built_in">COUNT</span>(<span class="keyword">CASE</span> class <span class="keyword">WHEN</span> <span class="string">&#x27;b&#x27;</span> <span class="keyword">THEN</span> class <span class="keyword">END</span>) <span class="keyword">as</span> B_CLASS_CNT</span><br><span class="line"><span class="keyword">FROM</span> students </span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/It9Y6Ec.png" alt="image-20210809163459420"></p>
<p><img src="https://i.imgur.com/QPhMd95.png" alt="image-20210809163528735"></p>
<blockquote>
<p>同一個表統計時，如果有COUNT需求，要轉向，是可以這樣寫的</p>
</blockquote>
<h4 id="相乘"><a href="#相乘" class="headerlink" title="相乘"></a>相乘</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> student_name,subject_name </span><br><span class="line"><span class="keyword">FROM</span> students,subjects</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> student_name,subject_name</span><br></pre></td></tr></table></figure>



<p><img src="https://i.imgur.com/7ZvKwVo.png" alt="image-20210809171947986"></p>
<p><img src="https://i.imgur.com/ud4j7dU.png" alt="image-20210809172246152"></p>
<blockquote>
<p>自行想像需求</p>
</blockquote>
<h3 id="修改-1"><a href="#修改-1" class="headerlink" title="修改"></a>修改</h3><h4 id="參考table更新至目的table"><a href="#參考table更新至目的table" class="headerlink" title="參考table更新至目的table"></a>參考table更新至目的table</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> AR1 <span class="keyword">SET</span> AR1.AR005<span class="operator">=</span> AR2.PE02</span><br><span class="line"><span class="comment">--SELECT AR1.AR005,AR2.PE02</span></span><br><span class="line"><span class="keyword">FROM</span> SERAR_KITE AR1 <span class="keyword">JOIN</span> SERAR_KITE2 AR2 <span class="keyword">ON</span> AR1.AR001<span class="operator">=</span> AR2.AR001 <span class="keyword">AND</span> AR1.AR002<span class="operator">=</span>AR2.AR002 <span class="keyword">AND</span> AR1.AR003<span class="operator">=</span>AR2.AR003 <span class="keyword">AND</span> AR1.AR004<span class="operator">=</span>AR2.AR004</span><br><span class="line"><span class="keyword">WHERE</span> AR1.AR005 <span class="operator">!=</span>AR2.PE02</span><br></pre></td></tr></table></figure>



<h3 id="新增-1"><a href="#新增-1" class="headerlink" title="新增"></a>新增</h3><h4 id="批次新增資料，參考既有table，更新目的table"><a href="#批次新增資料，參考既有table，更新目的table" class="headerlink" title="批次新增資料，參考既有table，更新目的table"></a>批次新增資料，參考既有table，更新目的table</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--一般業務</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@JOB_ID</span> <span class="keyword">AS</span> <span class="type">VARCHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@UID</span> <span class="keyword">AS</span> <span class="type">VARCHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@JOB_ID</span><span class="operator">=</span><span class="string">&#x27;001&#x27;</span> <span class="comment">--一般業務</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@UID</span><span class="operator">=</span><span class="string">&#x27;02944&#x27;</span>  <span class="comment">-- 參考工號</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> ADMML (ML001,ML002,ML003,ML004,ML005,ML006,ML007,ML008,ML009,ML010)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="variable">@JOB_ID</span> <span class="keyword">AS</span> ML001,MG002 <span class="keyword">AS</span> ML002, MG003 <span class="keyword">AS</span> ML003,MG004 <span class="keyword">AS</span> ML004,MG005 <span class="keyword">AS</span> ML005,MG006 <span class="keyword">AS</span> ML006,MG007 <span class="keyword">AS</span> ML007,<span class="string">&#x27;&#x27;</span> <span class="keyword">AS</span> ML008,MG009 <span class="keyword">AS</span> ML009,MG010 <span class="keyword">AS</span> ML010</span><br><span class="line"><span class="keyword">FROM</span> ADMMG_ACP <span class="keyword">WHERE</span> MG001<span class="operator">=</span><span class="variable">@UID</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> MG002</span><br></pre></td></tr></table></figure>

<blockquote>
<p>批次新增資料，再利用參數方式去當條件</p>
</blockquote>
<h4 id="批次新增資眼，excel-來源匯入，更新目的table"><a href="#批次新增資眼，excel-來源匯入，更新目的table" class="headerlink" title="批次新增資眼，excel 來源匯入，更新目的table"></a>批次新增資眼，excel 來源匯入，更新目的table</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> CRMHG(HG001,HG005,HG002,HG032,HG033,HG024,HG021,HG007,HG010,HG012,HG026,HG008,HG011)</span><br><span class="line"><span class="keyword">SELECT</span> 客戶代號,姓名,<span class="string">&#x27;8888&#x27;</span>,職稱,職能別,郵區,公司地址,電話<span class="number">1</span>,電話<span class="number">1</span>_分機,行動電話,行動電話<span class="number">2</span>,電話<span class="number">2</span>,電話<span class="number">2</span>_分機</span><br><span class="line"><span class="keyword">FROM</span> [dbo].[工作表_kite] </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">是否匯入<span class="operator">=</span><span class="string">&#x27;Y&#x27;</span> </span><br><span class="line"><span class="keyword">AND</span> (客戶代號 <span class="keyword">collate</span> database_default <span class="operator">+</span> 姓名 <span class="keyword">collate</span> database_default) <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> HG001<span class="operator">+</span>HG005 <span class="keyword">FROM</span> CRMHG)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>匯入EXCEL到SQLSERVER之後，要注意的是<code>定序</code>問題 </p>
</blockquote>
<h3 id="日期格式轉換"><a href="#日期格式轉換" class="headerlink" title="日期格式轉換"></a>日期格式轉換</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CONVERT</span>(<span class="type">VARCHAR</span>(<span class="number">12</span>),CRMCC.CREATE_DATE,<span class="number">112</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>常見YYYYMMDD格式</p>
</blockquote>
<h3 id="跨DB連線"><a href="#跨DB連線" class="headerlink" title="跨DB連線"></a>跨DB連線</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> OPENDATASOURCE(<span class="string">&#x27;SQLOLEDB&#x27;</span>,<span class="string">&#x27;Data Source = 10.40.40.232;User ID= xx; Password = xxx&#x27;</span>). db.table</span><br></pre></td></tr></table></figure>

<p>Link Server </p>
<p>待寫</p>
<h3 id="字元說明"><a href="#字元說明" class="headerlink" title="字元說明"></a>字元說明</h3><p>char(13) &#x3D; Enter</p>
<p>char(10) &#x3D; 折行</p>
<p>char(32) &#x3D; 空格</p>
<p>char(255) &#x3D; null</p>
<h2 id="維運相關"><a href="#維運相關" class="headerlink" title="維運相關"></a>維運相關</h2><p>sp_lock</p>
<p>sp_who</p>
<p>sp_who2</p>
<h3 id="效能語法"><a href="#效能語法" class="headerlink" title="效能語法"></a>效能語法</h3><h4 id="SQL-SERVER-2000"><a href="#SQL-SERVER-2000" class="headerlink" title="SQL SERVER 2000"></a>SQL SERVER 2000</h4><h5 id="列出最初導致一連串其它處理序被鎖住的起始源頭"><a href="#列出最初導致一連串其它處理序被鎖住的起始源頭" class="headerlink" title="列出最初導致一連串其它處理序被鎖住的起始源頭"></a>列出最初導致一連串其它處理序被鎖住的起始源頭</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">IF <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> master.dbo.sysprocesses <span class="keyword">WHERE</span> spid <span class="keyword">in</span> (<span class="keyword">SELECT</span> blocked <span class="keyword">FROM</span> master.dbo.sysprocesses))</span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SELECT</span> spid 處理序, status 狀態</span><br><span class="line">  , 登入帳號<span class="operator">=</span><span class="built_in">SUBSTRING</span>(SUSER_SNAME(sid), <span class="number">1</span>, <span class="number">30</span>)</span><br><span class="line">  , 使用者機器名稱<span class="operator">=</span><span class="built_in">SUBSTRING</span>(hostname, <span class="number">1</span>, <span class="number">12</span>)</span><br><span class="line">  , 是否鎖住<span class="operator">=</span><span class="keyword">CONVERT</span>(<span class="type">char</span>(<span class="number">3</span>), blocked)</span><br><span class="line">  , 資料庫名稱<span class="operator">=</span><span class="built_in">SUBSTRING</span>(DB_NAME(dbid), <span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">  , cmd 命令, waittype 等待類型</span><br><span class="line">  <span class="keyword">FROM</span> master.dbo.sysprocesses</span><br><span class="line">  <span class="comment">--找出鎖住別(自己未被鎖住(blocked=0) 但在別的處理序中blocked欄位出現的值)</span></span><br><span class="line">  <span class="keyword">WHERE</span> spid <span class="keyword">IN</span> (<span class="keyword">SELECT</span> blocked <span class="keyword">FROM</span> master.dbo.sysprocesses)</span><br><span class="line">  <span class="keyword">AND</span> blocked <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">SELECT</span> <span class="string">&#x27;沒有處理序被鎖住&#x27;</span></span><br><span class="line"> <span class="keyword">END</span></span><br></pre></td></tr></table></figure>



<h4 id="SQL-SERVER-2008"><a href="#SQL-SERVER-2008" class="headerlink" title="SQL SERVER 2008"></a>SQL SERVER 2008</h4><h5 id="找出最耗用IO的語法"><a href="#找出最耗用IO的語法" class="headerlink" title="找出最耗用IO的語法"></a>找出最耗用IO的語法</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TOP <span class="number">10</span></span><br><span class="line">total_logical_reads,</span><br><span class="line">total_logical_writes,</span><br><span class="line">execution_count,</span><br><span class="line">total_logical_reads<span class="operator">+</span>total_logical_writes <span class="keyword">AS</span> [IO_total],</span><br><span class="line">st.text <span class="keyword">AS</span> query_text,</span><br><span class="line">db_name(st.dbid) <span class="keyword">AS</span> database_name,</span><br><span class="line">st.objectid <span class="keyword">AS</span> object_id</span><br><span class="line"><span class="keyword">FROM</span> sys.dm_exec_query_stats qs</span><br><span class="line"><span class="keyword">CROSS</span> APPLY sys.dm_exec_sql_text(sql_handle) st</span><br><span class="line"><span class="keyword">WHERE</span> total_logical_reads<span class="operator">+</span>total_logical_writes<span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> [IO_total] <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure>



<h5 id="列出目前最耗用CPU的前50個查詢"><a href="#列出目前最耗用CPU的前50個查詢" class="headerlink" title="列出目前最耗用CPU的前50個查詢"></a>列出目前最耗用CPU的前50個查詢</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  TOP <span class="number">50</span></span><br><span class="line">qs.total_worker_time <span class="operator">/</span> qs.execution_count <span class="keyword">AS</span>[Avg CPU <span class="type">Time</span>],</span><br><span class="line"><span class="built_in">SUBSTRING</span>(qt.text, qs.statement_start_offset <span class="operator">/</span> <span class="number">2</span>,</span><br><span class="line">(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> qs.statement_end_offset <span class="operator">=</span> <span class="number">-1</span> <span class="keyword">THEN</span> len(<span class="keyword">CONVERT</span> (NVARCHAR (MAX), qt.text)) <span class="operator">*</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">ELSE</span> qs.statement_end_offset <span class="keyword">END</span> <span class="operator">-</span> qs.statement_start_offset) <span class="operator">/</span> <span class="number">2</span>) <span class="keyword">AS</span> query_text,</span><br><span class="line">qt.dbid,</span><br><span class="line">qt.objectid</span><br><span class="line"><span class="keyword">FROM</span>     sys.dm_exec_query_stats <span class="keyword">AS</span> qs</span><br><span class="line"><span class="keyword">CROSS</span> APPLY sys.dm_exec_sql_text (qs.sql_handle) <span class="keyword">AS</span> qt</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> [Avg CPU <span class="type">Time</span>] <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>



<h5 id="列出目前最耗用Worker-Time的前50個查詢"><a href="#列出目前最耗用Worker-Time的前50個查詢" class="headerlink" title="列出目前最耗用Worker Time的前50個查詢"></a>列出目前最耗用Worker Time的前50個查詢</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>   TOP <span class="number">50</span> <span class="built_in">sum</span>(qs.total_worker_time) <span class="keyword">AS</span> total_cpu_time,</span><br><span class="line"><span class="built_in">sum</span>(qs.execution_count) <span class="keyword">AS</span> total_execution_count,</span><br><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">AS</span> <span class="string">&#x27;#_statements&#x27;</span>,</span><br><span class="line">qt.dbid,</span><br><span class="line">qt.objectid,</span><br><span class="line">qs.sql_handle,</span><br><span class="line">qt.[text]</span><br><span class="line"><span class="keyword">FROM</span>     sys.dm_exec_query_stats <span class="keyword">AS</span> qs</span><br><span class="line"><span class="keyword">CROSS</span> APPLY sys.dm_exec_sql_text (qs.sql_handle) <span class="keyword">AS</span> qt</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> qt.dbid, qt.objectid, qs.sql_handle, qt.[text]</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">sum</span>(qs.total_worker_time) <span class="keyword">DESC</span>, qs.sql_handle;</span><br></pre></td></tr></table></figure>



<h5 id="取得-SQL-Server-資料庫正在執行的-T-SQL-指令與詳細資訊"><a href="#取得-SQL-Server-資料庫正在執行的-T-SQL-指令與詳細資訊" class="headerlink" title="取得 SQL Server 資料庫正在執行的 T-SQL 指令與詳細資訊"></a>取得 SQL Server 資料庫正在執行的 T-SQL 指令與詳細資訊</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>      r.scheduler_id <span class="keyword">as</span> 排程器識別碼,</span><br><span class="line">            status         <span class="keyword">as</span> 要求的狀態,</span><br><span class="line">            r.session_id   <span class="keyword">as</span> SPID,</span><br><span class="line">            r.blocking_session_id <span class="keyword">as</span> BlkBy,</span><br><span class="line">            <span class="built_in">substring</span>(</span><br><span class="line">				ltrim(q.text),</span><br><span class="line">				r.statement_start_offset<span class="operator">/</span><span class="number">2</span><span class="operator">+</span><span class="number">1</span>,</span><br><span class="line">				(<span class="keyword">CASE</span></span><br><span class="line">                 <span class="keyword">WHEN</span> r.statement_end_offset <span class="operator">=</span> <span class="number">-1</span></span><br><span class="line">                 <span class="keyword">THEN</span> LEN(<span class="keyword">CONVERT</span>(nvarchar(MAX), q.text)) <span class="operator">*</span> <span class="number">2</span></span><br><span class="line">                 <span class="keyword">ELSE</span> r.statement_end_offset</span><br><span class="line">                 <span class="keyword">END</span> <span class="operator">-</span> r.statement_start_offset)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line">                 <span class="keyword">AS</span> [正在執行的 T<span class="operator">-</span><span class="keyword">SQL</span> 命令],</span><br><span class="line">            r.cpu_time      <span class="keyword">as</span> [CPU <span class="type">Time</span>(ms)],</span><br><span class="line">            r.start_time    <span class="keyword">as</span> [開始時間],</span><br><span class="line">            r.total_elapsed_time <span class="keyword">as</span> [執行總時間],</span><br><span class="line">            r.reads              <span class="keyword">as</span> [讀取數],</span><br><span class="line">            r.writes             <span class="keyword">as</span> [寫入數],</span><br><span class="line">            r.logical_reads      <span class="keyword">as</span> [邏輯讀取數],</span><br><span class="line">            <span class="comment">-- q.text, /* 完整的 T-SQL 指令碼 */</span></span><br><span class="line">            d.name               <span class="keyword">as</span> [資料庫名稱]</span><br><span class="line"><span class="keyword">FROM</span>        sys.dm_exec_requests r </span><br><span class="line">			<span class="keyword">CROSS</span> APPLY sys.dm_exec_sql_text(sql_handle) <span class="keyword">AS</span> q</span><br><span class="line">			<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> sys.databases d <span class="keyword">ON</span> (r.database_id<span class="operator">=</span>d.database_id)</span><br><span class="line"><span class="keyword">WHERE</span>       r.session_id <span class="operator">&gt;</span> <span class="number">50</span> <span class="keyword">AND</span> r.session_id <span class="operator">&lt;&gt;</span> @<span class="variable">@SPID</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span>    r.total_elapsed_time <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>



<h5 id="找出來因為封鎖-Blocked-Lock-造成的等待時間、被封鎖的連線等等之相關資訊。"><a href="#找出來因為封鎖-Blocked-Lock-造成的等待時間、被封鎖的連線等等之相關資訊。" class="headerlink" title="找出來因為封鎖(Blocked Lock)造成的等待時間、被封鎖的連線等等之相關資訊。"></a>找出來因為封鎖(Blocked Lock)造成的等待時間、被封鎖的連線等等之相關資訊。</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> session_id N<span class="string">&#x27;工作階段識別碼&#x27;</span>,status N<span class="string">&#x27;要求的狀態&#x27;</span>,</span><br><span class="line">command N<span class="string">&#x27;目前所處理命令的類型&#x27;</span>,blocking_session_id N<span class="string">&#x27;封鎖要求之工作階段的識別碼&#x27;</span> ,</span><br><span class="line">wait_type N<span class="string">&#x27;被封鎖的等候類型&#x27;</span>,wait_time N<span class="string">&#x27;等候的持續時間&#x27;</span>,</span><br><span class="line">wait_resource N<span class="string">&#x27;目前等候的資源&#x27;</span>,transaction_id N<span class="string">&#x27;要求執行所在交易的識別碼&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> sys.dm_exec_requests</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span> <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure>



<h3 id="踢掉所有用戶"><a href="#踢掉所有用戶" class="headerlink" title="踢掉所有用戶"></a>踢掉所有用戶</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use master</span><br><span class="line"><span class="keyword">ALTER</span> DATABASE YourDatabase <span class="keyword">SET</span> SINGLE_USER <span class="keyword">WITH</span> <span class="keyword">ROLLBACK</span> IMMEDIATE </span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE YourDatabase <span class="keyword">SET</span> MULTI_USER</span><br></pre></td></tr></table></figure>



<h3 id="清LOG"><a href="#清LOG" class="headerlink" title="清LOG"></a>清LOG</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">BACKUP LOG DSC_CRM_SP <span class="keyword">WITH</span> TRUNCATE_ONLY</span><br><span class="line">DBCC SHRINKFILE (<span class="string">&#x27;DSC_CRM_SP_Log&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">DBCC SHRINKFILE (<span class="string">&#x27;DSC_CRM_SP_Log&#x27;</span> ,<span class="number">0</span>,TRUNCATEONLY) </span><br><span class="line"></span><br><span class="line">USE DSC_CRM_TEST</span><br><span class="line">CHECKPOINT</span><br><span class="line">DBCC SHRINKFILE(<span class="number">2</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">BACKUP LOG [DSC_CRM_TEST] <span class="keyword">WITH</span> TRUNCATE_ONLY;</span><br><span class="line">DBCC SHRINKFILE ([DSC_CRM_TEST_Log],<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE DSC_CRM_SP <span class="keyword">SET</span> RECOVERY SIMPLE <span class="keyword">WITH</span> NO_WAIT</span><br><span class="line">DBCC SHRINKFILE(DSC_CRM_SP_Log, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">ALTER</span> DATABASE DSC_CRM_SP <span class="keyword">SET</span> RECOVERY <span class="keyword">FULL</span> <span class="keyword">WITH</span> NO_WAIT</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">BACKUP LOG [Quiz] <span class="keyword">WITH</span> TRUNCATE_ONLY;</span><br><span class="line">DBCC SHRINKFILE ([Quiz_Log],<span class="number">500</span>);</span><br></pre></td></tr></table></figure>





<h3 id="查詢table使用空間"><a href="#查詢table使用空間" class="headerlink" title="查詢table使用空間"></a>查詢table使用空間</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> NOCOUNT <span class="keyword">ON</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">--http://msdn.microsoft.com/zh-tw/library/ms188414.aspx</span></span><br><span class="line"><span class="comment">--更新目前資料庫中之所有物件的頁面及 (或) 資料列計數</span></span><br><span class="line">DBCC UPDATEUSAGE(<span class="number">0</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">-- DB size.</span></span><br><span class="line"><span class="keyword">EXEC</span> sp_spaceused</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Table row counts and sizes.</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> #t </span><br><span class="line">( </span><br><span class="line">    [name] NVARCHAR(<span class="number">128</span>),</span><br><span class="line">    [<span class="keyword">rows</span>] <span class="type">CHAR</span>(<span class="number">11</span>),</span><br><span class="line">    reserved <span class="type">VARCHAR</span>(<span class="number">18</span>), </span><br><span class="line">    data <span class="type">VARCHAR</span>(<span class="number">18</span>), </span><br><span class="line">    index_size <span class="type">VARCHAR</span>(<span class="number">18</span>),</span><br><span class="line">    unused <span class="type">VARCHAR</span>(<span class="number">18</span>)</span><br><span class="line">) </span><br><span class="line"> </span><br><span class="line"><span class="comment">--把每個Table使用的資訊存到#t之中</span></span><br><span class="line"><span class="keyword">INSERT</span> #t <span class="keyword">EXEC</span> sys.sp_MSforeachtable <span class="string">&#x27;EXEC sp_spaceused &#x27;&#x27;?&#x27;&#x27;&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">--依使用空間較大的依序排列並顯示MB</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">, LTRIM(STR(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(reserved,LEN(reserved)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>)) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> reservedSize_M</span><br><span class="line">, LTRIM(STR(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(data,LEN(data)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>)) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> dataSize_M</span><br><span class="line">, LTRIM(STR(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(index_size,LEN(index_size)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>)) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> indexSize_M</span><br><span class="line"><span class="keyword">FROM</span> #t</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(data,LEN(data)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>)) <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 顯示總共筆數及總共使用資訊</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(<span class="built_in">CAST</span>([<span class="keyword">rows</span>] <span class="keyword">AS</span> <span class="type">int</span>)) <span class="keyword">AS</span> [<span class="keyword">rows</span>]</span><br><span class="line">, LTRIM(STR(<span class="built_in">SUM</span>(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(reserved,LEN(reserved)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>))) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> sumOfreservedSize_M</span><br><span class="line">, LTRIM(STR(<span class="built_in">SUM</span>(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(data,LEN(data)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>))) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> sumOfdataSize_M</span><br><span class="line">, LTRIM(STR(<span class="built_in">SUM</span>(<span class="built_in">CAST</span>(<span class="keyword">LEFT</span>(index_size,LEN(index_size)<span class="number">-3</span>) <span class="keyword">AS</span> <span class="type">NUMERIC</span>(<span class="number">18</span>,<span class="number">0</span>))) <span class="operator">/</span> <span class="number">1024</span>, <span class="number">18</span>)) <span class="operator">+</span> <span class="string">&#x27;MB&#x27;</span> <span class="keyword">AS</span> sumOfindexSize_M</span><br><span class="line"><span class="keyword">FROM</span> #t</span><br><span class="line"> </span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> #t </span><br></pre></td></tr></table></figure>





<h2 id="複寫機制"><a href="#複寫機制" class="headerlink" title="複寫機制"></a>複寫機制</h2><h2 id="SQL-Profile"><a href="#SQL-Profile" class="headerlink" title="SQL Profile"></a>SQL Profile</h2><h2 id="效能ISSUE"><a href="#效能ISSUE" class="headerlink" title="效能ISSUE"></a>效能ISSUE</h2><h2 id="資料庫維護計劃"><a href="#資料庫維護計劃" class="headerlink" title="資料庫維護計劃"></a>資料庫維護計劃</h2><h2 id="SSDT"><a href="#SSDT" class="headerlink" title="SSDT"></a>SSDT</h2><h2 id="ETL"><a href="#ETL" class="headerlink" title="ETL"></a>ETL</h2><p><img src="https://i.imgur.com/flMV4Ze.png" alt="img"></p>
<p>ETL 真的沒啥好介紹的，概念真的太簡單好懂。</p>
<ul>
<li>Extract: 把資料從某個地方拿出來。</li>
<li>Transform: 將資料作轉換。</li>
<li>Load: 湊數的一步，把轉換完的資料丟到某個地方。</li>
</ul>
<p>ETL 之所以必要在於，原始資料通常不適合拿來直接使用的。原因在於：</p>
<ul>
<li>原始資料量太大：通常前端在收資料的時候，都會使用比較鬆散的事件格式，像是 JSON，也通常不會做壓縮。這樣在計算時需要消耗較多的資源，也會影響計算速度。所以通常在使用之前會做最基本的壓縮和格式最佳化。</li>
<li>資料不乾淨：通常資料前端收進來的時候，如果沒有處理好，會遇到很多奇怪的狀況，「Garbage in、garbase out」所以確保資料的品質非常重要。比較基本的像是格式、數值範圍，更複雜的一點包括欄位統計值甚至邏輯等等。</li>
<li>比較複雜的 Aggregation：資料是隨著事件進來，但是使用上可能會以每小時、每天為單位來進行分析或計算。如果每次畫報表都必須從最原始的資料開始算，會消耗大量計算資源，而且 SQL 或計算也會非常複雜，所以一般來說都會先將原始資料聚合成一些時間粒度稍微「粗」一點的資料，才會來做後續應用。</li>
</ul>
<p>以下從網路上找幾個應用範例：</p>
<h3 id="標準的清理資料流程"><a href="#標準的清理資料流程" class="headerlink" title="標準的清理資料流程"></a>標準的清理資料流程</h3><p><img src="https://i.imgur.com/FwDGYTJ.png" alt="img"></p>
<p>一般來說，資料在進入 Data Warehouse 前，都必須經過這幾個階段，才能供後續業務報表或是視覺化使用。算是基本起手式吧。</p>
<h3 id="在不同層（Layer）的資料之間作轉換"><a href="#在不同層（Layer）的資料之間作轉換" class="headerlink" title="在不同層（Layer）的資料之間作轉換"></a>在不同層（Layer）的資料之間作轉換</h3><p><img src="https://i.imgur.com/SD2FU05.png" alt="img"></p>
<p>資料傳送到後端後，會經過 ETL 放到 Staging 環境、再透過 ETL 放到 DW、再透過 ETL 整理到了 Data Mart 給 End User 使用。當原始資料越複雜、資料量越多，中間就更需要多層次的處理來確保資料品質以及使用上的效能。</p>
<h3 id="Streaming-ETL"><a href="#Streaming-ETL" class="headerlink" title="Streaming ETL"></a>Streaming ETL</h3><p><img src="https://i.imgur.com/b6qLKHt.jpg" alt="img"></p>
<p>當然除了 Batch ETL 外，Streaming ETL 也是有的。可以根據事件、或是 mini batch 的方式來處理原始資料，配合 Batch Process 來處理累積的資料。</p>
<p>總之 ETL 是個很廣泛的領域，不僅僅是「資料處理」四個字而已。還需要考量到軟硬體架構、商務邏輯、後續的使用才能設計最適合的 ETL 流程。</p>
<h2 id="參考連結"><a href="#參考連結" class="headerlink" title="參考連結"></a>參考連結</h2><p><a target="_blank" rel="noopener" href="https://medium.com/bryanyang0528/data-data-pipeline-101-%E4%BA%8C-stage-%E5%92%8C-job-287d0e9be9f2?source=your_stories_page---------------------------">Data Data Pipeline 101（三）—ETL</a></p>
<p><a target="_blank" rel="noopener" href="https://dotblogs.com.tw/mis2000lab/2014/06/12/sql-server-trigger">SQL ServerTrigger的簡單範例，以「訂單的流程系統」為例</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/13/2021-08-13%20Phaser%20%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/13/2021-08-13%20Phaser%20%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%95%B4%E7%90%86/" class="post-title-link" itemprop="url">Phaser 使用技巧整理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-13 14:39:00" itemprop="dateCreated datePublished" datetime="2021-08-13T14:39:00+08:00">2021-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 10:17:13" itemprop="dateModified" datetime="2021-09-19T10:17:13+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>9.2k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>17 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>專案 載浮載沉</p>
<p>版本 phaser3.55.2.js</p>
<h2 id="資源"><a href="#資源" class="headerlink" title="資源"></a>資源</h2><p><a target="_blank" rel="noopener" href="https://labs.phaser.io/index.html">phaser3官網 example</a></p>
<h2 id="閱讀"><a href="#閱讀" class="headerlink" title="閱讀"></a>閱讀</h2><p><a target="_blank" rel="noopener" href="https://steemit.com/utopian-io/@onepice/move-objects-according-to-the-mouse-position-with-phaser-3">Move Objects According To The Mouse Position With Phaser 3</a></p>
<p><a target="_blank" rel="noopener" href="https://www.codeandweb.com/texturepacker/tutorials/how-to-create-sprite-sheets-for-phaser3">how-to-create-sprite-sheets-for-phaser3</a></p>
<p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/users/20111617/ironman/1794">Phaser 幫我撐個 30 天</a></p>
<h2 id="圖層順序"><a href="#圖層順序" class="headerlink" title="圖層順序"></a>圖層順序</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.<span class="title function_">setDepth</span>(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>



<h2 id="圖片縮放"><a href="#圖片縮放" class="headerlink" title="圖片縮放"></a>圖片縮放</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.<span class="title function_">setScale</span>(<span class="number">.2</span>,<span class="number">.2</span>)</span><br></pre></td></tr></table></figure>



<h2 id="設定container-包物件"><a href="#設定container-包物件" class="headerlink" title="設定container 包物件"></a>設定container 包物件</h2><p><img src="https://i.imgur.com/7UGOlow.png" alt="image-20210813124658109"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">preload</span> ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;buttonBG&#x27;</span>, <span class="string">&#x27;assets/sprites/button-bg.png&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;buttonText&#x27;</span>, <span class="string">&#x27;assets/sprites/button-text.png&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span> ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> bg = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;buttonBG&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> text = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;buttonText&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> container = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">container</span>(<span class="number">400</span>, <span class="number">300</span>, [ bg, text ]);</span><br><span class="line"></span><br><span class="line">    container.<span class="title function_">setSize</span>(bg.<span class="property">width</span>, bg.<span class="property">height</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://labs.phaser.io/edit.html?src=src/game%20objects/container/draggable%20container.js">reference</a></p>
<h2 id="設定sprite切換"><a href="#設定sprite切換" class="headerlink" title="設定sprite切換"></a>設定sprite切換</h2><p><img src="https://i.imgur.com/c2ehBab.png" alt="img"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">preload</span> ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">spritesheet</span>(<span class="string">&#x27;aliens&#x27;</span>, <span class="string">&#x27;assets/sprites/bsquadron-enemies.png&#x27;</span>, &#123; <span class="attr">frameWidth</span>: <span class="number">192</span>, <span class="attr">frameHeight</span>: <span class="number">160</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span> ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> alien = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">400</span>, <span class="number">300</span>, <span class="string">&#x27;aliens&#x27;</span>, <span class="number">0</span>).<span class="title function_">setInteractive</span>();</span><br><span class="line"></span><br><span class="line">    alien.<span class="title function_">on</span>(<span class="string">&#x27;pointerover&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setFrame</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    alien.<span class="title function_">on</span>(<span class="string">&#x27;pointerout&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setFrame</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://labs.phaser.io/edit.html?src=src/input%5Cgame%20object%5Csprite%20example.js">reference</a></p>
<h2 id="世界座標中心"><a href="#世界座標中心" class="headerlink" title="世界座標中心"></a>世界座標中心</h2><p><img src="https://i.imgur.com/l0Y7ybi.jpg" alt="Phaser 3 Center Text In Middle Of Screen"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> screenCenterX = <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">worldView</span>.<span class="property">x</span> + <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">width</span> / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> screenCenterY = <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">worldView</span>.<span class="property">y</span> + <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">height</span> / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> loadingText = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">text</span>(screenCenterX, screenCenterY, <span class="string">&#x27;Loading: 0%&#x27;</span>).<span class="title function_">setOrigin</span>(<span class="number">0.5</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 測試大量圖檔</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;bg&#x27;</span> + i, <span class="string">&#x27;assets/undersea.jpg&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 創建 text</span></span><br><span class="line"><span class="keyword">let</span> percentText = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">text</span>(<span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">width</span> / <span class="number">2</span>, <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="property">height</span> / <span class="number">2</span>, <span class="string">&#x27;&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">font</span>: <span class="string">&#x27;52px Open Sans&#x27;</span>,</span><br><span class="line">    <span class="attr">fill</span>: <span class="string">&#x27;#ffffff&#x27;</span></span><br><span class="line">&#125;).<span class="title function_">setOrigin</span>(<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 偵聽處理檔案</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">on</span>(<span class="string">&#x27;progress&#x27;</span>, <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    percentText.<span class="title function_">setText</span>(<span class="built_in">parseInt</span>(value * <span class="number">100</span>) + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 偵聽載入檔案結束</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">on</span>(<span class="string">&#x27;complete&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    percentText.<span class="title function_">destroy</span>()		<span class="comment">// 載入完，把它從畫面上清除</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<p><a target="_blank" rel="noopener" href="https://www.stephengarside.co.uk/blog/phaser-3-center-text-in-middle-of-screen/">reference</a></p>
<h2 id="設定可拖曳"><a href="#設定可拖曳" class="headerlink" title="設定可拖曳"></a>設定可拖曳</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cube.<span class="title function_">setInteractive</span>();</span><br><span class="line">self.<span class="property">input</span>.<span class="title function_">setDraggable</span>(cube);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>必須先設定互動，才能使用draggable 功能</p>
</blockquote>
<h2 id="物件與物件之間-overlap"><a href="#物件與物件之間-overlap" class="headerlink" title="物件與物件之間 overlap"></a>物件與物件之間 overlap</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">create</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    self.<span class="property">RectangleToRectangle</span> = <span class="title class_">Phaser</span>.<span class="property">Geom</span>.<span class="property">Intersects</span>.<span class="property">RectangleToRectangle</span>;</span><br><span class="line">	self.<span class="property">GetBounds</span> = <span class="title class_">Phaser</span>.<span class="property">Display</span>.<span class="property">Bounds</span>.<span class="property">GetBounds</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">	<span class="variable language_">this</span>.<span class="title class_">GetBounds</span>(<span class="variable language_">this</span>.<span class="property">cube04</span>, <span class="variable language_">this</span>.<span class="property">rect1</span>);</span><br><span class="line">	<span class="variable language_">this</span>.<span class="title class_">GetBounds</span>(<span class="variable language_">this</span>.<span class="property">rect_water</span>, <span class="variable language_">this</span>.<span class="property">rect2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title class_">RectangleToRectangle</span>(<span class="variable language_">this</span>.<span class="property">rect1</span>, <span class="variable language_">this</span>.<span class="property">rect2</span>)) &#123;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://phaser.io/examples/v3/category/geom/intersects">reference</a></p>
<h2 id="設定游標"><a href="#設定游標" class="headerlink" title="設定游標"></a>設定游標</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">systems</span>.<span class="property">game</span>.<span class="property">input</span>.<span class="title function_">setCursor</span>(&#123; <span class="attr">cursor</span>: <span class="string">&#x27;grabbing&#x27;</span> &#125;);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">systems</span>.<span class="property">game</span>.<span class="property">input</span>.<span class="title function_">resetCursor</span>(&#123; <span class="attr">cursor</span>: <span class="string">&#x27;true&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure>



<h2 id="設定物件透明度"><a href="#設定物件透明度" class="headerlink" title="設定物件透明度"></a>設定物件透明度</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">object.<span class="property">alpha</span> = <span class="number">0.5</span>;</span><br><span class="line">object.<span class="title function_">clearAlpha</span>();</span><br></pre></td></tr></table></figure>



<h2 id="設定物件顯示or隱藏"><a href="#設定物件顯示or隱藏" class="headerlink" title="設定物件顯示or隱藏"></a>設定物件顯示or隱藏</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object.<span class="property">visible</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>



<h2 id="設定動畫"><a href="#設定動畫" class="headerlink" title="設定動畫"></a>設定動畫</h2><p><img src="https://i.imgur.com/iDgRMpU.png" alt="image-20210813133125039"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//回到原本水位位置</span></span><br><span class="line">self.<span class="property">tweens</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">    <span class="attr">targets</span>: [self.<span class="property">rect_water</span>, self.<span class="property">rect_water_ruler</span>],</span><br><span class="line">    <span class="attr">y</span>: self.<span class="property">gSetting</span>.<span class="property">water</span>.<span class="property">y</span>,</span><br><span class="line">    <span class="attr">ease</span>: <span class="string">&#x27;Power2&#x27;</span>,</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">onComplete</span>: self.<span class="property">onCompleteHandler</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onCompleteHandler = <span class="function">(<span class="params">tween, targets, myImage</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//console.log(&#x27;onCompleteHandler&#x27;);</span></span><br><span class="line"></span><br><span class="line">    tween.<span class="property">parent</span>.<span class="title function_">killTweensOf</span>(self.<span class="property">rect_water</span>);</span><br><span class="line">    tween.<span class="property">parent</span>.<span class="title function_">killTweensOf</span>(self.<span class="property">rect_water_ruler</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//增加水位</span></span><br><span class="line">self.<span class="property">tweens</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">targets</span>: [self.<span class="property">rect_water</span>, self.<span class="property">rect_water_ruler</span>],</span><br><span class="line">    <span class="attr">y</span>: self.<span class="title function_">add_water_height</span>(self, <span class="number">50</span>),</span><br><span class="line">    <span class="attr">ease</span>: <span class="string">&#x27;Power2&#x27;</span>,</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">onComplete</span>: self.<span class="property">onCompleteHandler</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">add_water_height = <span class="function">(<span class="params">self, add_h</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> self.<span class="property">gSetting</span>.<span class="property">water</span>.<span class="property">y</span> - add_h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="創建重力物件"><a href="#創建重力物件" class="headerlink" title="創建重力物件"></a>創建重力物件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 把物件賦予重力</span></span><br><span class="line">    <span class="keyword">let</span> ground = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">180</span>, <span class="number">400</span>, <span class="string">&#x27;tile&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">physics</span>.<span class="property">add</span>.<span class="title function_">existing</span>(ground)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 直接創建重力物件</span></span><br><span class="line">    <span class="keyword">let</span> ground2 = <span class="variable language_">this</span>.<span class="property">physics</span>.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">180</span>, <span class="number">200</span>, <span class="string">&#x27;tile&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="設定重力"><a href="#設定重力" class="headerlink" title="設定重力"></a>設定重力</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">object.<span class="property">body</span>.<span class="title function_">setAllowGravity</span>(<span class="literal">false</span>);</span><br><span class="line">object.<span class="property">body</span>.<span class="title function_">setAllowGravity</span>(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>



<h2 id="不受重力碰撞影響而變更位置"><a href="#不受重力碰撞影響而變更位置" class="headerlink" title="不受重力碰撞影響而變更位置"></a>不受重力碰撞影響而變更位置</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ground.<span class="property">body</span>.<span class="property">immovable</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/XMNk5zd.png"></p>
<h2 id="設定碰撞"><a href="#設定碰撞" class="headerlink" title="設定碰撞"></a>設定碰撞</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//讓兩個物件產生碰撞</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">physics</span>.<span class="property">add</span>.<span class="title function_">collider</span>(ground, ground2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//設定碰撞事件</span></span><br><span class="line">self.<span class="property">physics</span>.<span class="property">add</span>.<span class="title function_">collider</span>(cube, self.<span class="property">weigh</span>, weight_event, <span class="literal">null</span>, self);</span><br><span class="line">self.<span class="property">physics</span>.<span class="property">add</span>.<span class="title function_">collider</span>(cube, self.<span class="property">box_down_side</span>, boxDownSide_event, <span class="literal">null</span>, self);</span><br></pre></td></tr></table></figure>





<h2 id="切換場景"><a href="#切換場景" class="headerlink" title="切換場景"></a>切換場景</h2><p><img src="https://i.imgur.com/SBNmFo3.png" alt="image-20210813133839704"></p>
<p><code>index.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">MainScene</span> <span class="keyword">from</span> <span class="string">&#x27;./Scenes/MainScene.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">StartScene</span> <span class="keyword">from</span> <span class="string">&#x27;./Scenes/StartScene.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Phaser</span>.<span class="property">AUTO</span>,</span><br><span class="line">    <span class="attr">scale</span>: &#123;</span><br><span class="line">        <span class="attr">mode</span>: <span class="title class_">Phaser</span>.<span class="property">Scale</span>.<span class="property">FIT</span>,        </span><br><span class="line">        <span class="attr">autoCenter</span>: <span class="title class_">Phaser</span>.<span class="property">Scale</span>.<span class="property">CENTER_BOTH</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="number">1500</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="number">700</span></span><br><span class="line">    &#125;,    </span><br><span class="line">    <span class="attr">physics</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;arcade&#x27;</span>,</span><br><span class="line">        <span class="attr">arcade</span>: &#123;</span><br><span class="line">            <span class="attr">gravity</span>: &#123; <span class="attr">y</span>: <span class="number">800</span> &#125;,         </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">scene</span>: [<span class="title class_">StartScene</span>,<span class="title class_">MainScene</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> game = <span class="keyword">new</span> <span class="title class_">Phaser</span>.<span class="title class_">Game</span>(config);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><code>StartScene.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">create</span>(<span class="params"></span>) &#123;</span><br><span class="line">    btnStart.<span class="title function_">on</span>(<span class="string">&#x27;pointerover&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">scene</span>.<span class="property">sys</span>.<span class="property">game</span>.<span class="property">input</span>.<span class="title function_">setCursor</span>(&#123; <span class="attr">cursor</span>: <span class="string">&#x27;pointer&#x27;</span> &#125;);      </span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    btnStart.<span class="title function_">on</span>(<span class="string">&#x27;pointerout&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">scene</span>.<span class="property">sys</span>.<span class="property">game</span>.<span class="property">input</span>.<span class="title function_">resetCursor</span>(&#123; <span class="attr">cursor</span>: <span class="string">&#x27;true&#x27;</span> &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    btnStart.<span class="title function_">on</span>(<span class="string">&#x27;pointerdown&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;            </span><br><span class="line">        self.<span class="property">scene</span>.<span class="title function_">start</span>(<span class="string">&#x27;MainScene&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="放大鏡效果"><a href="#放大鏡效果" class="headerlink" title="放大鏡效果"></a>放大鏡效果</h2><p><img src="https://i.imgur.com/JGJ28cg.jpg" alt="img"></p>
<p><img src="https://i.imgur.com/X8PLFhx.png" alt="img"></p>
<p><img src="https://i.imgur.com/ESxkX97.png" alt="img"></p>
<p><img src="https://i.imgur.com/9vtpHfd.png" alt="image-20210813140836787"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Example</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Phaser.Scene</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_">constructor</span> ()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    preload ()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;pic&#x27;</span>, <span class="string">&#x27;assets/pics/sword-art-online.jpg&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;magnify-out&#x27;</span>, <span class="string">&#x27;assets/sprites/magnify-glass-outside.png&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;magnify-in&#x27;</span>, <span class="string">&#x27;assets/sprites/magnify-glass-inside.png&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    create ()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">400</span>, <span class="number">300</span>, <span class="string">&#x27;pic&#x27;</span>).<span class="title function_">setTint</span>(<span class="number">0x2d2d2d</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//  The scale creates a slight magnification effect</span></span><br><span class="line">        <span class="keyword">const</span> pic = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">400</span>, <span class="number">300</span>, <span class="string">&#x27;pic&#x27;</span>).<span class="title function_">setScale</span>(<span class="number">1.05</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> lense = <span class="variable language_">this</span>.<span class="property">make</span>.<span class="title function_">sprite</span>(&#123;</span><br><span class="line">            <span class="attr">x</span>: <span class="number">400</span>,</span><br><span class="line">            <span class="attr">y</span>: <span class="number">300</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;magnify-in&#x27;</span>,</span><br><span class="line">            <span class="attr">add</span>: <span class="literal">false</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        pic.<span class="property">mask</span> = <span class="keyword">new</span> <span class="title class_">Phaser</span>.<span class="property">Display</span>.<span class="property">Masks</span>.<span class="title class_">BitmapMask</span>(<span class="variable language_">this</span>, lense);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> magnify = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">400</span>, <span class="number">300</span>, <span class="string">&#x27;magnify-out&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">input</span>.<span class="title function_">on</span>(<span class="string">&#x27;pointermove&#x27;</span>, <span class="keyword">function</span> (<span class="params">pointer</span>) &#123;</span><br><span class="line"></span><br><span class="line">            lense.<span class="property">x</span> = pointer.<span class="property">x</span>;</span><br><span class="line">            lense.<span class="property">y</span> = pointer.<span class="property">y</span>;</span><br><span class="line"></span><br><span class="line">            magnify.<span class="property">x</span> = pointer.<span class="property">x</span>;</span><br><span class="line">            magnify.<span class="property">y</span> = pointer.<span class="property">y</span>;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Phaser</span>.<span class="property">WEBGL</span>,</span><br><span class="line">    <span class="attr">parent</span>: <span class="string">&#x27;phaser-example&#x27;</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">    <span class="attr">scene</span>: [ <span class="title class_">Example</span> ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> game = <span class="keyword">new</span> <span class="title class_">Phaser</span>.<span class="title class_">Game</span>(config);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://labs.phaser.io/edit.html?src=src/display/masks/magnify%20glass.js&v=3.55.2">reference</a></p>
<h2 id="這裡開始跟專案無關"><a href="#這裡開始跟專案無關" class="headerlink" title="這裡開始跟專案無關"></a>這裡開始跟專案無關</h2><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul>
<li>此工具可以編輯你想要的背景、放置圖像，最後導出 json，在 phaser 中再引入該 json。<a target="_blank" rel="noopener" href="https://thorbjorn.itch.io/tiled">Tiled Map Edito</a></li>
</ul>
<p><img src="https://i.imgur.com/KD1Boy0.png"></p>
<h2 id="相機效果"><a href="#相機效果" class="headerlink" title="相機效果"></a>相機效果</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">gameOver</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 500 ms 相機 shake 效果</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">shake</span>(<span class="number">500</span>)					</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 偵聽 shake 動畫結束</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">on</span>(<span class="string">&#x27;camerashakecomplete&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 500 ms 相機 fade 效果</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">fade</span>(<span class="number">500</span>)				</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 偵聽 fade out 動畫結束</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">on</span>(<span class="string">&#x27;camerafadeoutcomplete&#x27;</span>, <span class="function">() =&gt;</span> &#123;	</span><br><span class="line">        <span class="comment">// 遊戲重新</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">scene</span>.<span class="title function_">restart</span>()						</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="設定動畫-1"><a href="#設定動畫-1" class="headerlink" title="設定動畫"></a>設定動畫</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 把 man 物件的 origin 設在中間正下方，並設為可互動</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">man</span> = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">50</span>, <span class="number">310</span>, <span class="string">&#x27;man&#x27;</span>, <span class="number">0</span>).<span class="title function_">setOrigin</span>(<span class="number">0.5</span>, <span class="number">1</span>).<span class="title function_">setInteractive</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 對於 man 增加 tweens 動畫</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">man</span>.<span class="property">scaleTween</span> = <span class="variable language_">this</span>.<span class="property">tweens</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">        <span class="attr">targets</span>: <span class="variable language_">this</span>.<span class="property">man</span>,</span><br><span class="line">        <span class="attr">scaleX</span>: <span class="number">1.2</span>,</span><br><span class="line">        <span class="attr">scaleY</span>: <span class="number">1.2</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面一開始載入完時，就會自動執行動畫，所以可以多添加 paused: true</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">man</span>.<span class="property">scaleTween</span> = <span class="variable language_">this</span>.<span class="property">tweens</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">    <span class="attr">targets</span>: <span class="variable language_">this</span>.<span class="property">man</span>,</span><br><span class="line">    <span class="attr">scaleX</span>: <span class="number">1.2</span>,</span><br><span class="line">    <span class="attr">scaleY</span>: <span class="number">1.2</span>,</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">    <span class="attr">paused</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">man</span>.<span class="title function_">on</span>(<span class="string">&#x27;pointerdown&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">man</span>.<span class="property">scaleTween</span>.<span class="title function_">restart</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">anims</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;walking&#x27;</span>,</span><br><span class="line">        <span class="attr">frames</span>: <span class="variable language_">this</span>.<span class="property">anims</span>.<span class="title function_">generateFrameNames</span>(<span class="string">&#x27;player&#x27;</span>, &#123; <span class="attr">frames</span>: [<span class="number">1</span>, <span class="number">2</span> ]&#125;),</span><br><span class="line">        <span class="attr">frameRate</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">yoyo</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">repeat</span>: -<span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">update</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 判斷鍵盤左鍵、右鍵</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cursors</span>.<span class="property">left</span>.<span class="property">isDown</span>) &#123;</span><br><span class="line">        .....</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">player</span>.<span class="property">anims</span>.<span class="title function_">play</span>(<span class="string">&#x27;walking&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">cursors</span>.<span class="property">right</span>.<span class="property">isDown</span>) &#123;</span><br><span class="line">        .....</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">player</span>.<span class="property">anims</span>.<span class="title function_">play</span>(<span class="string">&#x27;walking&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        .....</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">player</span>.<span class="property">anims</span>.<span class="title function_">stop</span>(<span class="string">&#x27;walking&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">player</span>.<span class="title function_">setFrame</span>(<span class="number">0</span>)			<span class="comment">// 顯示在第一張圖片上</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<h2 id="遊戲重新開始"><a href="#遊戲重新開始" class="headerlink" title="遊戲重新開始"></a>遊戲重新開始</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">registry</span>.<span class="title function_">destroy</span>(); <span class="comment">// destroy registry</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">events</span>.<span class="title function_">off</span>(); <span class="comment">// disable all active events</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">scene</span>.<span class="title function_">restart</span>(); <span class="comment">// restart current scene</span></span><br></pre></td></tr></table></figure>





<h2 id="加載進度"><a href="#加載進度" class="headerlink" title="加載進度"></a>加載進度</h2><p><img src="https://i.imgur.com/6PUe3Yp.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 測試大量圖檔</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;bg&#x27;</span> + i, <span class="string">&#x27;assets/bg.png&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 創建 text</span></span><br><span class="line"><span class="keyword">let</span> percentText = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">text</span>(<span class="number">320</span>, <span class="number">160</span>, <span class="string">&#x27;&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">font</span>: <span class="string">&#x27;24px Open Sans&#x27;</span>,</span><br><span class="line">    <span class="attr">fill</span>: <span class="string">&#x27;#ffffff&#x27;</span></span><br><span class="line">&#125;).<span class="title function_">setOrigin</span>(<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 偵聽處理檔案</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">on</span>(<span class="string">&#x27;progress&#x27;</span>, <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    percentText.<span class="title function_">setText</span>(<span class="built_in">parseInt</span>(value * <span class="number">100</span>) + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 偵聽載入檔案結束</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">on</span>(<span class="string">&#x27;complete&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    percentText.<span class="title function_">destroy</span>()		<span class="comment">// 載入完，把它從畫面上清除</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="Follow"><a href="#Follow" class="headerlink" title="Follow"></a>Follow</h2><p>有時候，我們希望不侷限在特定的區域內，而是隨著遊戲者的位置來進行遊戲的移動。這時候可以調整 camera 的設定來達到這個目的（ camera 跟隨著 player 的位置 ）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 設定 camera 邊界，視角跟隨玩家</span></span><br><span class="line"><span class="comment">// 目前是依照 this.physics.world 來決定 360, 1000</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">physics</span>.<span class="property">world</span>.<span class="property">bounds</span>.<span class="property">width</span> = <span class="number">360</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">physics</span>.<span class="property">world</span>.<span class="property">bounds</span>.<span class="property">height</span> = <span class="number">1000</span></span><br><span class="line">.....</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">setBounds</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">360</span>, <span class="number">1000</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cameras</span>.<span class="property">main</span>.<span class="title function_">startFollow</span>(<span class="variable language_">this</span>.<span class="property">player</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/6mXf1fH.png"></p>
<p>這次我們學到了，如何設定 camera，依照 player 的位置，去移動 camera 的位置。可以朝著 x 軸移動的遊戲（馬力歐）；或者 y 軸移動的遊戲（小朋友下樓梯）等遊戲劇本，來設定 camera 以及 physics.world 的邊界。</p>
<h2 id="燈光-light"><a href="#燈光-light" class="headerlink" title="燈光 light"></a>燈光 light</h2><p>首先你需要有 normal maps，可以使用工具來製作 <a target="_blank" rel="noopener" href="https://www.codeandweb.com/spriteilluminator/tutorials/normal-map-painting-with-spriteilluminator">SpriteIlluminator</a> 工具來製作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">scene.<span class="property">preload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">setPath</span>(<span class="string">&#x27;assets/&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 加載圖像, 01.png 為一般圖像 ;  01_n.png 為 normal map</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;character&#x27;</span>, [<span class="string">&#x27;01.png&#x27;</span>, <span class="string">&#x27;01_n.png&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scene.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> capguy = <span class="variable language_">this</span>.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">250</span>, <span class="number">300</span>, <span class="string">&#x27;character&#x27;</span>)</span><br><span class="line">    capguy.<span class="title function_">setScale</span>(<span class="number">0.5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 讓角色接受光源</span></span><br><span class="line">    capguy.<span class="title function_">setPipeline</span>(<span class="string">&#x27;Light2D&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在 (350, 250) 位置添加半徑 200 的光源</span></span><br><span class="line">    <span class="keyword">let</span> light = <span class="variable language_">this</span>.<span class="property">lights</span>.<span class="title function_">addLight</span>(<span class="number">350</span>, <span class="number">250</span>, <span class="number">200</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lights</span>.<span class="title function_">enable</span>()</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 設定環境燈</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lights</span>.<span class="title function_">setAmbientColor</span>(<span class="number">0x555555</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 滑鼠移動，變更燈光位置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">input</span>.<span class="title function_">on</span>(<span class="string">&#x27;pointermove&#x27;</span>, <span class="keyword">function</span> (<span class="params">pointer</span>) &#123;</span><br><span class="line">        light.<span class="property">x</span> = pointer.<span class="property">x</span>;</span><br><span class="line">        light.<span class="property">y</span> = pointer.<span class="property">y</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果載入 sprite sheet 的話，也必須有 normal map sheet，我們可以使用 TexturePack 工具產生 json 檔，使用 load.multiatlas() 載入兩種 sheet，將 normal 連結到 sprite sheet 上。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/13/2021-08-13%207zip%20%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/13/2021-08-13%207zip%20%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" class="post-title-link" itemprop="url">7zip 常用指令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-13 11:06:00" itemprop="dateCreated datePublished" datetime="2021-08-13T11:06:00+08:00">2021-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>934</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>2 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="排除特定類型的檔案不要進壓縮檔"><a href="#排除特定類型的檔案不要進壓縮檔" class="headerlink" title="排除特定類型的檔案不要進壓縮檔"></a>排除特定類型的檔案不要進壓縮檔</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a dir1.zip &quot;dir1\&quot; &quot;-xr!*.pdb&quot; &quot;-xr!web.config&quot;</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.zip&quot; &quot;dir1\&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.zip&quot; &quot;dir1\dir2\*&quot;</span><br></pre></td></tr></table></figure>

<h3 id="指定壓縮檔案類型"><a href="#指定壓縮檔案類型" class="headerlink" title="指定壓縮檔案類型"></a>指定壓縮檔案類型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.zip&quot; &quot;dir1\&quot; -r &quot;dir1\*.aspx&quot;</span><br></pre></td></tr></table></figure>

<h3 id="指定多個壓縮檔案類型"><a href="#指定多個壓縮檔案類型" class="headerlink" title="指定多個壓縮檔案類型"></a>指定多個壓縮檔案類型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.zip&quot; &quot;dir1\&quot; -r &quot;dir1\*.aspx&quot; &quot;dir1\*.dll&quot;</span><br></pre></td></tr></table></figure>

<h3 id="加入密碼"><a href="#加入密碼" class="headerlink" title="加入密碼"></a>加入密碼</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.zip&quot; &quot;dir1/&quot; -p&quot;1q2w3e4r&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z a &quot;dir1.7z&quot; &quot;dir1/&quot; -p&quot;1q2w3e4r&quot;  -mhe</span><br></pre></td></tr></table></figure>
<blockquote>
<p>檔名一起加密，必須輸入完密碼後，才能看到裡面檔案名稱</p>
</blockquote>
<h2 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z x &quot;dir1.zip&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z x &quot;dir1.zip&quot; -o&quot;dir1&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此寫法可解決路徑有空白的問題</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z x &quot;dir1.zip&quot; -o&quot;C:\Program Files\&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：在 -o 與 Path 中間不能有任何空白字元！</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z e &quot;dir1.zip&quot; -o&quot;dir1&quot; -r &quot;*.js&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>解壓縮指定類型檔案</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z e &quot;dir1.zip&quot; -o&quot;dir1&quot; -r &quot;*.dll&quot; -y</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果不想提示直接覆蓋，可以加上 -y 參數</p>
</blockquote>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="列出所有檔案清單"><a href="#列出所有檔案清單" class="headerlink" title="列出所有檔案清單"></a>列出所有檔案清單</h3><p>我們在自動化的過程中可能會需要先知道壓縮檔中有什麼檔案，此時可以利用 7z 的 l (List) 命令達成這個目的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z l &quot;dir1.zip&quot;</span><br></pre></td></tr></table></figure>

<h2 id="參考連結"><a href="#參考連結" class="headerlink" title="參考連結"></a>參考連結</h2><p><a target="_blank" rel="noopener" href="https://blog.miniasp.com/post/2021/07/07/Useful-7-Zip-7z-CLI-Command-Options?fbclid=IwAR0AF7VqcBB55W2P4jUy-X5rmciWIVIY9mWPa6XsM6FiJwAUvQDZ9uQ8UZ8">分享幾個常用的 7-Zip 壓縮與解壓縮命令</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/08/12/2021-08-12%20Phaser%20%E6%95%99%E5%AD%B8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/12/2021-08-12%20Phaser%20%E6%95%99%E5%AD%B8/" class="post-title-link" itemprop="url">Phaser 教學</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-08-12 08:35:00" itemprop="dateCreated datePublished" datetime="2021-08-12T08:35:00+08:00">2021-08-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>8.7k</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>16 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Phaser-是什麼"><a href="#Phaser-是什麼" class="headerlink" title="Phaser 是什麼"></a>Phaser 是什麼</h2><ul>
<li>一個快速、免費、開源的H5遊戲框架</li>
<li>支持WEBGL和Canvas兩種渲染方式，並支持桌面和移動web瀏覽器</li>
<li>甚至可以使用第三方工具編譯打包成ios、android和桌面app</li>
<li>phaser CE 與 phaser3</li>
</ul>
<h2 id="Phaser-可以做什麼"><a href="#Phaser-可以做什麼" class="headerlink" title="Phaser 可以做什麼"></a>Phaser 可以做什麼</h2><ul>
<li>2d遊戲開發</li>
<li>推廣活動</li>
</ul>
<h2 id="Phaser-特色"><a href="#Phaser-特色" class="headerlink" title="Phaser 特色"></a>Phaser 特色</h2><p><img src="https://i.imgur.com/CbcIrlz.png" alt="image-20210618124036875"></p>
<h2 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h2><h3 id="Game的創建"><a href="#Game的創建" class="headerlink" title="Game的創建"></a>Game的創建</h3><p><img src="https://i.imgur.com/xYE0xEB.png" alt="image-20210618124206803"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Game</span>(&#123;</span><br><span class="line">	<span class="attr">width</span>:<span class="number">375</span>,</span><br><span class="line">    <span class="attr">height</span>:<span class="number">667</span>,</span><br><span class="line">    <span class="attr">renderer</span>:<span class="title class_">Phaser</span>.<span class="property">AUTO</span>,</span><br><span class="line">    <span class="attr">parent</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">transparent</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="attr">antialias</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="attr">physicsConfig</span>:<span class="literal">null</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Game工作原理"><a href="#Game工作原理" class="headerlink" title="Game工作原理"></a>Game工作原理</h3><p><img src="https://i.imgur.com/WSS023c.png" alt="image-20210618131753257"></p>
<h3 id="Game中的子系統"><a href="#Game中的子系統" class="headerlink" title="Game中的子系統"></a>Game中的子系統</h3><ol>
<li>資源加載系統</li>
<li>場景系統</li>
<li>物理引擎</li>
<li>聲音系統</li>
<li>輸入系統</li>
<li>粒子系統</li>
</ol>
<h2 id="常見遊戲元素"><a href="#常見遊戲元素" class="headerlink" title="常見遊戲元素"></a>常見遊戲元素</h2><ul>
<li>視覺<ul>
<li>圖片</li>
<li>聲音</li>
</ul>
</li>
</ul>
<p>遊戲渲染方式</p>
<ul>
<li><p>可以通過DOM實現</p>
</li>
<li><p>CANVAS</p>
<p>中小型都可以</p>
</li>
<li><p>WEBGL</p>
<p>性能大約是CANVAS 3到5倍，可以使用到GPU，3D性</p>
</li>
<li><p>文字</p>
</li>
<li><p>事件</p>
</li>
</ul>
<h2 id="遊戲中的資源"><a href="#遊戲中的資源" class="headerlink" title="遊戲中的資源"></a>遊戲中的資源</h2><ol>
<li>圖片與圖片集</li>
<li>聲音</li>
<li>字體</li>
<li>視頻</li>
</ol>
<h3 id="圖片"><a href="#圖片" class="headerlink" title="圖片"></a>圖片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&#x27;logo&#x27;</span>,<span class="string">&#x27;logo.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="http://i.imgur.com/FgfF8SD.png"></p>
<h3 id="圖片集"><a href="#圖片集" class="headerlink" title="圖片集"></a>圖片集</h3><p>1維</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">spritesheet</span>(<span class="string">&#x27;sheetImg&#x27;</span>,<span class="string">&#x27;s37x45.png&#x27;</span>,<span class="number">37</span>,<span class="number">45</span>,<span class="number">18</span>)</span><br></pre></td></tr></table></figure>

<p>變數名,路徑,寬,高,圖片數量</p>
<p>2維</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">atlasXML</span>(<span class="string">&#x27;xmlimg&#x27;</span>,<span class="string">&#x27;/xml.png&#x27;</span>,<span class="string">&#x27;/data.xml&#x27;</span>)</span><br><span class="line">game.<span class="property">load</span>.<span class="title function_">atlasXML</span>(<span class="string">&#x27;jsonimg&#x27;</span>,<span class="string">&#x27;/json.png&#x27;</span>,<span class="string">&#x27;/data.json&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/VI8GfBn.png" alt="image-20210618132120289"></p>
<h3 id="字體"><a href="#字體" class="headerlink" title="字體"></a>字體</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">bitmapFont</span>(<span class="string">&#x27;cedFont&#x27;</span>,<span class="string">&#x27;/cedFont.png&#x27;</span>,<span class="string">&#x27;/cedFont.xml&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="聲音"><a href="#聲音" class="headerlink" title="聲音"></a>聲音</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">audio</span>(<span class="string">&#x27;cedmusic&#x27;</span>,<span class="string">&#x27;/music.mp3&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="視頻"><a href="#視頻" class="headerlink" title="視頻"></a>視頻</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game.<span class="property">load</span>.<span class="title function_">video</span>(<span class="string">&#x27;cedvideo&#x27;</span>,<span class="string">&#x27;/video.mp4&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="遊戲資源加載原理"><a href="#遊戲資源加載原理" class="headerlink" title="遊戲資源加載原理"></a>遊戲資源加載原理</h2><p><img src="https://i.imgur.com/7ygJbj4.png" alt="image-20210618133243059"></p>
<h3 id="遊戲中資源加載回調事件"><a href="#遊戲中資源加載回調事件" class="headerlink" title="遊戲中資源加載回調事件"></a>遊戲中資源加載回調事件</h3><table>
<thead>
<tr>
<th>事件名稱</th>
<th>說明</th>
</tr>
</thead>
<tbody><tr>
<td>onFileStart</td>
<td></td>
</tr>
<tr>
<td>onFileError</td>
<td></td>
</tr>
<tr>
<td>onFileComplete</td>
<td></td>
</tr>
<tr>
<td>onLoadStart</td>
<td></td>
</tr>
<tr>
<td>onBeforeLoadComplete</td>
<td>只會執行一次</td>
</tr>
<tr>
<td>onLoadComplete</td>
<td>只會執行一次</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">preload</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//加载资源</span></span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&quot;logo&quot;</span>, <span class="string">&quot;/assets/images/logo.png&quot;</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">image</span>(<span class="string">&quot;bgload&quot;</span>, <span class="string">&quot;/assets/images/bgload.jpg&quot;</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">spritesheet</span>(<span class="string">&quot;s37x45&quot;</span>, <span class="string">&quot;/assets/learn/s37x45.png&quot;</span>, <span class="number">37</span>, <span class="number">45</span>, <span class="number">18</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">atlasXML</span>(<span class="string">&#x27;xmlImg&#x27;</span>, <span class="string">&#x27;/assets/learn/xml.png&#x27;</span>, <span class="string">&#x27;/assets/learn/data.xml&#x27;</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">atlas</span>(<span class="string">&#x27;jsonImg&#x27;</span>, <span class="string">&#x27;/assets/learn/json.png&#x27;</span>, <span class="string">&#x27;/assets/learn/data.json&#x27;</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">audio</span>(<span class="string">&#x27;cedAudio&#x27;</span>, <span class="string">&#x27;/assets/learn/cedAudio.mp3&#x27;</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="title function_">bitmapFont</span>(<span class="string">&#x27;cedFont&#x27;</span>, <span class="string">&#x27;/assets/learn/cedFont.png&#x27;</span>, <span class="string">&#x27;/assets/learn/cedFont.xml&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置并行下载个数</span></span><br><span class="line">    game.<span class="property">load</span>.<span class="property">maxParallelDownloads</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onFileStart</span>.<span class="title function_">add</span>(<span class="function">(<span class="params">progress, key, url</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onFileStart--&quot;</span> + progress + <span class="string">&quot;--&quot;</span> + key + <span class="string">&quot;--&quot;</span> + url)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onFileError</span>.<span class="title function_">add</span>(<span class="function">(<span class="params">key, file</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onFileError--&quot;</span> + key + <span class="string">&quot;--&quot;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(file))</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onFileComplete</span>.<span class="title function_">add</span>(<span class="function">(<span class="params">progress, key, success, totalLoad, total</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onFileComplete--&quot;</span> + progress + <span class="string">&quot;--&quot;</span> + key + <span class="string">&quot;--&quot;</span> + success + <span class="string">&quot;--&quot;</span> + total)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onLoadStart</span>.<span class="title function_">add</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onLoadStart--&quot;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onBeforeLoadComplete</span>.<span class="title function_">add</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onBeforeLoadComplete--&quot;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line">    game.<span class="property">load</span>.<span class="property">onLoadComplete</span>.<span class="title function_">add</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ced--onLoadComplete--&quot;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="顯示對象"><a href="#顯示對象" class="headerlink" title="顯示對象"></a>顯示對象</h2><table>
<thead>
<tr>
<th align="left">類型</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">圖片</td>
<td>Image</td>
</tr>
<tr>
<td align="left">精靈</td>
<td>Sprite</td>
</tr>
<tr>
<td align="left">文本</td>
<td>Text</td>
</tr>
<tr>
<td align="left">圖形</td>
<td>Graphics</td>
</tr>
</tbody></table>
<h3 id="image"><a href="#image" class="headerlink" title="image"></a>image</h3><p><img src="https://i.imgur.com/WpD4B5f.png" alt="image-20210618134347670"></p>
<h4 id="1-坐標"><a href="#1-坐標" class="headerlink" title="1. 坐標"></a>1. 坐標</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cedImage = game.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;s37x45&quot;</span>,<span class="number">1</span>);</span><br><span class="line">cedImage.<span class="property">position</span>.<span class="title function_">set</span>(game.<span class="property">world</span>.<span class="property">centerX</span>,<span class="number">30</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-大小"><a href="#2-大小" class="headerlink" title="2. 大小"></a>2. 大小</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">width</span> = <span class="number">200</span>;</span><br><span class="line">cedImage.<span class="property">height</span> = <span class="number">200</span>;</span><br></pre></td></tr></table></figure>



<h4 id="3-縮放"><a href="#3-縮放" class="headerlink" title="3. 縮放"></a>3. 縮放</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">scale</span>.<span class="title function_">set</span>(<span class="number">2</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>



<h4 id="4-錨點"><a href="#4-錨點" class="headerlink" title="4. 錨點"></a>4. 錨點</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">anchor</span>.<span class="title function_">set</span>(<span class="number">0.3</span>,<span class="number">0.3</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/G5nt7XB.png" alt="img"></p>
<p>0,0 </p>
<p>圖片的左上角</p>
<p>1,1</p>
<p>圖片的右下角</p>
<p>0.5,0.5</p>
<p>圖片的中心，也是比較常見的設法</p>
<h4 id="5-旋轉"><a href="#5-旋轉" class="headerlink" title="5. 旋轉"></a>5. 旋轉</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">rotation</span>  = <span class="number">200</span></span><br></pre></td></tr></table></figure>



<h4 id="6-透明度"><a href="#6-透明度" class="headerlink" title="6. 透明度"></a>6. 透明度</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">alpha</span> = <span class="number">0.5</span></span><br></pre></td></tr></table></figure>



<h4 id="7-遮照"><a href="#7-遮照" class="headerlink" title="7. 遮照"></a>7. 遮照</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gmask = game.<span class="property">add</span>.<span class="title function_">graphics</span>(<span class="number">130</span>,<span class="number">130</span>);</span><br><span class="line">gmask.<span class="title function_">beginFill</span>(<span class="number">0xffffff</span>,<span class="number">1</span>);</span><br><span class="line">gmask.<span class="title function_">drawRect</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>,<span class="number">50</span>);</span><br><span class="line">gmask.<span class="title function_">endFill</span>();</span><br><span class="line">cedImage.<span class="property">mask</span>=gmask;</span><br></pre></td></tr></table></figure>



<h4 id="8-事件"><a href="#8-事件" class="headerlink" title="8. 事件"></a>8. 事件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cedImage.<span class="property">inputEnabled</span> = <span class="literal">true</span>;</span><br><span class="line">cedImage.<span class="property">events</span>.<span class="property">onInputDown</span>.<span class="title function_">add</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;in down&quot;</span>)</span><br><span class="line">&#125;,<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">cedImage.<span class="property">events</span>.<span class="property">onInputUp</span>.<span class="title function_">add</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;in up&quot;</span>)</span><br><span class="line">&#125;,<span class="variable language_">this</span>);</span><br></pre></td></tr></table></figure>



<h3 id="Sprite"><a href="#Sprite" class="headerlink" title="Sprite"></a>Sprite</h3><p>image 的功能在sprite 都有，差在多了2個功能<code>動畫</code> <code>物理引擎</code></p>
<h4 id="何時該使用sprite-image"><a href="#何時該使用sprite-image" class="headerlink" title="何時該使用sprite ? image?"></a>何時該使用sprite ? image?</h4><p>不需要動畫的時候還是用image，在效能上使用資源較少</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cedImage = game.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;s37x45&quot;</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> text = game.<span class="property">add</span>.<span class="title function_">text</span>(<span class="number">30</span>, <span class="number">125</span>, <span class="string">&quot;hello world webpack&quot;</span>,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">fill</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">    <span class="attr">fontWeight</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="string">&#x27;20px&#x27;</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">    <span class="attr">wordWrap</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">wordWrapWidth</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">align</span>: <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line">    <span class="attr">stroke</span>: <span class="string">&#x27;#00000&#x27;</span>,</span><br><span class="line">    <span class="attr">strokeThickness</span>: <span class="number">3</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="Graphics"><a href="#Graphics" class="headerlink" title="Graphics"></a>Graphics</h3><p><img src="https://i.imgur.com/zCdLgvY.png" alt="image-20210618141053352"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> graphics = game.<span class="property">add</span>.<span class="title function_">graphics</span>(<span class="number">150</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**常用api</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * lineStyle(width, color, alpha);描边样式</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * beginFill(color, alpha);填充样式</span></span><br><span class="line"><span class="comment"> * endFill();</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * moveTo(x, y) 移动画笔到</span></span><br><span class="line"><span class="comment"> * lineTo(x, y) 直线</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * drawCircle(x, y, diameter);圆形</span></span><br><span class="line"><span class="comment"> * drawEllipse(x, x, halfWidth, halfHeight)椭圆</span></span><br><span class="line"><span class="comment"> * arc(x, y, radius) 弧形</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * drawRect(x, y, width, height)矩形</span></span><br><span class="line"><span class="comment"> * drawPolygon(path)多边形，参数是多边形顶点的数组</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line">graphics.<span class="title function_">moveTo</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">graphics.<span class="title function_">lineStyle</span>(<span class="number">2</span>, <span class="number">0xffffff</span>, <span class="number">1</span>);</span><br><span class="line">graphics.<span class="title function_">lineTo</span>(<span class="number">200</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//描边样式</span></span><br><span class="line">graphics.<span class="title function_">lineStyle</span>(<span class="number">2</span>, <span class="number">0x000000</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment">//填充样式</span></span><br><span class="line">graphics.<span class="title function_">beginFill</span>(<span class="number">0xffffff</span>, <span class="number">1</span>);</span><br><span class="line">graphics.<span class="title function_">drawCircle</span>(<span class="number">0</span>, <span class="number">30</span>, <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//描边样式</span></span><br><span class="line">graphics.<span class="title function_">lineStyle</span>(<span class="number">2</span>, <span class="number">0xffffff</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment">//填充样式</span></span><br><span class="line">graphics.<span class="title function_">endFill</span>();</span><br><span class="line">graphics.<span class="title function_">beginFill</span>(<span class="number">0x000000</span>, <span class="number">1</span>);</span><br><span class="line">graphics.<span class="title function_">drawRect</span>(<span class="number">0</span>, <span class="number">60</span>, <span class="number">100</span>, <span class="number">80</span>)</span><br><span class="line">graphics.<span class="title function_">endFill</span>();</span><br></pre></td></tr></table></figure>



<h3 id="顯示對象容器"><a href="#顯示對象容器" class="headerlink" title="顯示對象容器"></a>顯示對象容器</h3><p><img src="https://i.imgur.com/8W7ZNnZ.png" alt="image-20210618141147334"></p>
<p>容器的好處，分組修改對象</p>
<h4 id="相關操作"><a href="#相關操作" class="headerlink" title="相關操作"></a>相關操作</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组</span></span><br><span class="line"><span class="keyword">var</span> group = game.<span class="property">add</span>.<span class="title function_">group</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//组中添加元素</span></span><br><span class="line"><span class="keyword">var</span> gi1= game.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;jsonImg&quot;</span>,<span class="number">21</span>,group)</span><br><span class="line"><span class="keyword">var</span> gi2= game.<span class="property">make</span>.<span class="title function_">image</span>(<span class="number">100</span>,<span class="number">0</span>,<span class="string">&quot;jsonImg&quot;</span>,<span class="number">2</span>);</span><br><span class="line">group.<span class="title function_">add</span>(gi2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gs1 = group.<span class="title function_">create</span>(<span class="number">0</span>, <span class="number">300</span>, <span class="string">&quot;jsonImg&quot;</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">var</span> gs2 = group.<span class="title function_">create</span>(<span class="number">100</span>, <span class="number">300</span>, <span class="string">&quot;jsonImg&quot;</span>, <span class="number">22</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//调节顺序</span></span><br><span class="line">group.<span class="title function_">bringToTop</span>(gs1);</span><br><span class="line">group.<span class="title function_">swap</span>(gs1, gs2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除存在的对象</span></span><br><span class="line">group.<span class="title function_">remove</span>(gs1, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//整體調整 透明</span></span><br><span class="line">group.<span class="property">alpha</span> = <span class="number">0.5</span>;</span><br><span class="line"><span class="comment">//整體調整 坐標</span></span><br><span class="line">group.<span class="property">y</span> = <span class="number">100</span>;</span><br><span class="line"><span class="comment">//添加子组</span></span><br><span class="line"><span class="keyword">var</span> groupChild = game.<span class="property">add</span>.<span class="title function_">group</span>(group);</span><br><span class="line">groupChild.<span class="property">x</span> = <span class="number">100</span>;</span><br><span class="line">groupChild.<span class="property">y</span> = <span class="number">400</span>;</span><br><span class="line"><span class="keyword">var</span> gc2 = groupChild.<span class="title function_">create</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;jsonImg&quot;</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h4 id="常用顯示對象容器"><a href="#常用顯示對象容器" class="headerlink" title="常用顯示對象容器"></a>常用顯示對象容器</h4><ul>
<li>Text</li>
<li>Image</li>
<li>Sprite</li>
<li>Group</li>
</ul>
<h4 id="世界坐標、組坐標"><a href="#世界坐標、組坐標" class="headerlink" title="世界坐標、組坐標"></a>世界坐標、組坐標</h4><p>當group 被加到world底下，那它的坐標自然就是世界坐標</p>
<p>group1下加了一個group2，那group2的坐標就是對應於group1底下的組坐標。而這個group2的世界坐標相當於group1世界坐標加上group2組坐標</p>
<h2 id="渲染對象列表"><a href="#渲染對象列表" class="headerlink" title="渲染對象列表"></a>渲染對象列表</h2><p><img src="https://i.imgur.com/HWzmTLP.png" alt="image-20210618164310716"></p>
<p>根容器 Stage</p>
<p>Game 遍歷所有元素</p>
<p>先渲染的就在圖層的最下面，後渲染的就會覆蓋在上一層</p>
<h4 id="stage是什麼"><a href="#stage是什麼" class="headerlink" title="stage是什麼"></a>stage是什麼</h4><ul>
<li>顯示對象容器</li>
<li>是有大小和顯示效果的</li>
</ul>
<h4 id="world是什麼"><a href="#world是什麼" class="headerlink" title="world是什麼"></a>world是什麼</h4><ul>
<li>顯示對象容器</li>
<li>是有大小，而且任意大小</li>
</ul>
<h4 id="圖解渲染"><a href="#圖解渲染" class="headerlink" title="圖解渲染"></a>圖解渲染</h4><p><img src="https://i.imgur.com/UWeLdnZ.png" alt="image-20210618164432662"></p>
<p><img src="https://i.imgur.com/2R7Y8a4.png" alt="image-20210618164441634"></p>
<p><img src="https://i.imgur.com/QecFqZ7.png" alt="image-20210618164450650"></p>
<p><img src="https://i.imgur.com/N4omwoN.png" alt="image-20210618164458787"></p>
<h4 id="世界很大，移動畫布問題"><a href="#世界很大，移動畫布問題" class="headerlink" title="世界很大，移動畫布問題"></a>世界很大，移動畫布問題</h4><p>如果每一次都要移動world 去到stage、canvas，那計算坐標肯定會瘋掉</p>
<p><img src="https://i.imgur.com/Et3Id9K.png" alt="image-20210618164515547"></p>
<p><img src="https://i.imgur.com/lAXlVZc.png" alt="image-20210618164537230"></p>
<h4 id="使用camera"><a href="#使用camera" class="headerlink" title="使用camera"></a>使用camera</h4><p>使用camera的概念去移動攝影機</p>
<p><img src="https://i.imgur.com/NOS3aNV.png" alt="image-20210618164556971"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置背景颜色</span></span><br><span class="line">game.<span class="property">stage</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;#a8d4bf&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置世界的大小</span></span><br><span class="line">game.<span class="property">world</span>.<span class="title function_">setBounds</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1500</span>, <span class="number">667</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建两个图片</span></span><br><span class="line"><span class="keyword">var</span> gi1 = game.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;jsonImg&quot;</span>, <span class="number">21</span>)</span><br><span class="line"><span class="keyword">var</span> gi2 = game.<span class="property">add</span>.<span class="title function_">image</span>(<span class="number">380</span>, <span class="number">0</span>, <span class="string">&quot;jsonImg&quot;</span>, <span class="number">21</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//移动摄像机</span></span><br><span class="line">game.<span class="property">camera</span>.<span class="property">x</span> = <span class="number">50</span>;</span><br></pre></td></tr></table></figure>



<h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><h3 id="state創建方式"><a href="#state創建方式" class="headerlink" title="state創建方式"></a>state創建方式</h3><p>共3種寫法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> state1=&#123;</span><br><span class="line">	<span class="attr">preload</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,</span><br><span class="line">	<span class="attr">create</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,</span><br><span class="line">	<span class="attr">update</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,</span><br><span class="line">	<span class="attr">render</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;,    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> state2= <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="title function_">preload</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="title function_">create</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="title function_">update</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="title function_">render</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">state3 <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Phaser</span>.<span class="property">State</span>&#123;</span><br><span class="line">	<span class="title function_">preload</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="title function_">create</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="title function_">update</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">	<span class="title function_">render</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="state使用方式"><a href="#state使用方式" class="headerlink" title="state使用方式"></a>state使用方式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加state</span></span><br><span class="line">game.<span class="property">state</span>.<span class="title function_">add</span>(<span class="string">&quot;state1&quot;</span>,state1)</span><br><span class="line"></span><br><span class="line"><span class="comment">//啟動</span></span><br><span class="line"><span class="comment">//start(key,clearWorld,clearCache,param)</span></span><br><span class="line"><span class="comment">/* 參數說明</span></span><br><span class="line"><span class="comment">clearWorld default true</span></span><br><span class="line"><span class="comment">clearcache default false</span></span><br><span class="line"><span class="comment">param 傳遞參數給另一個state</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">game.<span class="property">state</span>.<span class="title function_">start</span>(<span class="string">&quot;state1&quot;</span>)</span><br></pre></td></tr></table></figure>





<h3 id="state使用與原理"><a href="#state使用與原理" class="headerlink" title="state使用與原理"></a>state使用與原理</h3><p>phaser 只有一個world</p>
<p>一個遊戲會有很多頁面，可以使用state來達成多頁面功能，</p>
<p>在unity 來說，就是多Scenes</p>
<p>將state 加入到state 管理器中</p>
<h3 id="state參數傳遞"><a href="#state參數傳遞" class="headerlink" title="state參數傳遞"></a>state參數傳遞</h3><p><code>BootState.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">create</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> text = game.<span class="property">add</span>.<span class="title function_">text</span>(game.<span class="property">world</span>.<span class="property">centerX</span>,<span class="number">25</span>,<span class="string">&quot;open preload&quot;</span>,&#123;<span class="attr">fill</span>:<span class="string">&#x27;#fff&#x27;</span>&#125;);</span><br><span class="line">    text.<span class="property">anchor</span>.<span class="title function_">set</span>(<span class="number">0.5</span>);</span><br><span class="line">    text.<span class="property">inputEnabled</span> = <span class="literal">true</span>;</span><br><span class="line">    text.<span class="property">events</span>.<span class="property">onInputDown</span>.<span class="title function_">add</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;onInputDown&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span>.<span class="title function_">start</span>(<span class="string">&quot;PreLoadState&quot;</span>,<span class="literal">true</span>,<span class="literal">false</span>,<span class="string">&quot;boot_test&quot;</span>);</span><br><span class="line">    &#125;,<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>PreLoadState.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">init</span>(<span class="params">p</span>)&#123;        </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;init p:&quot;</span>,p);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="state生命週期與工作原理"><a href="#state生命週期與工作原理" class="headerlink" title="state生命週期與工作原理"></a>state生命週期與工作原理</h3><p>子系統的update會調用state的update</p>
<p>shutdown 是state 的生命週期的最後一個，通常來destory物件，比方說destory 監視器物件</p>
<p><img src="https://i.imgur.com/TgTqpLp.png" alt="image-20210618171944146"></p>
<h2 id="動畫"><a href="#動畫" class="headerlink" title="動畫"></a>動畫</h2><p>動畫分類</p>
<p>補間動畫</p>
<p>幀動畫</p>
<h3 id="補間動畫"><a href="#補間動畫" class="headerlink" title="補間動畫"></a>補間動畫</h3><ul>
<li><p>創建方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tween = game.<span class="property">add</span>.<span class="title function_">tween</span>(displayObject)</span><br><span class="line">tween.<span class="title function_">to</span>(properties,duration,ease,autoStart,delay,repeat,yoyo)</span><br><span class="line">tween.<span class="title function_">from</span>(properties,duration,ease,autoStart,delay,repeat,yoyo)</span><br></pre></td></tr></table></figure>

<p>在屬性的部分也可以多設定縮放、透明度等等功能</p>
<p> 動畫也有事件的類型</p>
<p><code>tween.onStart</code></p>
<p><code>tween.onLoop</code></p>
<p><code>tween.onComplete</code></p>
</li>
<li><p>代碼示例</p>
<p>  <code>preload</code></p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">preload () &#123;</span><br><span class="line">  game.<span class="property">load</span>.<span class="title function_">atlas</span>(<span class="string">&#x27;jsonImg&#x27;</span>, <span class="string">&#x27;/assets/images/json.png&#x27;</span>, <span class="string">&#x27;/assets/images/data.json&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  <code>create()</code></p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">create</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 補間動畫</span></span><br><span class="line">    <span class="comment">// tween.to(properties,duration,ease,autoStart,delay,repeat,yoyo)</span></span><br><span class="line">    <span class="comment">// tween.from(properties,duration,ease,autoStart,delay,repeat,yoyo)</span></span><br><span class="line">    <span class="comment">// var img = game.add.image(100, 100, &#x27;jsonImg&#x27;, 21)    </span></span><br><span class="line">    <span class="comment">// var tween = game.add.tween(img)</span></span><br><span class="line"></span><br><span class="line">    tween.<span class="property">onStart</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;tween onStart&#x27;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>)</span><br><span class="line">    tween.<span class="property">onLoop</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;tween onLoop&#x27;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>)</span><br><span class="line"></span><br><span class="line">    tween.<span class="property">onComplete</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;oAnim onComplete&#x27;</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="幀動畫"><a href="#幀動畫" class="headerlink" title="幀動畫"></a>幀動畫</h3><p>只有sprite 類型才能有幀動畫</p>
<ul>
<li><p>創建方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = game.<span class="property">add</span>.<span class="title function_">sprite</span>(x,y,<span class="string">&quot;圖片集&quot;</span>)</span><br><span class="line">s.<span class="property">anamitions</span>.<span class="title function_">add</span>(name,[,frames],[,frameRate],[,loop],[,userNumericIndex])</span><br><span class="line">s.<span class="property">anamitions</span>.<span class="title function_">play</span>(<span class="string">&quot;name&quot;</span>,[,frameRate],[,loop])</span><br><span class="line">s.<span class="property">anamitions</span>.<span class="title function_">stop</span>(<span class="string">&quot;name&quot;</span>)</span><br></pre></td></tr></table></figure>


</li>
<li><p>代碼示例</p>
<p><code>preload()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">preload () &#123;</span><br><span class="line">	game.<span class="property">load</span>.<span class="title function_">atlasXML</span>(<span class="string">&#x27;octopus&#x27;</span>, <span class="string">&#x27;/assets/images/octopus.png&#x27;</span>, <span class="string">&#x27;/assets/images/octopus.xml&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>create()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> create () &#123;</span><br><span class="line"><span class="comment">// 幀動畫</span></span><br><span class="line">   <span class="keyword">var</span> octopus = game.<span class="property">add</span>.<span class="title function_">sprite</span>(<span class="number">100</span>, <span class="number">200</span>, <span class="string">&#x27;octopus&#x27;</span>)</span><br><span class="line">   <span class="keyword">var</span> oAnim = octopus.<span class="property">animations</span>.<span class="title function_">add</span>(<span class="string">&#x27;swim&#x27;</span>, <span class="literal">null</span>, <span class="number">60</span>, <span class="literal">false</span>)</span><br><span class="line">  </span><br><span class="line">   oAnim.<span class="property">onStart</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;oAnim onStart&#x27;</span>)</span><br><span class="line">   &#125;, <span class="variable language_">this</span>)</span><br><span class="line">   oAnim.<span class="property">onLoop</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;oAnim onLoop&#x27;</span>)</span><br><span class="line">   &#125;, <span class="variable language_">this</span>)</span><br><span class="line">  </span><br><span class="line">   oAnim.<span class="property">onComplete</span>.<span class="title function_">add</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;oAnim onComplete&#x27;</span>)</span><br><span class="line">   &#125;, <span class="variable language_">this</span>)</span><br><span class="line">  </span><br><span class="line">   octopus.<span class="property">animations</span>.<span class="title function_">play</span>(<span class="string">&#x27;swim&#x27;</span>, <span class="number">30</span>, <span class="literal">true</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/07/22/2021-07-22%20MYSQL%20%E9%81%A0%E7%AB%AF%E9%80%A3%E7%B7%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/22/2021-07-22%20MYSQL%20%E9%81%A0%E7%AB%AF%E9%80%A3%E7%B7%9A/" class="post-title-link" itemprop="url">MYSQL 遠端連線</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-07-22 17:00:00" itemprop="dateCreated datePublished" datetime="2021-07-22T17:00:00+08:00">2021-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>523</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>自己用VMware workstation pro run 了2個 win10 虛擬機進行實驗，跑以下流程來練習自己設定資料庫遠端連線的設定。</p>
<ol>
<li><p>開啟 Port 3306</p>
<p> MySQL 預設的 Port 是 3306，必須先開啟伺服器的連接埠，並確認防火牆的設定。尤其如果是建立在 GCP、AWS等雲端伺服器上，也要同時確認專案的防火牆設定。</p>
</li>
<li><p>建立使用者名稱及密碼</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;user&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;PASSWORD&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>給定使用者存取權限</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> database_name.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;user&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新載入使用者權限設定</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
</li>
<li><p>改程式DB connection</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$GLOBALS[<span class="string">&#x27;db&#x27;</span>] <span class="operator">=</span> <span class="keyword">new</span> db(<span class="string">&#x27;mysql:host=192.168.152.128;dbname=exam2018&#x27;</span>,<span class="string">&#x27;kite&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<p><img src="https://i.imgur.com/qlAcY4V.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/07/22/2021-07-22%20VMware%20workstation%20Pro%20%E8%88%87%20windows%20server%202016%20%E5%95%8F%E9%A1%8C%E8%A8%98%E9%8C%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/22/2021-07-22%20VMware%20workstation%20Pro%20%E8%88%87%20windows%20server%202016%20%E5%95%8F%E9%A1%8C%E8%A8%98%E9%8C%84/" class="post-title-link" itemprop="url">VMware workstation Pro 與 windows server 2016 問題記錄</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-07-22 16:41:00" itemprop="dateCreated datePublished" datetime="2021-07-22T16:41:00+08:00">2021-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>839</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>2 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="任務"><a href="#任務" class="headerlink" title="任務"></a>任務</h2><p>將從ESXi 的windows server 2016 映像檔下載下來後還原到VMware workstation pro</p>
<p>接著利用switch 接上所有PC，能讓所有PC 訪問這台裝有VMware workstation pro 的PC</p>
<p>如圖所示，感謝JAVA_Mars 幫忙畫的圖</p>
<p><img src="https://i.imgur.com/KlHo6Jc.jpg"></p>
<h2 id="主機說明"><a href="#主機說明" class="headerlink" title="主機說明"></a>主機說明</h2><ul>
<li>PC_A<ul>
<li>有灌VMWare workstation pro</li>
</ul>
</li>
<li>PC_B<ul>
<li>扮演 client 端角色</li>
</ul>
</li>
<li>Guest OS<ul>
<li>windows server 2016</li>
</ul>
</li>
</ul>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我們嘗試努力了很久，始終發現無法讓PC_B去訪問Gest_OS系統(windos server 2016)</p>
<p>於是…我們做了假設，如果模擬一般的WIN10 會不會有問題</p>
<h2 id="實驗一"><a href="#實驗一" class="headerlink" title="實驗一"></a>實驗一</h2><p>我們實際測試如果是esxi 匯出的 win10 映像檔匯入 vmware workstation pro PC_A，</p>
<p>PC_B 是能 ping 到這個 vm win10 機器</p>
<p>什麼!!!</p>
<p><strong>PC_B 是能 ping 到這個 vm win10 機器</strong></p>
<p><strong>PC_B 是能 ping 到這個 vm win10 機器</strong></p>
<p><strong>PC_B 是能 ping 到這個 vm win10 機器</strong></p>
<h2 id="經由實驗一…得出一個假設問題"><a href="#經由實驗一…得出一個假設問題" class="headerlink" title="經由實驗一…得出一個假設問題"></a>經由實驗一…得出一個假設問題</h2><p>開始懷疑是作業系統有關的問題，找了文章關鍵字發現vmware 官網有一些跟windows server2016 有關的issue</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://communities.vmware.com/t5/VMware-Workstation-Pro/bridged-network-not-working-vmware-workstation-pro-14/m-p/470985">bridged network not working - vmware workstation pro 14</a></p>
</blockquote>
<h2 id="實驗步驟流程"><a href="#實驗步驟流程" class="headerlink" title="實驗步驟流程"></a>實驗步驟流程</h2><p>某個同事就開始試….以下是記錄實驗的流程</p>
<ol>
<li>我們的作法是先將 網卡裡面的vmware bridge protocol 移除</li>
</ol>
<p><img src="https://i.imgur.com/4acIEbK.png"></p>
<ol start="2">
<li><p>接著到控制台找到vmware,執行叫出repair,remove gui介面，我們選擇「repair」進行修復</p>
</li>
<li><p>這時候網卡剛剛移除的vmware bridge protocol 就恢復了</p>
</li>
<li><p>到Virtual Machine Settings 介面</p>
<p> Remove Network Adapter</p>
</li>
</ol>
<p><img src="https://i.imgur.com/CX9UtGU.png"></p>
<ol start="5">
<li>重新 add Network Adapter ,Network connection 選擇 Bridged</li>
</ol>
<p>以上這樣就成功惹，終於可以讓PC_B 連到PC_A 底下的VMware <strong>windows server 2016</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kitefree.github.io/2021/07/22/2021-07-22%20%E7%A7%BB%E8%BD%89%20Windows%20%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kite">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="地球人的修練">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/22/2021-07-22%20%E7%A7%BB%E8%BD%89%20Windows%20%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8/" class="post-title-link" itemprop="url">移轉 Windows 列印伺服器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2021-07-22 16:35:00" itemprop="dateCreated datePublished" datetime="2021-07-22T16:35:00+08:00">2021-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2021-09-19 09:19:33" itemprop="dateModified" datetime="2021-09-19T09:19:33+08:00">2021-09-19</time>
              </span>

          <br>
            <span class="post-meta-item" title="文章字數">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>229</span>
            </span>
            <span class="post-meta-item" title="所需閱讀時間">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 分鐘</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>※以 WS2012 R2 移轉至 WS2019 為例。</p>
<p><strong>其一、以GUI方式</strong></p>
<h1 id="匯出印表機相關設定資料："><a href="#匯出印表機相關設定資料：" class="headerlink" title="匯出印表機相關設定資料："></a><strong>匯出印表機相關設定資料：</strong></h1><p><img src="https://dl.dropbox.com/s/14nneiz8u7lt9fd/2021-03-06_152858.png" alt="https://dl.dropbox.com/s/14nneiz8u7lt9fd/2021-03-06_152858.png"></p>
<p><img src="https://dl.dropbox.com/s/337qg7nri632oc9/2021-03-06_153045.png" alt="https://dl.dropbox.com/s/337qg7nri632oc9/2021-03-06_153045.png"></p>
<p><img src="https://dl.dropbox.com/s/20ne2qdvegj89tw/2021-03-06_153159.png" alt="https://dl.dropbox.com/s/20ne2qdvegj89tw/2021-03-06_153159.png"></p>
<p><img src="https://dl.dropbox.com/s/wtjngcpipbzrdyh/2021-03-06_153213.png" alt="https://dl.dropbox.com/s/wtjngcpipbzrdyh/2021-03-06_153213.png"></p>
<p><img src="https://dl.dropbox.com/s/q9v4shgllx51xky/2021-03-06_153433.png" alt="https://dl.dropbox.com/s/q9v4shgllx51xky/2021-03-06_153433.png"></p>
<h1 id="匯入印表機相關設定資料："><a href="#匯入印表機相關設定資料：" class="headerlink" title="匯入印表機相關設定資料："></a><strong>匯入印表機相關設定資料：</strong></h1><p><img src="https://dl.dropbox.com/s/mr504ro70s32dam/2021-03-06_154010.png" alt="https://dl.dropbox.com/s/mr504ro70s32dam/2021-03-06_154010.png"></p>
<p><img src="https://dl.dropbox.com/s/d214bmfgw5x23f2/2021-03-06_154140.png" alt="https://dl.dropbox.com/s/d214bmfgw5x23f2/2021-03-06_154140.png"></p>
<p><img src="https://dl.dropbox.com/s/rkqqqy3hdirt0ce/2021-03-06_154331.png" alt="https://dl.dropbox.com/s/rkqqqy3hdirt0ce/2021-03-06_154331.png"></p>
<p><img src="https://dl.dropbox.com/s/9f0gfxfz408ejzm/2021-03-06_154351.png" alt="https://dl.dropbox.com/s/9f0gfxfz408ejzm/2021-03-06_154351.png"></p>
<p><img src="https://dl.dropbox.com/s/31r0g988z05qzgv/2021-03-06_154917.png" alt="https://dl.dropbox.com/s/31r0g988z05qzgv/2021-03-06_154917.png"></p>
<p><img src="https://dl.dropbox.com/s/431u07h18nc2eyy/2021-03-06_155355.png" alt="https://dl.dropbox.com/s/431u07h18nc2eyy/2021-03-06_155355.png"></p>
<p><strong>優點：簡單明瞭，易操作。</strong></p>
<p><strong>缺點：執行時間久，會有當機的感覺。</strong></p>
<hr>
<p><strong>其二、以CLI方式</strong></p>
<h1 id="匯出印表機相關設定資料：-1"><a href="#匯出印表機相關設定資料：-1" class="headerlink" title="匯出印表機相關設定資料："></a><strong>匯出印表機相關設定資料：</strong></h1><p><strong>command:   PrintBrm.exe -b -f ps</strong></p>
<p><img src="https://dl.dropbox.com/s/but746z9goqx1as/2021-03-06_162839.png" alt="https://dl.dropbox.com/s/but746z9goqx1as/2021-03-06_162839.png"></p>
<h1 id="匯入印表機相關設定資料：-1"><a href="#匯入印表機相關設定資料：-1" class="headerlink" title="匯入印表機相關設定資料："></a><strong>匯入印表機相關設定資料：</strong></h1><p><strong>command: PrintBrm.exe -r -f ps</strong></p>
<p><img src="https://dl.dropbox.com/s/boo2ke4hv79ijxj/2021-03-06_161908.png" alt="https://dl.dropbox.com/s/boo2ke4hv79ijxj/2021-03-06_161908.png"></p>
<p><strong>優點：執行速度快。</strong></p>
<p><strong>缺點：要懂操作相關指令。</strong></p>
<p>PS:  PrintBrm.exe  使用方法：  <strong>PrintBrm.exe –?  或上網查。</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kite</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">131</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">118</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kite</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="總字數">354k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">10:44</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
